import{j as o}from"./query-vendor-DY2sPXio.js";import{c as W,a as E,u as B,s as q,v as A,o as R,w as T,h as D,k as P,l as G,m as Q,n as U,e as V,B as Y}from"./index-C4gjOm3L.js";import{r as C,L as J}from"./react-vendor-BHI5tqau.js";import{D as K,T as X}from"./Filters-_zqfohSh.js";import{u as z,i as L}from"./i18n-vendor-Dl1_3pZV.js";import{M as F,C as Z}from"./react-tooltip.min-DmiN_xn2.js";import{F as I}from"./FancyCard-DGffaorf.js";import{a as ee,b as te}from"./stats-CVYne_IR.js";import"./charts-vendor-CbNqUEBb.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-BE8h_kp7.js";import"./xlsx-vendor-De4COjWB.js";import"./tabs-B8U_iB0m.js";import"./index-DqUCnBUv.js";const se=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],ne=W("trophy",se);function O(){const{innerWidth:t,innerHeight:e}=window;return{width:t,height:e}}function oe(){const t=E.c(3);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=O(),t[0]=e):e=t[0];const[s,m]=C.useState(e);let h,i;return t[1]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{const u=function(){m(O())};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},i=[],t[1]=h,t[2]=i):(h=t[1],i=t[2]),C.useEffect(h,i),s}const ie=({mission:t,setSelectedMissionCardOptions:e})=>{const{width:s}=oe(),{t:m}=z("common/packs"),{data:h=new Map}=B(),{setSelectedCardId:i}=q();let u=5,p=Math.min(s,890)/5+120;s>600&&s<800?(u=4,p=s/3+50):s<=600&&(u=3,p=s/3+100);const w=()=>{let a=!0;const c=t.requiredCards.flatMap(n=>{const l=[];for(const f of n.options){const y=T(f)?.internal_id||0,g=h.get(y);if(g?.collection.includes(f))for(let v=0;v<g.amount_owned&&(l.push({id:y,owned:!0,missionCardOptions:n.options}),!(l.length>=n.amount));v++);if(l.length>=n.amount)break}const d=n.amount-l.length;for(let f=0;f<d;f++)l.push({id:T(n.options[0])?.internal_id,owned:!1,missionCardOptions:n.options});return a=a&&d===0,l});t.completed=a;const r=[];for(let n=0;n<c.length;n+=u)r.push(c.slice(n,n+u));return r},x=p*w().length+48;return o.jsxs("div",{className:"relative w-full",children:[o.jsx("div",{style:{height:`${x}px`},className:"relative w-full",children:w().map((a,c)=>o.jsx("div",{style:{height:`${p}px`,transform:`translateY(${p*c+72}px)`},className:"absolute top-0 left-0 w-full",children:o.jsx("div",{className:"flex justify-start gap-x-3",children:a.map((r,n)=>{const l=A(r.id);return l&&o.jsxs("div",{className:"group flex w-fit max-w-32 md:max-w-40 flex-col items-center rounded-lg cursor-pointer",children:[o.jsx("button",{type:"button",onClick:()=>r.owned?i(r.id):e(r.missionCardOptions),children:o.jsx(I,{card:l,selected:r.owned})}),o.jsx("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:R(l,L.language)})]},`${t.name}__${n}`)})})},c))}),o.jsx("div",{className:"absolute top-0 left-0 w-full",children:o.jsxs("h2",{className:"flex items-center gap-x-4 mx-auto w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-md sm:text-lg md:text-2xl tracking-tight transition-colors",children:[t.name,o.jsx(F,{id:`rewardDescription${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),o.jsx(ne,{className:"h-6 w-6","data-tooltip-id":`rewardDescription${t.name}`,"data-tooltip-html":t.reward}),o.jsx(F,{id:`probability${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),o.jsx(Z,{className:"h-6 w-6","data-tooltip-id":`probability${t.name}`,"data-tooltip-html":t.completed?"Completed!":ee(t,w()).filter(([a,c])=>a!=="everypack"&&c>0).map(([a,c])=>`${m(a)}: ${c.toFixed(2)}%`).join("<br/>")})]})},"header")]})},le=t=>{const e=E.c(15),{missions:s,resetScrollTrigger:m,setSelectedMissionCardOptions:h}=t,i=C.useRef(null),[u,p]=C.useState("auto");let w,x;e[0]===Symbol.for("react.memo_cache_sentinel")?(w=()=>{const d=()=>{if(i.current){const f=document.querySelector("#header")?.offsetHeight||0,y=document.querySelector("#filterbar")?.offsetHeight||0,g=window.innerHeight-f-y;p(`${g}px`)}};return d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},x=[],e[0]=w,e[1]=x):(w=e[0],x=e[1]),C.useLayoutEffect(w,x);let a;e[2]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{i.current&&(i.current.scrollTop=0)},e[2]=a):a=e[2];let c;e[3]!==m?(c=[m],e[3]=m,e[4]=c):c=e[4],C.useEffect(a,c);let r;e[5]!==u?(r={scrollbarWidth:"none",height:u},e[5]=u,e[6]=r):r=e[6];let n;if(e[7]!==s||e[8]!==h){let d;e[10]!==h?(d=f=>o.jsx(ie,{mission:f,setSelectedMissionCardOptions:h},f.name),e[10]=h,e[11]=d):d=e[11],n=s.map(d),e[7]=s,e[8]=h,e[9]=n}else n=e[9];let l;return e[12]!==r||e[13]!==n?(l=o.jsx("div",{ref:i,className:"overflow-y-auto mt-2 sm:mt-4 px-4 flex flex-col justify-start",style:r,children:n}),e[12]=r,e[13]=n,e[14]=l):l=e[14],l};function ae(t){const e=E.c(31),{missionCardOptions:s,onClose:m}=t;let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=["common/sets","common/packs","pages/collection"],e[0]=h):h=e[0];const{t:i}=z(h),u=s[0]||"";let p,w,x,a,c,r,n,l;if(e[1]!==u||e[2]!==s||e[3]!==m||e[4]!==i){const y=u.length>0?u.split("-")[0]:void 0,g=y===void 0?void 0:D(y),v=g?.name;w=P,n=!!s.length,e[13]!==m?(l=S=>{S||m()},e[13]=m,e[14]=l):l=e[14],p=G,x="transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto";let b;e[15]!==s.length||e[16]!==i?(b=s.length===1?i("missionDetail.eligibleCards-singular",{ns:"pages/collection",options:1}):i("missionDetail.eligibleCards-plural",{ns:"pages/collection",options:s.length}),e[15]=s.length,e[16]=i,e[17]=b):b=e[17],e[18]!==b?(a=o.jsx(Q,{children:o.jsx(U,{children:b})}),e[18]=b,e[19]=a):a=e[19],c=i(v??"Unknown expansion"),r=s.map(S=>{const j=T(S);return j&&o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"px-10 py-4 w-full",children:o.jsx(I,{card:j,selected:!1})}),o.jsxs("p",{className:"max-w-[130px] whitespace-nowrap font-semibold text-[12px] pt-2",children:[S," - ",R(j,L.language),o.jsx("br",{}),g&&i("missionDetail.chanceFrom",{ns:"pages/collection",pack:i(j.pack,{ns:"common/packs"}),chance:te(g,j.pack,j).toFixed(2)})]})]},S)}),e[1]=u,e[2]=s,e[3]=m,e[4]=i,e[5]=p,e[6]=w,e[7]=x,e[8]=a,e[9]=c,e[10]=r,e[11]=n,e[12]=l}else p=e[5],w=e[6],x=e[7],a=e[8],c=e[9],r=e[10],n=e[11],l=e[12];let d;e[20]!==p||e[21]!==x||e[22]!==a||e[23]!==c||e[24]!==r?(d=o.jsxs(p,{className:x,children:[a,c,r]}),e[20]=p,e[21]=x,e[22]=a,e[23]=c,e[24]=r,e[25]=d):d=e[25];let f;return e[26]!==w||e[27]!==n||e[28]!==l||e[29]!==d?(f=o.jsx(w,{open:n,onOpenChange:l,children:d}),e[26]=w,e[27]=n,e[28]=l,e[29]=d,e[30]=f):f=e[30],f}const re=["all","owned","missing"];function _e(){const t=E.c(37);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=["pages/collection","filters"],t[0]=e):e=t[0];const{t:s}=z(e),[m,h]=C.useState("A1"),[i,u]=C.useState("all"),[p,w]=C.useState(null);let x;t[1]===Symbol.for("react.memo_cache_sentinel")?(x=[],t[1]=x):x=t[1];const[a,c]=C.useState(x),[r]=C.useState(!1);let n;t[2]!==s?(n=_=>s(D(_).name,{ns:"common/sets"}),t[2]=s,t[3]=n):n=t[3];const l=n;let d,f;t[4]!==m||t[5]!==i?(d=()=>{let _=D(m).missions;if(!_)throw new Error(`This expansion has no missions: ${m}`);i==="owned"?_=_.filter(de):i==="missing"&&(_=_.filter(ce)),w(_)},f=[m,i],t[4]=m,t[5]=i,t[6]=d,t[7]=f):(d=t[6],f=t[7]),C.useEffect(d,f);let y;t[8]!==s?(y=s("expansion",{ns:"common/sets"}),t[8]=s,t[9]=y):y=t[9];let g;t[10]!==m||t[11]!==l||t[12]!==y?(g=o.jsx(K,{label:y,options:V,value:m,onChange:h,show:l}),t[10]=m,t[11]=l,t[12]=y,t[13]=g):g=t[13];let v;t[14]!==s?(v=_=>s(_,{ns:"filters",keyPrefix:"f-owned"}),t[14]=s,t[15]=v):v=t[15];let b;t[16]!==i||t[17]!==v?(b=o.jsx(X,{options:re,value:i,onChange:u,show:v}),t[16]=i,t[17]=v,t[18]=b):b=t[18];let S;t[19]!==s?(S=s("goToCollection"),t[19]=s,t[20]=S):S=t[20];let j;t[21]!==S?(j=o.jsx(J,{to:"/collection",children:o.jsx(Y,{className:"ml-auto cursor-pointer",variant:"outline",children:S})}),t[21]=S,t[22]=j):j=t[22];let k;t[23]!==j||t[24]!==g||t[25]!==b?(k=o.jsxs("div",{className:"flex flex-wrap gap-2 mx-4",children:[g,b,j]}),t[23]=j,t[24]=g,t[25]=b,t[26]=k):k=t[26];let M;t[27]!==p||t[28]!==r?(M=p&&o.jsx(le,{missions:p,resetScrollTrigger:r,setSelectedMissionCardOptions:c}),t[27]=p,t[28]=r,t[29]=M):M=t[29];let H;t[30]===Symbol.for("react.memo_cache_sentinel")?(H=()=>c([]),t[30]=H):H=t[30];let N;t[31]!==a?(N=o.jsx(ae,{missionCardOptions:a,onClose:H}),t[31]=a,t[32]=N):N=t[32];let $;return t[33]!==k||t[34]!==M||t[35]!==N?($=o.jsxs("div",{className:"flex flex-col gap-y-1 mx-auto max-w-[900px]",children:[k,M,N]}),t[33]=k,t[34]=M,t[35]=N,t[36]=$):$=t[36],$}function ce(t){return!t.completed}function de(t){return t.completed}export{_e as default};
