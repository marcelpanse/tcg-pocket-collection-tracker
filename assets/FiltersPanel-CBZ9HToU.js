import{d as L,j as i}from"./query-vendor-DjONLwH6.js";import{u as _,i as D}from"./i18n-vendor-B8-LMkwa.js";import{r as z}from"./react-vendor-Dbb1veav.js";import{e as A,h as P,A as V,b as W,a as I,B as U}from"./index-DoO82cKR.js";import{R as q,s as K,D as Q}from"./index-BR0LKd-h.js";import{S as Y}from"./SearchInput-CH0ruV7d.js";import{e as G,c as J,o as X,t as Z,s as ee}from"./filters-X4ivro47.js";import{D as R,T as H,a as te}from"./Filters-J5YT-pAW.js";import{M as se,C as ae}from"./react-tooltip.min-lzlTQBxv.js";function ue({className:y,children:e,cards:d,groupExpansions:t,render:r}){const{t:h}=_(["common/sets","pages/collection"]),c=z.useRef(null),[s,p]=z.useState(900),[a,m]=z.useState("100px");z.useEffect(()=>{const n=c.current;if(!n)return;const l=new ResizeObserver(o=>{p(o[0].contentRect.width);const b=document.querySelector("#header")?.offsetHeight||0,v=window.innerHeight-b;m(`${v}px`)});return l.observe(n),()=>l.disconnect()},[]);const x=1.4,u=40,w=Math.max(Math.min(Math.floor(s/170),5),3),N=Math.round(x*(s/w))+u,E={3:"basis-1/3",4:"basis-1/4",5:"basis-1/5"}[w],g=t?Object.entries(Object.groupBy(d,n=>n.expansion)).toSorted(([n,l],[o,b])=>A.indexOf(n)-A.indexOf(o)).flatMap(([n,l])=>[{id:`header-${n}`,type:"header",expansion:P(n)},...V(l,w).map((o,b)=>({id:`row-${n}-${b}`,type:"row",cards:o}))]):V(d,w).map((n,l)=>({id:`row-${l}`,type:"row",cards:n})),k=L({getScrollElement:()=>c.current,count:g.length,getItemKey:n=>g[n].id,estimateSize:n=>g[n].type==="header"?52:N+8,overscan:5});return i.jsxs("div",{ref:c,className:W("overflow-y-auto",y),style:{scrollbarWidth:"thin"},children:[e,d.length===0&&i.jsx("p",{className:"text-xl text-center py-8",children:"No cards to show"}),i.jsx("div",{style:{height:a},children:i.jsx("div",{style:{height:`${k.getTotalSize()}px`},className:"relative w-full",children:k.getVirtualItems().map(n=>{const l=g[n.index];return i.jsx("div",{style:{height:`${n.size}px`,transform:`translateY(${n.start}px)`},className:"absolute top-0 left-0 w-full",children:l.type==="header"?i.jsxs("div",{className:"flex items-center gap-2 scroll-m-20 border-b-2 border-slate-600 pb-2 tracking-tight transition-colors",children:[i.jsx("img",{src:`/images/sets/${D.language}/${l.expansion.id}.webp`,alt:l.expansion.name,className:"max-w-[60px]",onError:o=>{D.language!=="en-US"&&(o.target.src=`/images/sets/en-US/${l.expansion.id}.webp`)}}),i.jsx("h2",{className:"text-center font-semibold sm:text-lg md:text-2xl",children:h(l.expansion.name)})]}):i.jsx("div",{className:"w-full flex justify-start",children:l.cards.map(o=>i.jsx("div",{className:`${E} min-w-0 px-2`,children:r(o)},`${o.expansion}-${o.internal_id}`))})},n.key)})})})]})}const ie=y=>{const e=I.c(19),{allTextSearch:d,setAllTextSearch:t}=y,{t:r}=_("search-input");let h;e[0]!==d||e[1]!==t?(h=()=>t(!d),e[0]=d,e[1]=t,e[2]=h):h=e[2];let c;e[3]!==d||e[4]!==h?(c=i.jsx("input",{type:"checkbox",id:"checkbox",checked:d,onChange:h,className:"w-4 h-4"}),e[3]=d,e[4]=h,e[5]=c):c=e[5];let s;e[6]!==r?(s=r("allTextLabel"),e[6]=r,e[7]=s):s=e[7];let p;e[8]!==s?(p=i.jsx("label",{htmlFor:"checkbox",className:"text-xs",children:s}),e[8]=s,e[9]=p):p=e[9];let a;e[10]===Symbol.for("react.memo_cache_sentinel")?(a=i.jsx(se,{id:"allTextSearch",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e[10]=a):a=e[10];let m;e[11]!==r?(m=r("allTextTooltip"),e[11]=r,e[12]=m):m=e[12];let x;e[13]!==m?(x=i.jsx(ae,{className:"h-4 w-4","data-tooltip-id":"allTextSearch","data-tooltip-content":m}),e[13]=m,e[14]=x):x=e[14];let u;return e[15]!==c||e[16]!==p||e[17]!==x?(u=i.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[c,p,a,x]}),e[15]=c,e[16]=p,e[17]=x,e[18]=u):u=e[18],u},ge=y=>{const e=I.c(76),{className:d,filters:t,setFilters:r,clearFilters:h}=y;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=["pages/collection","common/sets","common/packs","filters"],e[0]=c):c=e[0];const{t:s}=_(c);let p;e[1]!==r?(p=f=>j=>r({[f]:j}),e[1]=r,e[2]=p):p=e[2];const a=p;let m;e[3]!==t.expansion?(m=(()=>{if(!(t.expansion===void 0||t.expansion==="all"))return["all",...P(t.expansion).packs.map(ne).filter(le)]})(),e[3]=t.expansion,e[4]=m):m=e[4];const x=m;let u;e[5]!==t.pack||e[6]!==r?(u=function(j){t.pack===void 0?r({expansion:j}):r({expansion:j,pack:"all"})},e[5]=t.pack,e[6]=r,e[7]=u):u=e[7];const w=u;let N;e[8]!==s?(N=function(j){return s(j==="all"?"all":P(j).name,{ns:"common/sets"})},e[8]=s,e[9]=N):N=e[9];const E=N;let g;e[10]!==a||e[11]!==t.search?(g=t.search!==void 0&&i.jsx(Y,{value:t.search,setValue:a("search")}),e[10]=a,e[11]=t.search,e[12]=g):g=e[12];let k;e[13]!==a||e[14]!==t.allTextSearch?(k=t.allTextSearch!==void 0&&i.jsx(ie,{allTextSearch:t.allTextSearch,setAllTextSearch:a("allTextSearch")}),e[13]=a,e[14]=t.allTextSearch,e[15]=k):k=e[15];let n;e[16]!==t.expansion||e[17]!==E||e[18]!==w||e[19]!==s?(n=t.expansion!==void 0&&i.jsx(R,{label:s("expansion",{ns:"common/sets"}),options:G,value:t.expansion,onChange:w,show:E}),e[16]=t.expansion,e[17]=E,e[18]=w,e[19]=s,e[20]=n):n=e[20];let l;e[21]!==a||e[22]!==t.pack||e[23]!==x||e[24]!==s?(l=t.pack!==void 0&&x&&i.jsx(H,{className:"block",options:x,value:t.pack,onChange:a("pack"),show:f=>s(f,{ns:"common/packs"})}),e[21]=a,e[22]=t.pack,e[23]=x,e[24]=s,e[25]=l):l=e[25];let o;e[26]!==a||e[27]!==t.deckbuildingMode||e[28]!==t.rarity?(o=t.rarity!==void 0&&i.jsx(q,{rarityFilter:t.rarity,setRarityFilter:a("rarity"),deckbuildingMode:t.deckbuildingMode}),e[26]=a,e[27]=t.deckbuildingMode,e[28]=t.rarity,e[29]=o):o=e[29];let b;e[30]!==a||e[31]!==t.cardType?(b=t.cardType!==void 0&&i.jsx(te,{options:J,value:t.cardType,onChange:a("cardType"),show:K}),e[30]=a,e[31]=t.cardType,e[32]=b):b=e[32];let v;e[33]!==a||e[34]!==t.ownership||e[35]!==s?(v=t.ownership!==void 0&&i.jsx(H,{className:"block",options:X,value:t.ownership,onChange:a("ownership"),label:s("carddex",{ns:"filters"}),show:f=>s(f,{ns:"filters",keyPrefix:"f-ownership"})}),e[33]=a,e[34]=t.ownership,e[35]=s,e[36]=v):v=e[36];let T;e[37]!==a||e[38]!==t.trading||e[39]!==s?(T=t.trading!==void 0&&i.jsx(H,{className:"block",options:Z,value:t.trading,onChange:a("trading"),label:s("trading",{ns:"filters"}),show:f=>s(f,{ns:"filters",keyPrefix:"f-trading"})}),e[37]=a,e[38]=t.trading,e[39]=s,e[40]=T):T=e[40];let S;e[41]!==a||e[42]!==t.sortBy||e[43]!==s?(S=t.sortBy!==void 0&&i.jsx(R,{label:s("f-sortBy.sortBy",{ns:"filters"}),options:ee,value:t.sortBy,onChange:a("sortBy"),show:f=>s(`f-sortBy.${f}`,{ns:"filters"})}),e[41]=a,e[42]=t.sortBy,e[43]=s,e[44]=S):S=e[44];let C;e[45]!==a||e[46]!==t.minNumber||e[47]!==s?(C=t.minNumber!==void 0&&i.jsx(R,{label:s("f-number.minNum",{ns:"filters"}),options:[0,1,2,3,4,5,6,7,8,9,10,100],value:t.minNumber,onChange:a("minNumber")}),e[45]=a,e[46]=t.minNumber,e[47]=s,e[48]=C):C=e[48];let M;e[49]!==a||e[50]!==t.maxNumber||e[51]!==s?(M=t.maxNumber!==void 0&&i.jsx(R,{label:s("f-number.maxNum",{ns:"filters"}),options:["âˆž",0,1,2,3,4,5,6,7,8,9,10],value:t.maxNumber,onChange:a("maxNumber")}),e[49]=a,e[50]=t.maxNumber,e[51]=s,e[52]=M):M=e[52];let $;e[53]!==a||e[54]!==t.deckbuildingMode?($=t.deckbuildingMode!==void 0&&i.jsx(Q,{deckbuildingMode:t.deckbuildingMode,setDeckbuildingMode:a("deckbuildingMode")}),e[53]=a,e[54]=t.deckbuildingMode,e[55]=$):$=e[55];let F;e[56]!==s?(F=s("filters.clear"),e[56]=s,e[57]=F):F=e[57];let B;e[58]!==h||e[59]!==F?(B=i.jsx(U,{variant:"outline",className:"!text-red-700",onClick:h,children:F}),e[58]=h,e[59]=F,e[60]=B):B=e[60];let O;return e[61]!==d||e[62]!==o||e[63]!==b||e[64]!==v||e[65]!==T||e[66]!==S||e[67]!==C||e[68]!==M||e[69]!==$||e[70]!==B||e[71]!==g||e[72]!==k||e[73]!==n||e[74]!==l?(O=i.jsxs("div",{className:d,children:[g,k,n,l,o,b,v,T,S,C,M,$,B]}),e[61]=d,e[62]=o,e[63]=b,e[64]=v,e[65]=T,e[66]=S,e[67]=C,e[68]=M,e[69]=$,e[70]=B,e[71]=g,e[72]=k,e[73]=n,e[74]=l,e[75]=O):O=e[75],O};function ne(y){return y.name}function le(y){return y!=="everypack"}export{ue as C,ge as F};
