import{j as s}from"./query-vendor-DpGHCXpY.js";import{h as T,c as te,hk as ae,hr as le,j as ie,h6 as ce,hs as de,h7 as oe,gQ as me,B as o,gW as xe}from"./index-Fs0_tzZR.js";import{r as ue,L as he}from"./react-vendor-DjlsVz29.js";import{F as H}from"./friend-id-display-Dhq9d4Ko.js";import{A as fe,U as se}from"./user-plus-BObeLwPj.js";import"./i18n-vendor-DDmeScd6.js";import"./charts-vendor-D-Ae2kUX.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-9yhwxkpr.js";import"./xlsx-vendor-De4COjWB.js";const pe=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ge=T("clock",pe);const je=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],be=T("user-check",je);const Ne=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Y=T("user-x",Ne);const ve=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],G=T("users",ve);function J(e){const l=te.c(4),{name:d}=e;let i;l[0]!==d?(i=d.slice(0,2).toUpperCase(),l[0]=d,l[1]=i):i=l[1];const m=i;let x;return l[2]!==m?(x=s.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-neutral-700 text-sm font-semibold text-neutral-200",children:m}),l[2]=m,l[3]=x):x=l[3],x}function Pe(){const e=te.c(61),{data:l}=ae(),{setIsLoginDialogOpen:d}=le(),{data:i}=ie(),{data:m,isLoading:x}=ce(),V=m===void 0?[]:m,{data:S,isLoading:C}=de();let I;e[0]!==S?(I=S===void 0?[]:S,e[0]=S,e[1]=I):I=e[1];const u=I,n=oe(),{toast:r}=me(),[c,Z]=ue.useState("");if(!l){let t,a,U;e[2]===Symbol.for("react.memo_cache_sentinel")?(t=s.jsx("div",{className:"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-neutral-800",children:s.jsx(G,{className:"h-8 w-8 text-neutral-400"})}),a=s.jsx("h1",{className:"mb-2 text-2xl font-bold",children:"Friends"}),U=s.jsx("p",{className:"mb-8 text-neutral-400",children:"Log in to connect with friends and see trade opportunities."}),e[2]=t,e[3]=a,e[4]=U):(t=e[2],a=e[3],U=e[4]);let _;e[5]!==d?(_=()=>d(!0),e[5]=d,e[6]=_):_=e[6];let $;e[7]===Symbol.for("react.memo_cache_sentinel")?($=s.jsx(se,{className:"mr-2 h-4 w-4"}),e[7]=$):$=e[7];let B;return e[8]!==_?(B=s.jsx("main",{children:s.jsxs("article",{className:"mx-auto max-w-2xl px-4 py-24 text-center",children:[t,a,U,s.jsxs(o,{onClick:_,children:[$,"Log in to continue"]})]})}),e[8]=_,e[9]=B):B=e[9],B}let E;e[10]!==c||e[11]!==n||e[12]!==r?(E=()=>{const t=c.trim();t&&n.mutate({friend_id:t,action:"send_request"},{onSuccess:()=>{r({title:"Friend request sent!"}),Z("")},onError:a=>{r({variant:"destructive",title:"Error",description:a.message})}})},e[10]=c,e[11]=n,e[12]=r,e[13]=E):E=e[13];const h=E;let L;e[14]!==n||e[15]!==r?(L=t=>{n.mutate({friend_id:t,action:"accept"},{onSuccess:()=>r({title:"Friend request accepted!"}),onError:a=>r({variant:"destructive",title:"Error",description:a.message})})},e[14]=n,e[15]=r,e[16]=L):L=e[16];const K=L;let q;e[17]!==n||e[18]!==r?(q=t=>{n.mutate({friend_id:t,action:"decline"},{onSuccess:()=>r({title:"Friend request declined."}),onError:a=>r({variant:"destructive",title:"Error",description:a.message})})},e[17]=n,e[18]=r,e[19]=q):q=e[19];const O=q;let D;e[20]!==n||e[21]!==r?(D=t=>{n.mutate({friend_id:t,action:"revoke"},{onSuccess:()=>r({title:"Friend removed."}),onError:a=>r({variant:"destructive",title:"Error",description:a.message})})},e[20]=n,e[21]=r,e[22]=D):D=e[22];const ee=D,F=V.filter(ke),Q=V.filter(ye),ne="mx-auto max-w-2xl px-4 sm:px-8 py-10 flex flex-col gap-6";let f;e[23]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-neutral-800",children:s.jsx(G,{className:"h-5 w-5 text-neutral-300"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold leading-tight",children:"Friends"}),s.jsx("p",{className:"text-sm text-neutral-400",children:"Connect with others to find trade matches"})]})]}),e[23]=f):f=e[23];let p;e[24]!==i?(p=i?.friend_id&&s.jsxs("div",{className:"rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-1",children:"Your Friend ID"}),s.jsx("p",{className:"text-sm text-neutral-400 mb-3",children:"Share this with others so they can add you."}),s.jsx("div",{className:"flex items-center gap-2 rounded-lg bg-neutral-900 border border-neutral-700 px-4 py-3",children:s.jsx(H,{friendId:i.friend_id,className:"text-sm font-mono flex-1"})})]}),e[24]=i,e[25]=p):p=e[25];let P,R;e[26]===Symbol.for("react.memo_cache_sentinel")?(P=s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-1",children:"Add Friend"}),R=s.jsx("p",{className:"text-sm text-neutral-400 mb-4",children:"Enter a friend's ID to send them a request."}),e[26]=P,e[27]=R):(P=e[26],R=e[27]);let M;e[28]===Symbol.for("react.memo_cache_sentinel")?(M=t=>Z(t.target.value),e[28]=M):M=e[28];let g;e[29]!==h?(g=t=>t.key==="Enter"&&h(),e[29]=h,e[30]=g):g=e[30];let j;e[31]!==c||e[32]!==g?(j=s.jsx(xe,{placeholder:"Enter friend ID",value:c,onChange:M,onKeyDown:g,className:"border-neutral-700 bg-neutral-900"}),e[31]=c,e[32]=g,e[33]=j):j=e[33];let b;e[34]!==c||e[35]!==n?(b=!c.trim()||n.isPending,e[34]=c,e[35]=n,e[36]=b):b=e[36];let z;e[37]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx(se,{className:"h-4 w-4 mr-1.5"}),e[37]=z):z=e[37];let N;e[38]!==h||e[39]!==b?(N=s.jsxs(o,{onClick:h,disabled:b,className:"shrink-0",children:[z,"Send Request"]}),e[38]=h,e[39]=b,e[40]=N):N=e[40];let v;e[41]!==j||e[42]!==N?(v=s.jsxs("div",{className:"rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",children:[P,R,s.jsxs("div",{className:"flex gap-2",children:[j,N]})]}),e[41]=j,e[42]=N,e[43]=v):v=e[43];let y;e[44]!==K||e[45]!==O||e[46]!==n||e[47]!==C||e[48]!==u?(y=(C||u.length>0)&&s.jsxs("div",{className:"rounded-xl border border-amber-700/40 bg-amber-950/20 p-5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(ge,{className:"h-4 w-4 text-amber-400"}),s.jsxs("p",{className:"text-sm font-semibold text-amber-300",children:["Pending Requests",u.length>0&&s.jsx("span",{className:"ml-1.5 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs font-medium text-amber-300",children:u.length})]})]}),C?s.jsx("p",{className:"text-neutral-400 text-sm",children:"Loading..."}):s.jsx("div",{className:"flex flex-col gap-2",children:u.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-neutral-800/80 border border-neutral-700 p-3 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.jsxs(o,{size:"sm",onClick:()=>K(t.friend_id),disabled:n.isPending,children:[s.jsx(be,{className:"h-4 w-4 mr-1"}),"Accept"]}),s.jsxs(o,{size:"sm",variant:"outline",onClick:()=>O(t.friend_id),disabled:n.isPending,children:[s.jsx(Y,{className:"h-4 w-4 mr-1"}),"Decline"]})]})]},t.id))})]}),e[44]=K,e[45]=O,e[46]=n,e[47]=C,e[48]=u,e[49]=y):y=e[49];const re="rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",W=F.length>0&&s.jsxs("span",{className:"ml-2 normal-case font-normal text-neutral-400",children:["(",F.length,")"]});let k;e[50]!==W?(k=s.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-4",children:["My Friends",W]}),e[50]=W,e[51]=k):k=e[51];const X=x?s.jsx("p",{className:"text-neutral-400 text-sm",children:"Loading..."}):F.length===0&&Q.length===0?s.jsxs("div",{className:"flex flex-col items-center py-8 text-center",children:[s.jsx("div",{className:"mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-neutral-700",children:s.jsx(G,{className:"h-6 w-6 text-neutral-500"})}),s.jsx("p",{className:"text-sm text-neutral-400",children:"No friends yet."}),s.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Send a request above to get started!"})]}):s.jsxs("div",{className:"flex flex-col gap-2",children:[F.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-neutral-900/60 border border-neutral-700 p-3 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.jsx(he,{to:`/trade/${t.friend_id}`,children:s.jsxs(o,{size:"sm",variant:"outline",children:["Trade matches",s.jsx(fe,{className:"ml-1.5 h-3.5 w-3.5"})]})}),s.jsx(o,{size:"sm",variant:"ghost",onClick:()=>ee(t.friend_id),disabled:n.isPending,className:"text-neutral-500 hover:text-red-400 hover:bg-red-900/20",children:s.jsx(Y,{className:"h-4 w-4"})})]})]},t.id)),Q.length>0&&s.jsxs(s.Fragment,{children:[F.length>0&&s.jsx("hr",{className:"border-neutral-700 my-1"}),s.jsx("p",{className:"text-xs text-neutral-500 mb-1 mt-1",children:"Sent requests"}),Q.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-neutral-900/60 border border-neutral-700 p-3 gap-3 opacity-70",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx("span",{className:"text-xs border border-neutral-600 rounded-full px-2 py-0.5 text-neutral-400",children:"Pending"})]}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs(o,{size:"sm",variant:"ghost",onClick:()=>ee(t.friend_id),disabled:n.isPending,className:"shrink-0 text-neutral-500 hover:text-red-400 hover:bg-red-900/20",children:[s.jsx(Y,{className:"h-4 w-4 mr-1"}),"Cancel"]})]},t.id))]})]});let w;e[52]!==k||e[53]!==X?(w=s.jsxs("div",{className:re,children:[k,X]}),e[52]=k,e[53]=X,e[54]=w):w=e[54];let A;return e[55]!==v||e[56]!==y||e[57]!==w||e[58]!==f||e[59]!==p?(A=s.jsx("main",{children:s.jsxs("article",{className:ne,children:[f,p,v,y,w]})}),e[55]=v,e[56]=y,e[57]=w,e[58]=f,e[59]=p,e[60]=A):A=e[60],A}function ye(e){return e.state==="pending"}function ke(e){return e.state==="accepted"}export{Pe as default};
