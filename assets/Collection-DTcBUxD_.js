import{j as s}from"./query-vendor-DjONLwH6.js";import{c as xe,a as le,f as he,h as ae,B as se,t as ne,S as ge,i as be,j as ye,k as we,l as je,r as _e,m as ve,n as Ce,u as Ne}from"./index-Dubx0UN8.js";import{r as fe,i as ke,L as me,j as Se,h as Pe}from"./react-vendor-Dbb1veav.js";import{F as Te}from"./friend-id-display-C7Wpi9A5.js";import{u as ue,i as Fe}from"./i18n-vendor-B8-LMkwa.js";import{u as Oe}from"./index-nDPg85_q.js";import{M as $e}from"./react-tooltip.min-Cns48oII.js";import{C as Le}from"./Card-86AxMk-G.js";import{F as Ae,C as Ie}from"./FiltersPanel-BRLa7M1d.js";import{g as re,s as Me,t as Be,o as Ee,c as De,e as Re}from"./filters-CKHfUKWU.js";import{T as qe}from"./trash-2---TkOzPj.js";import{C as ze}from"./chevron-right-B3ktqMKI.js";import"./ui-vendor-CGPvdk4X.js";import"./supabase-vendor-D8YWDR9M.js";import"./charts-vendor-DNUKMCvP.js";import"./xlsx-vendor-Bc83wVOq.js";import"./Filters-hyBugnxn.js";import"./tabs-BT66hvpt.js";import"./index-Bnn3LD3j.js";import"./FancyCard-DaqN8zbi.js";import"./plus-BOwE1BGT.js";import"./SearchInput-T9YYAbt9.js";const Ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ue=xe("circle-alert",Ge),oe=t=>{const e=Number(t);return Number.isNaN(e)?void 0:e},ce=t=>t==="true"?!0:t==="false"?!1:void 0,He={search:t=>t,expansion:t=>Re.includes(t)?t:void 0,pack:t=>t,cardType:t=>t.split(",").filter(e=>De.includes(e)),rarity:t=>t.split(",").filter(e=>_e.includes(e)),ownership:t=>Ee.includes(t)?t:void 0,trading:t=>Be.includes(t)?t:void 0,sortBy:t=>Me.includes(t)?t:void 0,minNumber:oe,maxNumber:oe,deckbuildingMode:ce,allTextSearch:ce},de={search:"",expansion:"all",pack:"all",cardType:[],rarity:[],ownership:"all",trading:"all",sortBy:"expansion-newest",minNumber:0,maxNumber:"∞",deckbuildingMode:!1,allTextSearch:!1};function pe(t){const e=le.c(91),{children:u,cards:a,isPublic:l,share:o}=t,{t:i}=ue("pages/collection");let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x={query:"(max-width: 767px)"},e[0]=x):x=e[0];const h=Oe(x),{setIsProfileDialogOpen:n}=he(),[F,O]=fe.useState(!1),[w,j]=ke(),{data:c}=ae();let N;e[1]!==w?(N=()=>{const p={...de},b=(y,f)=>{const m=He[y](f);m!==void 0&&(p[y]=m)};for(const y in p){const f=w.get(y);f!=null&&b(y,f)}return p},e[1]=w,e[2]=N):N=e[2];const d=N;let k;e[3]!==w||e[4]!==j?(k=p=>{const b=new URLSearchParams(w);for(const y in p){const f=p[y];f==null||f==="all"||Array.isArray(f)&&f.length===0||f===""?b.delete(y):Array.isArray(f)?b.set(y,f.join(",")):b.set(y,String(f)),j(b)}},e[3]=w,e[4]=j,e[5]=k):k=e[5];const L=k;let S;e[6]!==j?(S=()=>j(new URLSearchParams),e[6]=j,e[7]=S):S=e[7];const _=S;let P;e[8]!==d?(P=()=>{let p=0;const b=d();for(const y in b){const f=y;b[f]!==de[f]&&p++}return p},e[8]=d,e[9]=P):P=e[9];const C=P;let g,r,T,A,I,M,B;if(e[10]!==c||e[11]!==a||e[12]!==d||e[13]!==n||e[14]!==o||e[15]!==i){g=re(d(),a,c?.trade_rarity_settings);let p;e[23]!==c||e[24]!==a||e[25]!==d||e[26]!==i?(p=()=>{if(!c)throw new Error("Cannot copy trade message without account");let m="";c.is_public&&(m=m+`${i("trade.publicTradePage")}: https://tcgpocketcollectiontracker.com/#/trade/${c?.friend_id}
`),c.username&&(m=m+`${i("trade.friendID")}: ${c.friend_id} (${c.username})

`);const X=v=>{v.sort(Ve);for(let $=0;$<v.length;$++)($>0?v[$-1].expansion:"")!==v[$].expansion&&(m=m+`
${v[$].expansion}:
`),m=m+`${v[$].rarity} ${v[$].card_id} - ${je(v[$],Fe.language)}
`};return m=m+`${i("trade.lookingForCards")}:
`,X(re({...d(),trading:"wanted"},a,c.trade_rarity_settings)),m=m+`

${i("trade.forTradeCards")}:
`,X(re({...d(),trading:"extra"},a,c.trade_rarity_settings)),m},e[23]=c,e[24]=a,e[25]=d,e[26]=i,e[27]=p):p=e[27],r=p;let b;e[28]!==n||e[29]!==o?(b=async function(){o?navigator.share&&(navigator.userAgentData?.mobile||/Mobi|Android/i.test(navigator.userAgent))?await navigator.share({title:"My Pokemon TCG Pocket collection",url:window.location.href}):(await navigator.clipboard.writeText(window.location.href),ne({title:"Copied to clipboard",variant:"default"})):n(!0)},e[28]=n,e[29]=o,e[30]=b):b=e[30],A=b;const y=()=>{let m=0;const X=new Set;for(const v of g)v.collected&&!X.has(v.internal_id)&&(m=m+(v.amount_owned||0),X.add(v.internal_id));return m};let f;e[31]!==a?(f=a?.get(83654)?.amount_owned??0,e[31]=a,e[32]=f):f=e[32],T=f>0,B="flex flex-col h-fit gap-2",I="flex gap-2",M=i("stats.summary",{selected:g.length,uniquesOwned:g.filter(Qe).length,totalOwned:y()}),e[10]=c,e[11]=a,e[12]=d,e[13]=n,e[14]=o,e[15]=i,e[16]=g,e[17]=r,e[18]=T,e[19]=A,e[20]=I,e[21]=M,e[22]=B}else g=e[16],r=e[17],T=e[18],A=e[19],I=e[20],M=e[21],B=e[22];let E;e[33]!==T||e[34]!==i?(E=T&&s.jsxs(s.Fragment,{children:[s.jsx($e,{id:"mewCardOwned",className:"text-start max-w-72",clickable:!0}),s.jsx(Ue,{className:"h-5 w-5","data-tooltip-id":"mewCardOwned","data-tooltip-content":i("stats.mewCardOwned")})]}),e[33]=T,e[34]=i,e[35]=E):E=e[35];let D;e[36]!==I||e[37]!==M||e[38]!==E?(D=s.jsxs("small",{className:I,children:[M,E]}),e[36]=I,e[37]=M,e[38]=E,e[39]=D):D=e[39];let R;e[40]!==d?(R=d(),e[40]=d,e[41]=R):R=e[41];let q;e[42]!==_||e[43]!==L||e[44]!==R?(q=s.jsx(Ae,{className:"flex flex-col gap-y-3",filters:R,setFilters:L,clearFilters:_}),e[42]=_,e[43]=L,e[44]=R,e[45]=q):q=e[45];let z;e[46]!==A||e[47]!==o||e[48]!==i?(z=o!==void 0&&s.jsx(se,{variant:"outline",onClick:A,children:i("filters.share")}),e[46]=A,e[47]=o,e[48]=i,e[49]=z):z=e[49];let G;e[50]!==c||e[51]!==r||e[52]!==l||e[53]!==i?(G=!l&&s.jsx(se,{className:"w-full",variant:"outline",disabled:!c,onClick:()=>navigator.clipboard.writeText(r()).then(()=>ne({title:i("trade.copiedInClipboard"),variant:"default",duration:3e3})),children:i("trade.button")}),e[50]=c,e[51]=r,e[52]=l,e[53]=i,e[54]=G):G=e[54];let U;e[55]!==l||e[56]!==i?(U=!l&&s.jsx(me,{className:"w-full",to:"/collection/missions",children:s.jsx(se,{className:"w-full",variant:"outline",children:i("goToMissions")})}),e[55]=l,e[56]=i,e[57]=U):U=e[57];let H;e[58]!==z||e[59]!==G||e[60]!==U?(H=s.jsxs("div",{className:"flex flex-col mt-4 gap-2",children:[z,G,U]}),e[58]=z,e[59]=G,e[60]=U,e[61]=H):H=e[61];let Y;e[62]!==D||e[63]!==q||e[64]!==H||e[65]!==B?(Y=s.jsxs("div",{className:B,children:[D,q,H]}),e[62]=D,e[63]=q,e[64]=H,e[65]=B,e[66]=Y):Y=e[66];const Z=Y;let Q;e[67]!==Z||e[68]!==F||e[69]!==h?(Q=h?s.jsx(ge,{open:F,onOpenChange:O,children:s.jsxs(be,{side:"left",className:"w-full",children:[s.jsx(ye,{children:s.jsx(we,{children:"Filters"})}),Z]})}):s.jsx("div",{className:"w-80",children:Z}),e[67]=Z,e[68]=F,e[69]=h,e[70]=Q):Q=e[70];let V;e[71]!==C||e[72]!==_||e[73]!==h?(V=h&&s.jsxs("div",{className:"h-9 flex overflow-hidden text-center rounded-md text-sm font-medium border shadow-sm border-neutral-700 divide-x divide-neutral-700 [&>*]:cursor-pointer [&>*]:hover:bg-neutral-600 [&>*]:hover:text-neutral-50",children:[s.jsxs("button",{type:"button",className:"flex-1",onClick:()=>O(!0),children:["Filters",C()>0&&` (${C()})`]}),C()>0&&s.jsx("button",{type:"button",className:"group px-2",onClick:_,children:s.jsx(qe,{className:"stroke-neutral-200 group-hover:stroke-neutral-50"})})]}),e[71]=C,e[72]=_,e[73]=h,e[74]=V):V=e[74];let ee;e[75]!==d?(ee=d(),e[75]=d,e[76]=ee):ee=e[76];const ie=ee.sortBy!=="recent";let J;e[77]!==d||e[78]!==l?(J=p=>s.jsx(Le,{card:p,editable:!d().deckbuildingMode&&!l}),e[77]=d,e[78]=l,e[79]=J):J=e[79];let K;e[80]!==g||e[81]!==ie||e[82]!==J?(K=s.jsx(Ie,{cards:g,groupExpansions:ie,render:J}),e[80]=g,e[81]=ie,e[82]=J,e[83]=K):K=e[83];let W;e[84]!==u||e[85]!==V||e[86]!==K?(W=s.jsxs("div",{className:"w-full max-w-[900px]",children:[V,u,K]}),e[84]=u,e[85]=V,e[86]=K,e[87]=W):W=e[87];let te;return e[88]!==Q||e[89]!==W?(te=s.jsxs("div",{className:"flex justify-center gap-2 xl:gap-8 px-1",children:[Q,W]}),e[88]=Q,e[89]=W,e[90]=te):te=e[90],te}function Qe(t){return!!t.collected}function Ve(t,e){const u=t.expansion.localeCompare(e.expansion);return u!==0?u:t.rarity.localeCompare(e.rarity)}function Je(){const{data:t,isLoading:e}=ae(),{data:u=new Map,isLoading:a}=Ne();return e||a?s.jsx("div",{className:"mx-auto mt-12 animate-spin rounded-full size-12 border-4 border-white border-t-transparent"}):s.jsx(pe,{cards:u,isPublic:!1,share:t!==void 0&&t.friend_id!==""&&t.is_public})}function Ke(t){const e=le.c(39),{friendId:u}=t;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=["pages/collection","common"],e[0]=a):a=e[0];const{t:l}=ue(a),{data:o,isLoading:i}=ve(u),{data:x,isLoading:h}=Ce(u);if(i||h){let r;return e[1]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx("div",{className:"mx-auto mt-12 animate-spin rounded-full size-12 border-4 border-white border-t-transparent"}),e[1]=r):r=e[1],r}if(o===void 0||x===void 0){let r;return e[2]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx("p",{className:"text-xl text-center py-8",children:"Something went wrong"}),e[2]=r):r=e[2],r}if(o===null){let r;e[3]!==l?(r=l("common:noAccount"),e[3]=l,e[4]=r):r=e[4];let T;return e[5]!==r?(T=s.jsx("p",{className:"text-xl text-center py-8",children:r}),e[5]=r,e[6]=T):T=e[6],T}if(x===null){let r;return e[7]===Symbol.for("react.memo_cache_sentinel")?(r=s.jsx("p",{className:"text-xl text-center py-8",children:"Not a public account"}),e[7]=r):r=e[7],r}const n=`${o.username} collection – TCG Pocket Collection Tracker`;let F;e[8]!==n?(F=s.jsx("title",{children:n}),e[8]=n,e[9]=F):F=e[9];let O;e[10]!==l?(O=l("collectionOf"),e[10]=l,e[11]=O):O=e[11];let w;e[12]!==O?(w=s.jsx("span",{className:"text-2xl font-light",children:O}),e[12]=O,e[13]=w):w=e[13];let j;e[14]!==o.username?(j=s.jsxs("span",{className:"text-2xl font-bold",children:[" ",o.username," "]}),e[14]=o.username,e[15]=j):j=e[15];let c;e[16]!==o.friend_id?(c=s.jsx("span",{className:"block sm:inline text-sm",children:s.jsx(Te,{friendId:o.friend_id})}),e[16]=o.friend_id,e[17]=c):c=e[17];let N;e[18]!==w||e[19]!==j||e[20]!==c?(N=s.jsxs("h1",{children:[w,j,c]}),e[18]=w,e[19]=j,e[20]=c,e[21]=N):N=e[21];const d=`/trade/${u}`;let k;e[22]!==l?(k=l("showPossibleTrades"),e[22]=l,e[23]=k):k=e[23];let L;e[24]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx(ze,{}),e[24]=L):L=e[24];let S;e[25]!==k?(S=s.jsxs(se,{children:[k,L]}),e[25]=k,e[26]=S):S=e[26];let _;e[27]!==S||e[28]!==d?(_=s.jsx(me,{to:d,children:S}),e[27]=S,e[28]=d,e[29]=_):_=e[29];let P;e[30]!==_||e[31]!==N?(P=s.jsxs("div",{className:"flex justify-between my-2",children:[N,_]}),e[30]=_,e[31]=N,e[32]=P):P=e[32];let C;e[33]!==x||e[34]!==P?(C=s.jsx(pe,{cards:x,isPublic:!0,children:P}),e[33]=x,e[34]=P,e[35]=C):C=e[35];let g;return e[36]!==C||e[37]!==F?(g=s.jsxs("div",{className:"flex flex-col gap-y-1",children:[F,C]}),e[36]=C,e[37]=F,e[38]=g):g=e[38],g}function yt(){const t=le.c(14),e=Se(),{friendId:u}=Pe(),{data:a,isLoading:l}=ae();let o;t[0]!==a||t[1]!==l||t[2]!==e||t[3]!==u?(o=()=>{!u&&!l&&a?.friend_id&&e(`/collection/${a.friend_id}`,{replace:!0})},t[0]=a,t[1]=l,t[2]=e,t[3]=u,t[4]=o):o=t[4];const i=a?.friend_id;let x;if(t[5]!==l||t[6]!==e||t[7]!==u||t[8]!==i?(x=[l,u,i,e],t[5]=l,t[6]=e,t[7]=u,t[8]=i,t[9]=x):x=t[9],fe.useEffect(o,x),l){let n;return t[10]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx("div",{className:"mx-auto mt-12 animate-spin rounded-full size-12 border-4 border-white border-t-transparent"}),t[10]=n):n=t[10],n}const h=u??a?.friend_id;if(h&&h!==a?.friend_id){let n;return t[11]!==h?(n=s.jsx(Ke,{friendId:h}),t[11]=h,t[12]=n):n=t[12],n}else{let n;return t[13]===Symbol.for("react.memo_cache_sentinel")?(n=s.jsx(Je,{}),t[13]=n):n=t[13],n}}export{yt as default};
