import{r as i,ao as I,aj as Q,ak as W,j as e,al as S,ap as X,an as v,aC as R,aq as Y,ar as w,as as J,aD as Z,aE as ee,f as E,u as ae,Q as se,o as te,aK as oe,A as b,x as ne,S as re,F as ie,G as le,H as ce,z as C,t as k,ay as de,aA as me,aB as ue,az as pe,aL as _,V as xe,B as fe}from"./index-DLWGzSaU.js";import{M as he,C as ge}from"./react-tooltip.min-B58hTQUj.js";import{C as je}from"./Card-D_vX1-mZ.js";import{C as ve}from"./CardLine-BNPXsn4P.js";import"./index-Ccag8dBT.js";import"./FancyCard-CoTDvvGh.js";var y="Radio",[Ne,P]=S(y),[we,Re]=Ne(y),D=i.forwardRef((s,o)=>{const{__scopeRadio:n,name:l,checked:r=!1,required:c,disabled:d,value:g="on",onCheck:x,form:a,...m}=s,[p,f]=i.useState(null),u=R(o,t=>f(t)),h=i.useRef(!1),j=p?a||!!p.closest("form"):!0;return e.jsxs(we,{scope:n,checked:r,disabled:d,children:[e.jsx(v.button,{type:"button",role:"radio","aria-checked":r,"data-state":T(r),"data-disabled":d?"":void 0,disabled:d,value:g,...m,ref:u,onClick:w(s.onClick,t=>{r||x?.(),j&&(h.current=t.isPropagationStopped(),h.current||t.stopPropagation())})}),j&&e.jsx(M,{control:p,bubbles:!h.current,name:l,value:g,checked:r,required:c,disabled:d,form:a,style:{transform:"translateX(-100%)"}})]})});D.displayName=y;var A="RadioIndicator",G=i.forwardRef((s,o)=>{const{__scopeRadio:n,forceMount:l,...r}=s,c=Re(A,n);return e.jsx(J,{present:l||c.checked,children:e.jsx(v.span,{"data-state":T(c.checked),"data-disabled":c.disabled?"":void 0,...r,ref:o})})});G.displayName=A;var ye="RadioBubbleInput",M=i.forwardRef(({__scopeRadio:s,control:o,checked:n,bubbles:l=!0,...r},c)=>{const d=i.useRef(null),g=R(d,c),x=Z(n),a=ee(o);return i.useEffect(()=>{const m=d.current;if(!m)return;const p=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(p,"checked").set;if(x!==n&&u){const h=new Event("click",{bubbles:l});u.call(m,n),m.dispatchEvent(h)}},[x,n,l]),e.jsx(v.input,{type:"radio","aria-hidden":!0,defaultChecked:n,...r,tabIndex:-1,ref:g,style:{...r.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});M.displayName=ye;function T(s){return s?"checked":"unchecked"}var be=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],N="RadioGroup",[Ce]=S(N,[I,P]),O=I(),B=P(),[ke,_e]=Ce(N),F=i.forwardRef((s,o)=>{const{__scopeRadioGroup:n,name:l,defaultValue:r,value:c,required:d=!1,disabled:g=!1,orientation:x,dir:a,loop:m=!0,onValueChange:p,...f}=s,u=O(n),h=Q(a),[j,t]=W({prop:c,defaultProp:r??null,onChange:p,caller:N});return e.jsx(ke,{scope:n,name:l,required:d,disabled:g,value:j,onValueChange:t,children:e.jsx(X,{asChild:!0,...u,orientation:x,dir:h,loop:m,children:e.jsx(v.div,{role:"radiogroup","aria-required":d,"aria-orientation":x,"data-disabled":g?"":void 0,dir:h,...f,ref:o})})})});F.displayName=N;var L="RadioGroupItem",$=i.forwardRef((s,o)=>{const{__scopeRadioGroup:n,disabled:l,...r}=s,c=_e(L,n),d=c.disabled||l,g=O(n),x=B(n),a=i.useRef(null),m=R(o,a),p=c.value===r.value,f=i.useRef(!1);return i.useEffect(()=>{const u=j=>{be.includes(j.key)&&(f.current=!0)},h=()=>f.current=!1;return document.addEventListener("keydown",u),document.addEventListener("keyup",h),()=>{document.removeEventListener("keydown",u),document.removeEventListener("keyup",h)}},[]),e.jsx(Y,{asChild:!0,...g,focusable:!d,active:p,children:e.jsx(D,{disabled:d,required:c.required,checked:p,...x,...r,name:c.name,ref:m,onCheck:()=>c.onValueChange(r.value),onKeyDown:w(u=>{u.key==="Enter"&&u.preventDefault()}),onFocus:w(r.onFocus,()=>{f.current&&a.current?.click()})})})});$.displayName=L;var Ie="RadioGroupIndicator",U=i.forwardRef((s,o)=>{const{__scopeRadioGroup:n,...l}=s,r=B(n);return e.jsx(G,{...r,...l,ref:o})});U.displayName=Ie;var Se=F,V=$,q=U;const Ee=Se,z=i.forwardRef(({className:s,...o},n)=>e.jsx(V,{ref:n,className:E("w-4 h-4 mr-2 rounded-full bg-neutral-700 hover:bg-neutral-500",s),...o}));z.displayName=V.displayName;const K=i.forwardRef(({className:s,...o},n)=>e.jsx(q,{ref:n,className:E("w-2 h-2 mx-1 xm-auto my-auto rounded-full flex bg-neutral-300",s),...o}));K.displayName=q.displayName;function Oe(){const{t:s}=ae(["pages/card-detail","common/types","common/packs","common/sets"]),{selectedCardId:o,setSelectedCardId:n}=se(),{data:l=new Map}=te(),r=oe(),[c,d]=i.useState(!1),[g,x]=i.useState(!1),a=i.useMemo(()=>o===void 0?void 0:b(o),[o]),m=i.useMemo(()=>o===void 0?void 0:l.get(o),[o,l]),p=i.useMemo(()=>a?.alternate_versions.map(t=>({card:b(t),amount_owned:l.get(t)?.amount_owned??0})),[a,l]),f=i.useMemo(()=>a&&ne(a.expansion),[a]);if(i.useEffect(()=>{o&&d(!0)},[o]),o&&!a)return console.log(`Unrecognized card id: ${o}`),null;if(a&&!f)return console.log(`Unrecognized expansion: ${a.expansion}`),null;const u=a?.pack==="everypack"?f?.packs[0].name:a?.pack,h=t=>new Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"long"}).format(new Date(t)),j=t=>{o&&m?.collection.includes(t)&&r.mutate({cardId:t})};return e.jsx(re,{open:!!o&&c,onOpenChange:t=>{t||(d(t),setTimeout(()=>n(void 0),300))},children:e.jsxs(ie,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto w-full md:w-[725px]",children:[e.jsx(le,{children:e.jsxs(ce,{children:[a&&C(a,k.language)," ",a?.rarity]})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx("div",{className:"cursor-pointer",children:a&&e.jsx(je,{className:"w-full",card:{...a,amount_owned:m?.amount_owned||0},onImageClick:()=>x(!0)})})}),e.jsxs(de,{open:g,onOpenChange:x,children:[e.jsx(me,{className:"hidden",children:e.jsx(ue,{children:"Card image dialog"})}),e.jsx(pe,{className:"flex items-center justify-center p-0 max-w-3xl max-h-[90vh]",children:a?.image&&e.jsx("img",{src:a.image,alt:C(a,k.language),className:"w-full h-full object-scale-down",onClick:()=>x(!1)})})]}),e.jsxs("div",{className:"p-4 w-full",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s("text.alternateVersions")}),p&&e.jsxs(Ee,{className:"w-fit",value:String(o),onValueChange:t=>n(Number(t)),children:[p.map(t=>e.jsxs("label",{className:"flex items-center cursor-pointer",htmlFor:`radio-${t.card.card_id}`,children:[e.jsx(z,{id:`radio-${t.card.card_id}`,value:String(t.card.internal_id),children:e.jsx(K,{})}),e.jsx(ve,{className:"w-auto bg-transparent",card_id:t.card.card_id,rarity:"w-14",name:"hidden",details:"hidden",amount:"pl-4"})]},t.card.card_id)),e.jsxs("p",{className:"flex items-baseline mt-1",children:[e.jsxs("span",{className:"mr-4",children:[s("text.totalAmount"),":"]}),e.jsxs("span",{className:"text-neutral-400 ml-auto mr-2",children:["Ã—",p?.reduce((t,H)=>t+H.amount_owned,0)]})]})]})]}),e.jsxs("p",{className:"mt-8 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.expansion")})," ",a?.expansion]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.pack")})," ",a&&s(`${a.pack}`,{ns:"common/packs"})]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:"Energy"})," ",a?.energy]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.weakness")})," ",a&&s(`${a.weakness}`,{ns:"common/types"})||"N/A"]}),a?.hp&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.hp")})," ",a?.hp]}),a?.retreat&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.retreat")})," ",a.retreat]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.ability")})," ",a?.ability?.name??e.jsx("i",{children:"None"})]}),a?.ability&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.abilityEffect")})," ",a?.ability.effect]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.cardType")})," ",a&&s(`cardType.${a.card_type}`)]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.evolutionType")})," ",a&&s(`evolutionType.${a.evolution_type}`)]}),f&&u&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.chanceToPull",{ns:"pages/card-detail"})}),a&&xe(f,u,a).toFixed(2),"%"]}),a&&_[a.rarity]&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.craftingCost")})," ",_[a.rarity]]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.artist")})," ",a?.artist]}),!!m?.collection?.length&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"flex items-center gap-2 mt-6 mb-1",children:[e.jsx("span",{children:"Collected in"}),e.jsx(he,{id:"minInput",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e.jsx(ge,{className:"h-4 w-4","data-tooltip-id":"minInput","data-tooltip-content":s("text.uncollectTooltip")})]}),r.isPending?e.jsx("p",{children:s("text.uncollecting")}):e.jsx("div",{className:"flex flex-col gap-1 w-fit",children:m?.collection.map(t=>e.jsxs(fe,{variant:"destructive",className:"mr-auto min-w-48 w-full",onClick:()=>j(t),disabled:r.isPending,children:[s("text.uncollect")," ",t]},t))})]}),e.jsxs("p",{className:"mt-4 text-neutral-400 text-sm flex",children:[e.jsx("strong",{className:"font-semibold mr-1",children:s("text.updated")})," ",m?.updated_at?h(m.updated_at):"N/A"]})]})]})]})})}export{Oe as default};
