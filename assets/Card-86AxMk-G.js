import{j as a}from"./query-vendor-DjONLwH6.js";import{a as L,o as O,G as R,a9 as $,b as G,l as U,B as E,W}from"./index-Dubx0UN8.js";import{i as q}from"./i18n-vendor-B8-LMkwa.js";import{r as A}from"./react-vendor-Dbb1veav.js";import{F as H}from"./FancyCard-DaqN8zbi.js";import{T as J}from"./trash-2---TkOzPj.js";import{P as K}from"./plus-BOwE1BGT.js";function ie(h){const e=L.c(53),{card:t,onImageClick:k,className:B,editable:D}=h,F=D===void 0?!0:D,{setSelectedCardId:P}=O(),j=R(),b=$(),C=j.isPending||b.isPending,[s,M]=A.useOptimistic(t.amount_owned??0,V);let N;e[0]!==t.card_id||e[1]!==t.internal_id||e[2]!==M||e[3]!==j?(N=_=>{A.startTransition(async()=>{M(_);try{await j.mutateAsync({updates:[{card_id:t.card_id,internal_id:t.internal_id,amount_owned:_}]})}catch(g){console.log("Failed updating card count:",g)}})},e[0]=t.card_id,e[1]=t.internal_id,e[2]=M,e[3]=j,e[4]=N):N=e[4];const n=N;let v;e[5]!==s||e[6]!==t.card_id||e[7]!==t.collected||e[8]!==b||e[9]!==n?(v=()=>{t.collected&&s===0?A.startTransition(async()=>{await b.mutateAsync({cardId:t.card_id})}):n(s-1)},e[5]=s,e[6]=t.card_id,e[7]=t.collected,e[8]=b,e[9]=n,e[10]=v):v=e[10];const S=v;let y;e[11]!==n?(y=async _=>{const g=_.target.value===""?0:Number.parseInt(_.target.value,10);!Number.isNaN(g)&&g>=0&&n(g)},e[11]=n,e[12]=y):y=e[12];const T=y;let i;e[13]!==B?(i=G("group flex flex-col items-center rounded-lg",B),e[13]=B,e[14]=i):i=e[14];let l;e[15]!==t.internal_id||e[16]!==k||e[17]!==P?(l=()=>{P(t.internal_id),k?.()},e[15]=t.internal_id,e[16]=k,e[17]=P,e[18]=l):l=e[18];const z=!!t.collected&&!C;let r;e[19]!==t||e[20]!==z?(r=a.jsx(H,{card:t,selected:z}),e[19]=t,e[20]=z,e[21]=r):r=e[21];let d;e[22]!==C?(d=C&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full size-12 border-4 border-white border-t-transparent"})}),e[22]=C,e[23]=d):d=e[23];let c;e[24]!==l||e[25]!==r||e[26]!==d?(c=a.jsxs("button",{type:"button",className:"relative cursor-pointer",onClick:l,children:[r,d]}),e[24]=l,e[25]=r,e[26]=d,e[27]=c):c=e[27];let o;e[28]!==t.updated_at?(o=t.updated_at?`Last update ${new Date(t.updated_at).toLocaleString()}`:void 0,e[28]=t.updated_at,e[29]=o):o=e[29];let u;e[30]!==t.card_id?(u=a.jsx("span",{className:"block md:inline",children:t.card_id}),e[30]=t.card_id,e[31]=u):u=e[31];let w;e[32]===Symbol.for("react.memo_cache_sentinel")?(w=a.jsx("span",{className:"hidden md:inline",children:" â€“ "}),e[32]=w):w=e[32];let m;e[33]!==t?(m=U(t,q.language),e[33]=t,e[34]=m):m=e[34];let p;e[35]!==m?(p=a.jsx("span",{className:"block md:inline truncate",children:m}),e[35]=m,e[36]=p):p=e[36];let f;e[37]!==o||e[38]!==u||e[39]!==p?(f=a.jsxs("p",{className:"w-full min-w-0 text-[12px] pt-2 text-center font-semibold leading-tight",title:o,children:[u,w,p]}),e[37]=o,e[38]=u,e[39]=p,e[40]=f):f=e[40];let x;e[41]!==s||e[42]!==t.collected||e[43]!==F||e[44]!==T||e[45]!==S||e[46]!==n?(x=a.jsx("div",{className:"flex items-center gap-x-1",children:F?a.jsxs(a.Fragment,{children:[a.jsx(E,{variant:"ghost",size:"icon",onClick:S,className:"rounded-full",tabIndex:-1,disabled:!t.collected&&s===0,title:s===0?"Remove from card dex":"Decrease amount",children:t.collected&&s===0?a.jsx(J,{}):a.jsx(W,{})}),a.jsx("input",{min:"0",max:"99",type:"text",value:s,onChange:T,className:"w-7 text-center border-none rounded",onFocus:Q}),a.jsx(E,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>n(s+1),tabIndex:-1,title:"Increase amount",children:a.jsx(K,{})})]}):a.jsx("span",{className:"mt-1",children:s})}),e[41]=s,e[42]=t.collected,e[43]=F,e[44]=T,e[45]=S,e[46]=n,e[47]=x):x=e[47];let I;return e[48]!==c||e[49]!==f||e[50]!==x||e[51]!==i?(I=a.jsxs("div",{className:i,children:[c,f,x]}),e[48]=c,e[49]=f,e[50]=x,e[51]=i,e[52]=I):I=e[52],I}function Q(h){return h.target.select()}function V(h,e){return e}export{ie as C};
