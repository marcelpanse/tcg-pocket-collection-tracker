import{j as a}from"./query-vendor-DY2sPXio.js";import{a as h,b as C,s as S,u as T,ad as D,v as g,h as _,k as $,l as E,m as B,n as R,o as N,a9 as O,a6 as P,a7 as F,a8 as A,ae as w,B as M}from"./index-DgHxrFrG.js";import{u as U,i as y}from"./i18n-vendor-Dl1_3pZV.js";import{r as u}from"./react-vendor-BHI5tqau.js";import{M as z,C as H}from"./react-tooltip.min-CSJRSAu1.js";import{C as L}from"./Card-BqGHnJH8.js";import{C as V}from"./CardLine-Biqgh4l_.js";import{A as Q,B as W,E as q}from"./ui-vendor-BE8h_kp7.js";import{b as G}from"./stats-JtWwSfrh.js";import"./charts-vendor-CbNqUEBb.js";import"./supabase-vendor-CP3OYKhD.js";import"./xlsx-vendor-De4COjWB.js";import"./index-DqUCnBUv.js";import"./FancyCard-DNECTXxk.js";import"./trash-2-bNkt03R2.js";import"./plus-CJtFOa-W.js";const J=Q;function K(s){const e=h.c(8);let i,r;e[0]!==s?({className:i,...r}=s,e[0]=s,e[1]=i,e[2]=r):(i=e[1],r=e[2]);let n;e[3]!==i?(n=C("w-4 h-4 mr-2 rounded-full bg-neutral-700 hover:bg-neutral-500",i),e[3]=i,e[4]=n):n=e[4];let o;return e[5]!==r||e[6]!==n?(o=a.jsx(W,{className:n,...r}),e[5]=r,e[6]=n,e[7]=o):o=e[7],o}function X(s){const e=h.c(8);let i,r;e[0]!==s?({className:i,...r}=s,e[0]=s,e[1]=i,e[2]=r):(i=e[1],r=e[2]);let n;e[3]!==i?(n=C("w-2 h-2 mx-1 xm-auto my-auto rounded-full flex bg-neutral-300",i),e[3]=i,e[4]=n):n=e[4];let o;return e[5]!==r||e[6]!==n?(o=a.jsx(q,{className:n,...r}),e[5]=r,e[6]=n,e[7]=o):o=e[7],o}function c(s){const e=h.c(5),{name:i,children:r}=s;let n;e[0]!==i?(n=a.jsx("strong",{className:"block min-w-[175px]",children:i}),e[0]=i,e[1]=n):n=e[1];let o;return e[2]!==r||e[3]!==n?(o=a.jsxs("p",{className:"flex",children:[n,r]}),e[2]=r,e[3]=n,e[4]=o):o=e[4],o}function ue(){const{t:s}=U(["pages/card-detail","common/types","common/packs","common/sets"]),{selectedCardId:e,setSelectedCardId:i}=S(),{data:r=new Map}=T(),n=D(),[o,f]=u.useState(!1),[v,x]=u.useState(!1),t=e===void 0?void 0:g(e),d=e===void 0?void 0:r.get(e),p=t?.alternate_versions.map(l=>({card:g(l),amount_owned:r.get(l)?.amount_owned??0})),m=t&&_(t.expansion);if(u.useEffect(()=>{e&&f(!0)},[e]),e&&!t)return console.log(`Unrecognized card id: ${e}`),null;if(t&&!m)return console.log(`Unrecognized expansion: ${t.expansion}`),null;const j=t?.pack==="everypack"?m?.packs[0].name:t?.pack,b=l=>new Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"long"}).format(new Date(l)),k=l=>{e&&d?.collection.includes(l)&&n.mutate({cardId:l})};return a.jsx($,{open:!!e&&o,onOpenChange:l=>{l||(f(l),setTimeout(()=>i(void 0),300))},children:a.jsxs(E,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto w-full md:w-[725px]",children:[a.jsx(B,{children:a.jsxs(R,{children:[t&&N(t,y.language)," ",t?.rarity]})}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("div",{className:"px-10 py-4 w-full",children:a.jsx("div",{className:"cursor-pointer",children:t&&a.jsx(L,{className:"w-full",card:{...t,amount_owned:d?.amount_owned||0},onImageClick:()=>x(!0)})})}),a.jsxs(O,{open:v,onOpenChange:x,children:[a.jsx(P,{className:"hidden",children:a.jsx(F,{children:"Card image dialog"})}),a.jsx(A,{className:"flex items-center justify-center p-0 max-w-3xl max-h-[90vh]",children:t?.image&&a.jsx("img",{src:t.image,alt:N(t,y.language),className:"w-full h-full object-scale-down",onClick:()=>x(!1)})})]}),a.jsxs("div",{className:"p-4 w-full",children:[a.jsxs("div",{className:"mb-3",children:[a.jsx("h2",{className:"text-xl font-semibold",children:s("text.alternateVersions")}),p&&a.jsxs(J,{className:"w-fit",value:String(e),onValueChange:l=>i(Number(l)),children:[p.map(l=>a.jsxs("label",{className:"flex items-center cursor-pointer",htmlFor:`radio-${l.card.card_id}`,children:[a.jsx(K,{id:`radio-${l.card.card_id}`,value:String(l.card.internal_id),children:a.jsx(X,{})}),a.jsx(V,{className:"w-auto bg-transparent",card_id:l.card.card_id,rarity:"w-14",name:"hidden",details:"hidden",amount:"pl-4"})]},l.card.card_id)),a.jsxs("p",{className:"flex items-baseline mt-1",children:[a.jsxs("span",{className:"mr-4",children:[s("text.totalAmount"),":"]}),a.jsxs("span",{className:"text-neutral-400 ml-auto mr-2",children:["Ã—",p?.reduce((l,I)=>l+I.amount_owned,0)]})]})]})]}),a.jsxs("div",{className:"mt-8",children:[a.jsx(c,{name:s("text.expansion"),children:t?.expansion}),a.jsx(c,{name:s("text.pack"),children:t&&s(t.pack,{ns:"common/packs"})}),a.jsx(c,{name:"Energy",children:t?.energy}),a.jsx(c,{name:s("text.weakness"),children:t&&s(t.weakness,{ns:"common/types"})||"N/A"}),t?.hp&&a.jsx(c,{name:s("text.hp"),children:t?.hp}),t?.retreat&&a.jsx(c,{name:s("text.retreat"),children:t.retreat}),a.jsx(c,{name:s("text.ability"),children:t?.ability?.name??a.jsx("i",{children:"None"})}),t?.ability&&a.jsx(c,{name:s("text.abilityEffect"),children:t?.ability.effect}),a.jsx(c,{name:s("text.cardType"),children:t&&s(`cardType.${t.card_type}`)}),a.jsx(c,{name:s("text.evolutionType"),children:t&&s(`evolutionType.${t.evolution_type}`)}),m&&j&&t&&t.rarity!=="P"&&a.jsxs(c,{name:s("text.chanceToPull"),children:[t&&G(m,j,t).toFixed(2),"%"]}),t&&w[t.rarity]&&a.jsx(c,{name:s("text.craftingCost"),children:w[t.rarity]}),a.jsx(c,{name:s("text.artist"),children:t?.artist})]}),!!d?.collection?.length&&a.jsxs(a.Fragment,{children:[a.jsxs("p",{className:"flex items-center gap-2 mt-6 mb-1",children:[a.jsx("span",{children:"Collected in"}),a.jsx(z,{id:"minInput",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),a.jsx(H,{className:"h-4 w-4","data-tooltip-id":"minInput","data-tooltip-content":s("text.uncollectTooltip")})]}),a.jsx("div",{className:"flex flex-col gap-1 w-fit",children:d?.collection.map(l=>a.jsxs(M,{variant:"destructive",className:"mr-auto min-w-48 w-full",onClick:()=>k(l),disabled:n.isPending,isPending:n.isPending,children:[s("text.uncollect")," ",l]},l))})]}),a.jsxs("p",{className:"mt-4 text-neutral-400 text-sm flex",children:[a.jsx("strong",{className:"font-semibold mr-1",children:s("text.updated")})," ",d?.updated_at?b(d.updated_at):"N/A"]})]})]})]})})}export{ue as default};
