import{e as $,u as y,o as E,a8 as F,r as x,a9 as w,j as e,B as T,A as M,t as N,aa as D,x as j,ab as I,ac as R,ad as z,ae as _,af as B,X as L,Z as A}from"./index-V5iL5m1z.js";import{u as O,D as q,e as W,T as P}from"./useWindowDimensionsHook-jNS6G5gq.js";import{M as k,C as G}from"./react-tooltip.min-BeyKPVBx.js";import{F as H}from"./FancyCard-CkhP9nLN.js";import"./index-BpAeSvfk.js";/**
 * @license lucide-react v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],U=$("trophy",Q),V=({mission:t,setSelectedMissionCardOptions:u})=>{const{width:s}=O(),{t:r}=y("common/packs"),{data:c=new Map}=E(),{setSelectedCardId:h}=F();let a=5,i=Math.min(s,890)/5+120;s>600&&s<800?(a=4,i=s/3+50):s<=600&&(a=3,i=s/3+100);const l=x.useMemo(()=>{let d=!0;const p=t.requiredCards.flatMap(o=>{const m=[];for(const g of o.options){const v=w(g)?.internal_id||0,C=c.get(v);if(C?.collection.includes(g))for(let S=0;S<C.amount_owned&&(m.push({id:v,owned:!0,missionCardOptions:o.options}),!(m.length>=o.amount));S++);if(m.length>=o.amount)break}const b=o.amount-m.length;for(let g=0;g<b;g++)m.push({id:w(o.options[0])?.internal_id,owned:!1,missionCardOptions:o.options});return d=d&&b===0,m});t.completed=d;const n=[];for(let o=0;o<p.length;o+=a)n.push(p.slice(o,o+a));return n},[a]),f=i*l.length+48;return e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{style:{height:`${f}px`},className:"relative w-full",children:l.map((d,p)=>e.jsx("div",{style:{height:`${i}px`,transform:`translateY(${i*p+72}px)`},className:"absolute top-0 left-0 w-full",children:e.jsx("div",{className:"flex justify-start gap-x-3",children:d.map((n,o)=>{const m=T(n.id);return m&&e.jsxs("div",{className:"group flex w-fit max-w-32 md:max-w-40 flex-col items-center rounded-lg cursor-pointer",children:[e.jsx("button",{type:"button",onClick:()=>n.owned?h(n.id):u(n.missionCardOptions),children:e.jsx(H,{card:m,selected:n.owned})}),e.jsx("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:M(m,N.language)})]},`${t.name}__${o}`)})})},p))}),e.jsx("div",{className:"absolute top-0 left-0 w-full",children:e.jsxs("h2",{className:"flex items-center gap-x-4 mx-auto w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-md sm:text-lg md:text-2xl tracking-tight transition-colors",children:[t.name,e.jsx(k,{id:`rewardDescription${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(U,{className:"h-6 w-6","data-tooltip-id":`rewardDescription${t.name}`,"data-tooltip-html":t.reward}),e.jsx(k,{id:`probability${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(G,{className:"h-6 w-6","data-tooltip-id":`probability${t.name}`,"data-tooltip-html":t.completed?"Completed!":D(t,l).filter(([d,p])=>d!=="everypack"&&p>0).map(([d,p])=>`${r(d)}: ${p.toFixed(2)}%`).join("<br/>")})]})},"header")]})},X=({missions:t,resetScrollTrigger:u,setSelectedMissionCardOptions:s})=>{const r=x.useRef(null),[c,h]=x.useState("auto");return x.useLayoutEffect(()=>{const a=()=>{if(r.current){const i=document.querySelector("#header")?.offsetHeight||0,l=document.querySelector("#filterbar")?.offsetHeight||0,f=window.innerHeight-i-l;h(`${f}px`)}};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),x.useEffect(()=>{r.current&&(r.current.scrollTop=0)},[u]),e.jsx("div",{ref:r,className:"overflow-y-auto mt-2 sm:mt-4 px-4 flex flex-col justify-start",style:{scrollbarWidth:"none",height:c},children:t.map(a=>e.jsx(V,{mission:a,setSelectedMissionCardOptions:s},a.name))})};function Y({missionCardOptions:t,onClose:u}){const{t:s}=y(["common/sets","common/packs","pages/collection"]),r=t[0]||"",c=r.length>0?r.split("-")[0]:void 0,h=c===void 0?void 0:j(c),a=h?.name;return e.jsx(I,{open:!!t.length,onOpenChange:i=>{i||u()},children:e.jsxs(R,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto",children:[e.jsx(z,{children:e.jsx(_,{children:t.length===1?s("missionDetail.eligibleCards-singular",{ns:"pages/collection",options:1}):s("missionDetail.eligibleCards-plural",{ns:"pages/collection",options:t.length})})}),s(a??"Unknown expansion"),t.map(i=>{const l=w(i);return l&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx(H,{card:l,selected:!1})}),e.jsxs("p",{className:"max-w-[130px] whitespace-nowrap font-semibold text-[12px] pt-2",children:[i," - ",M(l,N.language),e.jsx("br",{}),h&&s("missionDetail.chanceFrom",{ns:"pages/collection",pack:s(l.pack,{ns:"common/packs"}),chance:B(h,l.pack,l).toFixed(2)})]})]},i)})]})})}const Z=["all","owned","missing"];function ne(){const{t}=y(["pages/collection","filters"]),u=L(),[s,r]=x.useState("A1"),[c,h]=x.useState("all"),[a,i]=x.useState(null),[l,f]=x.useState([]),[d]=x.useState(!1),p=n=>t(j(n).name,{ns:"common/sets"});return x.useEffect(()=>{let n=j(s).missions;if(!n)throw new Error(`This expansion has no missions: ${s}`);c==="owned"?n=n.filter(o=>o.completed):c==="missing"&&(n=n.filter(o=>!o.completed)),i(n)},[s,c]),e.jsxs("div",{className:"flex flex-col gap-y-1 mx-auto max-w-[900px]",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mx-4",children:[e.jsx(q,{label:t("expansion",{ns:"common/sets"}),options:W,value:s,onChange:r,show:p}),e.jsx(P,{options:Z,value:c,onChange:h,show:n=>t(n,{ns:"filters",keyPrefix:"f-owned"})}),e.jsx(A,{className:"ml-auto cursor-pointer",variant:"outline",onClick:()=>u("/collection"),children:t("goToCollection")})]}),a&&e.jsx(X,{missions:a,resetScrollTrigger:d,setSelectedMissionCardOptions:f}),e.jsx(Y,{missionCardOptions:l,onClose:()=>f([])})]})}export{ne as default};
