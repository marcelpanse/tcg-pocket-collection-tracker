import{J as N,r as w,U as C,at as F,u as T,au as P,av as k,aw as j,j as e,D as y,n as I,o as B,q as E,Q as u,B as x,ax as A}from"./index-DeW7bl5k.js";import{u as U,a as $,F as L,b as l,c as t,d as o,e as c,f as d,g as f,S as R,h as q}from"./SocialShareButtons-B1BtgUHi.js";import{A as H,a as J,b as M}from"./alert-B6Xr3wUC.js";import{S as Q}from"./siren-q1oaBO3b.js";import"./index-BVi_Jj0r.js";const W=({account:a,setAccount:b,isProfileDialogOpen:g,setIsProfileDialogOpen:h})=>{const v=N(),{user:p}=w.use(C),{toast:m}=F(),{t:s}=T("edit-profile"),_=P({username:j().min(2,{message:s("usernameTooShort")}),friend_id:j().regex(/^[0-9]{16}$/,{message:s("friendIdInvalid")}),is_public:k().optional()}),n=U({resolver:$(_),values:{username:a?.username||"",friend_id:a?.friend_id||"",is_public:a?.is_public||!1}}),D=async r=>{try{const i=await A.from("accounts").upsert({email:p?.user.email,username:r.username,friend_id:r.friend_id,is_public:r.is_public}).select().single();b(i.data),m({title:s("accountSaved"),variant:"default"})}catch(i){console.error("error saving account",i),m({title:s("accountSavingError"),variant:"destructive"})}},S=`https://tcgpocketcollectiontracker.com/#/collection/${a?.friend_id}`;return e.jsx(y,{open:g,onOpenChange:h,children:e.jsxs(I,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(B,{children:e.jsx(E,{children:s("editProfile")})}),e.jsxs(H,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx(J,{children:s("updateProfile.title")}),e.jsx(M,{children:s("updateProfile.description")})]}),e.jsx(L,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-8",children:[e.jsx(l,{name:"email",render:()=>e.jsxs(t,{children:[e.jsx(o,{children:s("email")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("email"),disabled:!0,value:p?.user.email})}),e.jsx(d,{children:s("registeredEmail")})]})}),e.jsx(l,{control:n.control,name:"username",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("username")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("username"),...r})}),e.jsx(d,{children:s("usernameDescription")}),e.jsx(f,{})]})}),e.jsx(l,{control:n.control,name:"friend_id",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("friendID")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("friendID"),...r})}),e.jsx(d,{children:s("friendIDDescription")}),e.jsx(f,{})]})}),e.jsx(l,{control:n.control,name:"is_public",render:({field:r})=>e.jsxs(t,{className:"flex flex-col items-start",children:[e.jsx(c,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(o,{children:s("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(R,{checked:r.value,onCheckedChange:r.onChange})}),e.jsx(x,{disabled:!a?.is_public,onClick:async i=>{i.preventDefault(),m({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(S)},children:s("isPublicButton")}),e.jsx(x,{disabled:!a?.is_public,onClick:async i=>{i.preventDefault(),h(!1),v(`/collection/${a?.friend_id}/trade`)},children:s("isPublicTradeButton")})]})}),e.jsx(d,{children:s("isPublicDescription")})]})}),a?.is_public&&e.jsx(q,{}),e.jsx(x,{type:"submit",children:s("save")})]})})]})})};export{W as default};
