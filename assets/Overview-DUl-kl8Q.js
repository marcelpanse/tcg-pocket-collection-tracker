import{j as t}from"./query-vendor-DjONLwH6.js";import{r as S}from"./react-vendor-Dbb1veav.js";import{D as q}from"./Filters-J5YT-pAW.js";import{c as se,a as k,b as $,u as K,g as D,d as V,p as Z,e as le,f as G,h as ee}from"./index-DoO82cKR.js";import{u as E,T as H,i as W}from"./i18n-vendor-B8-LMkwa.js";import{u as ae,R as re,D as ne}from"./index-BR0LKd-h.js";import{A as z,a as U,b as J}from"./alert-BqNB8ANh.js";import{T as oe,R as ce,B as ie,C as de,X as me,Y as fe,a as xe}from"./charts-vendor-DNUKMCvP.js";import{q as ue,r as pe}from"./ui-vendor-CGPvdk4X.js";import{S as he}from"./siren-BYbGonoi.js";import"./tabs-DICjPoHn.js";import"./supabase-vendor-D8YWDR9M.js";import"./xlsx-vendor-Bc83wVOq.js";import"./react-tooltip.min-lzlTQBxv.js";import"./index-Bnn3LD3j.js";const ge=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],be=se("heart",ge);function je(s){const e=k.c(34),{onClose:l}=s,{t:a}=E("footer");let r,n;e[0]!==l?(r=()=>{const N=F=>F.key==="Escape"&&l();return document.addEventListener("keydown",N),()=>document.removeEventListener("keydown",N)},n=[l],e[0]=l,e[1]=r,e[2]=n):(r=e[1],n=e[2]),S.useEffect(r,n);let i;e[3]!==l?(i=N=>{N.target===N.currentTarget&&l()},e[3]=l,e[4]=i):i=e[4];const d=i;let m;e[5]!==a?(m=a("modal.title"),e[5]=a,e[6]=m):m=e[6];let o;e[7]!==m?(o=t.jsx("h2",{className:"text-xl font-bold mb-4",children:m}),e[7]=m,e[8]=o):o=e[8];let c,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(c={projectName:"TCG Pocket Collection Tracker"},u={repo:t.jsx("a",{href:"https://github.com/marcelpanse/tcg-pocket-collection-tracker",target:"_blank",rel:"noopener noreferrer",className:"hover:underline text-blue-600",children:"GitHub repository"})},e[9]=c,e[10]=u):(c=e[9],u=e[10]);let h;e[11]!==a?(h=t.jsx("p",{className:"text-sm mb-3",children:t.jsx(H,{i18nKey:"modal.licenseSummary",t:a,values:c,components:u})}),e[11]=a,e[12]=h):h=e[12];let f;e[13]!==a?(f=a("modal.disclaimerTitle"),e[13]=a,e[14]=f):f=e[14];let g;e[15]!==f?(g=t.jsx("p",{className:"font-semibold",children:f}),e[15]=f,e[16]=g):g=e[16];let p;e[17]!==a?(p=a("modal.disclaimerText"),e[17]=a,e[18]=p):p=e[18];let b;e[19]!==p?(b=t.jsx("p",{className:"text-sm mb-2 whitespace-pre-line",children:p}),e[19]=p,e[20]=b):b=e[20];let v;e[21]!==a?(v=a("modal.copyright",{projectName:"TCG Pocket Collection Tracker"}),e[21]=a,e[22]=v):v=e[22];let j;e[23]!==v?(j=t.jsx("p",{className:"text-sm",children:v}),e[23]=v,e[24]=j):j=e[24];let C;e[25]!==g||e[26]!==b||e[27]!==j||e[28]!==o||e[29]!==h?(C=t.jsxs("div",{className:"bg-gray-200 text-gray-800 p-6 sm:p-8 rounded-lg shadow-lg w-full max-w-lg mx-4",children:[o,h,g,b,j]}),e[25]=g,e[26]=b,e[27]=j,e[28]=o,e[29]=h,e[30]=C):C=e[30];let x;return e[31]!==d||e[32]!==C?(x=t.jsx("button",{type:"button",onClick:d,className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:C}),e[31]=d,e[32]=C,e[33]=x):x=e[33],x}function Ne(){const s=k.c(17),[e,l]=S.useState(!1),{t:a}=E("footer");let r;s[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>l(!0),s[0]=r):r=s[0];let n;s[1]!==a?(n=a("licenseDisclaimer"),s[1]=a,s[2]=n):n=s[2];let i;s[3]!==n?(i=t.jsxs("p",{className:"m-1",children:["Â© 2025 TCG Pocket Collection Tracker."," ",t.jsx("button",{type:"button",onClick:r,className:"text-blue-300 underline hover:text-blue-500 cursor-pointer",children:n})]}),s[3]=n,s[4]=i):i=s[4];let d;s[5]!==a?(d=a("notAffiliated"),s[5]=a,s[6]=d):d=s[6];let m;s[7]!==d?(m=t.jsx("p",{className:"text-gray-400 mx-4 mb-1 whitespace-pre-line text-center text-xs",children:d}),s[7]=d,s[8]=m):m=s[8];let o;s[9]!==i||s[10]!==m?(o=t.jsxs("footer",{className:"text-center py-4 mx-2 text-gray-300 text-xs leading-snug",children:[i,m]}),s[9]=i,s[10]=m,s[11]=o):o=s[11];let c;s[12]!==e?(c=e&&t.jsx(je,{onClose:()=>l(!1)}),s[12]=e,s[13]=c):c=s[13];let u;return s[14]!==o||s[15]!==c?(u=t.jsxs(t.Fragment,{children:[o,c]}),s[14]=o,s[15]=c,s[16]=u):u=s[16],u}const ve=s=>{const e=k.c(28),{value:l,label:a,sublabel:r,color:n,strokeWidth:i}=s,d=n===void 0?"#38bdf8":n,m=i===void 0?10:i,o=(180-m)/2,c=2*Math.PI*o,u=c*(1-l);let h;e[0]!==a||e[1]!==l?(h=a??`Radial chart showing ${Math.round(l*100)}%`,e[0]=a,e[1]=l,e[2]=h):h=e[2];let f;e[3]!==h?(f=t.jsx("title",{children:h}),e[3]=h,e[4]=f):f=e[4];const g=m/2;let p;e[5]!==o||e[6]!==g?(p=t.jsx("circle",{cx:90,cy:90,r:o,fill:"none",stroke:"#404040",strokeWidth:g}),e[5]=o,e[6]=g,e[7]=p):p=e[7];let b;e[8]===Symbol.for("react.memo_cache_sentinel")?(b={transition:"stroke-dashoffset 0.5s"},e[8]=b):b=e[8];let v;e[9]!==c||e[10]!==d||e[11]!==u||e[12]!==o||e[13]!==m?(v=t.jsx("circle",{cx:90,cy:90,r:o,fill:"none",stroke:d,strokeWidth:m,strokeDasharray:c,strokeDashoffset:u,strokeLinecap:"butt",transform:"rotate(-90 90 90)",style:b}),e[9]=c,e[10]=d,e[11]=u,e[12]=o,e[13]=m,e[14]=v):v=e[14];let j;e[15]!==a||e[16]!==l?(j=a??`${Math.round(l*100)}%`,e[15]=a,e[16]=l,e[17]=j):j=e[17];let C;e[18]!==j?(C=t.jsx("text",{x:"50%",y:"45%",textAnchor:"middle",dominantBaseline:"central",className:"font-semibold text-4xl",fill:"#FFFFFF",children:j}),e[18]=j,e[19]=C):C=e[19];let x;e[20]!==r?(x=r&&t.jsx("text",{x:"50%",y:"63%",textAnchor:"middle",dominantBaseline:"central",className:"font-semibold text-sm",fill:"#A3A3A3",children:r}),e[20]=r,e[21]=x):x=e[21];let N;return e[22]!==C||e[23]!==x||e[24]!==f||e[25]!==p||e[26]!==v?(N=t.jsxs("svg",{width:180,height:180,children:[f,p,v,C,x]}),e[22]=C,e[23]=x,e[24]=f,e[25]=p,e[26]=v,e[27]=N):N=e[27],N};function M(s){const e=k.c(21),{title:l,percentage:a,className:r,backgroundColor:n}=s;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=["gradient-card","common/packs"],e[0]=i):i=e[0];const{t:d}=E(i),m=Math.round(a*1e3)/10;let o;e[1]!==r?(o=$(r,"tex flex flex-col items-center justify-center rounded-lg p-4 sm:p-8 transition-all duration-200"),e[1]=r,e[2]=o):o=e[2];let c;e[3]!==n?(c={backgroundColor:n},e[3]=n,e[4]=c):c=e[4];let u;e[5]===Symbol.for("react.memo_cache_sentinel")?(u=t.jsx("p",{className:"mb-1 text-center text-md sm:text-xl text-slate-900",children:t.jsx(H,{i18nKey:"open",ns:"gradient-card"})}),e[5]=u):u=e[5];let h;e[6]!==d||e[7]!==l?(h=d(l,{ns:"common/packs"}),e[6]=d,e[7]=l,e[8]=h):h=e[8];let f;e[9]!==h?(f=t.jsx("header",{className:"font-semibold text-center text-2xl sm:text-6xl text-slate-900",children:h}),e[9]=h,e[10]=f):f=e[10];let g;e[11]!==m?(g={chancePercentage:m},e[11]=m,e[12]=g):g=e[12];let p;e[13]===Symbol.for("react.memo_cache_sentinel")?(p={strong:t.jsx("span",{className:"font-bold"})},e[13]=p):p=e[13];let b;e[14]!==g?(b=t.jsx("p",{className:"mt-2 text-center text-md sm:text-xl text-slate-900",children:t.jsx(H,{i18nKey:"text",ns:"gradient-card",values:g,components:p})}),e[14]=g,e[15]=b):b=e[15];let v;return e[16]!==o||e[17]!==c||e[18]!==f||e[19]!==b?(v=t.jsxs("div",{className:o,style:c,children:[u,f,b]}),e[16]=o,e[17]=c,e[18]=f,e[19]=b,e[20]=v):v=e[20],v}function Ce(s){const e=k.c(8);let l,a;e[0]!==s?({className:l,...a}=s,e[0]=s,e[1]=l,e[2]=a):(l=e[1],a=e[2]);let r;e[3]!==l?(r=$("rounded-xl border bg-white text-neutral-950 shadow dark:bg-neutral-950 dark:text-neutral-50",l),e[3]=l,e[4]=r):r=e[4];let n;return e[5]!==a||e[6]!==r?(n=t.jsx("div",{className:r,...a}),e[5]=a,e[6]=r,e[7]=n):n=e[7],n}function ye(s){const e=k.c(8);let l,a;e[0]!==s?({className:l,...a}=s,e[0]=s,e[1]=l,e[2]=a):(l=e[1],a=e[2]);let r;e[3]!==l?(r=$("flex flex-col space-y-1.5 p-6",l),e[3]=l,e[4]=r):r=e[4];let n;return e[5]!==a||e[6]!==r?(n=t.jsx("div",{className:r,...a}),e[5]=a,e[6]=r,e[7]=n):n=e[7],n}function ke(s){const e=k.c(8);let l,a;e[0]!==s?({className:l,...a}=s,e[0]=s,e[1]=l,e[2]=a):(l=e[1],a=e[2]);let r;e[3]!==l?(r=$("font-semibold leading-none tracking-tight",l),e[3]=l,e[4]=r):r=e[4];let n;return e[5]!==a||e[6]!==r?(n=t.jsx("div",{className:r,...a}),e[5]=a,e[6]=r,e[7]=n):n=e[7],n}function we(s){const e=k.c(8);let l,a;e[0]!==s?({className:l,...a}=s,e[0]=s,e[1]=l,e[2]=a):(l=e[1],a=e[2]);let r;e[3]!==l?(r=$("content-center p-6 pt-0",l),e[3]=l,e[4]=r):r=e[4];let n;return e[5]!==a||e[6]!==r?(n=t.jsx("div",{className:r,...a}),e[5]=a,e[6]=r,e[7]=n):n=e[7],n}function Se(s){const e=k.c(8);let l,a;e[0]!==s?({className:l,...a}=s,e[0]=s,e[1]=l,e[2]=a):(l=e[1],a=e[2]);let r;e[3]!==l?(r=$("flex items-center p-6 pt-0",l),e[3]=l,e[4]=r):r=e[4];let n;return e[5]!==a||e[6]!==r?(n=t.jsx("div",{className:r,...a}),e[5]=a,e[6]=r,e[7]=n):n=e[7],n}const $e={light:"",dark:".dark"},te=S.createContext(null);function Fe(){const s=S.useContext(te);if(!s)throw new Error("useChart must be used within a <ChartContainer />");return s}function Pe(s){const e=k.c(27);let l,a,r,n,i;e[0]!==s?({id:n,className:a,children:l,config:r,...i}=s,e[0]=s,e[1]=l,e[2]=a,e[3]=r,e[4]=n,e[5]=i):(l=e[1],a=e[2],r=e[3],n=e[4],i=e[5]);const d=S.useId();let m;e[6]!==n||e[7]!==d?(m=n??d.replace(/:/g,""),e[6]=n,e[7]=d,e[8]=m):m=e[8];const o=`chart-${m}`;let c;e[9]!==r?(c={config:r},e[9]=r,e[10]=c):c=e[10];let u;e[11]!==a?(u=$("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-hidden [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector]:outline-hidden [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-surface]:outline-hidden",a),e[11]=a,e[12]=u):u=e[12];let h;e[13]!==o||e[14]!==r?(h=t.jsx(Te,{id:o,config:r}),e[13]=o,e[14]=r,e[15]=h):h=e[15];let f;e[16]!==l?(f=t.jsx(ce,{children:l}),e[16]=l,e[17]=f):f=e[17];let g;e[18]!==o||e[19]!==i||e[20]!==u||e[21]!==h||e[22]!==f?(g=t.jsxs("div",{"data-slot":"chart","data-chart":o,className:u,...i,children:[h,f]}),e[18]=o,e[19]=i,e[20]=u,e[21]=h,e[22]=f,e[23]=g):g=e[23];let p;return e[24]!==c||e[25]!==g?(p=t.jsx(te.Provider,{value:c,children:g}),e[24]=c,e[25]=g,e[26]=p):p=e[26],p}const Te=s=>{const e=k.c(8),{id:l,config:a}=s;let r;e[0]!==a?(r=Object.entries(a).filter(Ie),e[0]=a,e[1]=r):r=e[1];const n=r;if(!n.length)return null;let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=Object.entries($e),e[2]=i):i=e[2];let d;e[3]!==n||e[4]!==l?(d=i.map(c=>{const[u,h]=c;return`
${h} [data-chart=${l}] {
${n.map(f=>{const[g,p]=f,b=p.theme?.[u]??p.color;return b?`  --color-${g}: ${b};`:null}).join(`
`)}
}
`}),e[3]=n,e[4]=l,e[5]=d):d=e[5];const m=d.join(`
`);let o;return e[6]!==m?(o=t.jsx("style",{dangerouslySetInnerHTML:{__html:m}}),e[6]=m,e[7]=o):o=e[7],o},Le=oe;function Ee(s){const e=k.c(38),{active:l,className:a,indicator:r,hideLabel:n,hideIndicator:i,labelFormatter:d,labelClassName:m,formatter:o,color:c,nameKey:u,labelKey:h,payload:f,label:g}=s,p=r===void 0?"dot":r,b=n===void 0?!1:n,v=i===void 0?!1:i,{config:j}=Fe();let C;e[0]!==j||e[1]!==b||e[2]!==g||e[3]!==m||e[4]!==d||e[5]!==h||e[6]!==f?(C=()=>{if(b||!f?.length)return null;const[T]=f,y=`${h??T?.dataKey??T?.name??"value"}`,_=X(j,T,y),O=!h&&typeof g=="string"?j[g]?.label??g:_?.label;return d?t.jsx("div",{className:$("font-medium",m),children:d(O,f)}):O?t.jsx("div",{className:$("font-medium",m),children:O}):null},e[0]=j,e[1]=b,e[2]=g,e[3]=m,e[4]=d,e[5]=h,e[6]=f,e[7]=C):C=e[7];const x=C;if(!l||!f?.length)return null;const N=f.length===1&&p!=="dot";let F;e[8]!==a?(F=$("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),e[8]=a,e[9]=F):F=e[9];let L;e[10]!==N||e[11]!==x?(L=N?null:x(),e[10]=N,e[11]=x,e[12]=L):L=e[12];let P;if(e[13]!==c||e[14]!==j||e[15]!==o||e[16]!==v||e[17]!==p||e[18]!==u||e[19]!==N||e[20]!==f||e[21]!==x){let T;e[23]!==c||e[24]!==j||e[25]!==o||e[26]!==v||e[27]!==p||e[28]!==u||e[29]!==N||e[30]!==x?(T=(y,_)=>{const O=`${u??y.name??y.dataKey??"value"}`,A=X(j,y,O),B=c??y.payload?.fill??y.color;return t.jsx("div",{className:$("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",p==="dot"&&"items-center"),children:o&&y?.value!==void 0&&y.name?o(y.value,y.name,y,_,y.payload):t.jsxs(t.Fragment,{children:[A?.icon?t.jsx(A.icon,{}):!v&&t.jsx("div",{className:$("shrink-0 rounded-[2px] border-(--color-border) bg-(--color-bg)",{"h-2.5 w-2.5":p==="dot","w-1":p==="line","w-0 border-[1.5px] border-dashed bg-transparent":p==="dashed","my-0.5":N&&p==="dashed"}),style:{"--color-bg":B,"--color-border":B}}),t.jsxs("div",{className:$("flex flex-1 justify-between leading-none",N?"items-end":"items-center"),children:[t.jsxs("div",{className:"grid gap-1.5",children:[N?x():null,t.jsx("span",{className:"text-muted-foreground",children:A?.label??y.name})]}),y.value!=null&&t.jsx("span",{className:"font-mono font-medium text-foreground tabular-nums",children:typeof y.value=="number"?y.value.toLocaleString():String(y.value)})]})]})},_)},e[23]=c,e[24]=j,e[25]=o,e[26]=v,e[27]=p,e[28]=u,e[29]=N,e[30]=x,e[31]=T):T=e[31],P=f.map(T),e[13]=c,e[14]=j,e[15]=o,e[16]=v,e[17]=p,e[18]=u,e[19]=N,e[20]=f,e[21]=x,e[22]=P}else P=e[22];let w;e[32]!==P?(w=t.jsx("div",{className:"grid gap-1.5",children:P}),e[32]=P,e[33]=w):w=e[33];let I;return e[34]!==F||e[35]!==L||e[36]!==w?(I=t.jsxs("div",{className:F,children:[L,w]}),e[34]=F,e[35]=L,e[36]=w,e[37]=I):I=e[37],I}function X(s,e,l){if(typeof e!="object"||e===null)return;const a="payload"in e&&typeof e.payload=="object"&&e.payload!==null?e.payload:void 0;let r=l;return l in e&&typeof e[l]=="string"?r=e[l]:a&&l in a&&typeof a[l]=="string"&&(r=a[l]),r in s?s[r]:s[l]}function Ie(s){const[,e]=s;return e.theme??e.color}const Y=({title:s,data:e,config:l={},footer:a})=>{const{t:r}=E(["common/packs","expansion-overview"]);return t.jsxs(Ce,{className:"rounded-lg border-1 border-neutral-700 border-solid shadow-none dark:bg-neutral-800",children:[t.jsx(ye,{className:"text-center",children:t.jsx(ke,{className:"text-xl",children:s})}),t.jsx(we,{children:t.jsx(Pe,{config:l,children:t.jsxs(ie,{accessibilityLayer:!0,data:e.map(n=>({...n,percentage:n.percentage*100,[r("percentage",{ns:"expansion-overview"})]:n.percentage*100})),children:[t.jsx(de,{vertical:!1}),t.jsx(me,{dataKey:"packName",tickLine:!1,tickMargin:10,axisLine:!1}),t.jsx(fe,{type:"number",domain:[0,100],width:25}),t.jsx(Le,{cursor:!1,content:t.jsx(Oe,{payload:[],active:!1})}),t.jsx(xe,{dataKey:r("percentage",{ns:"expansion-overview"}),strokeWidth:2,radius:8})]})})}),t.jsx(Se,{className:"flex-1 flex-col items-center gap-2",children:a})]})},Oe=s=>{const e=k.c(5),{payload:l,active:a}=s;if(a&&l&&l.length){let r;e[0]!==l?(r=l.map(_e),e[0]=l,e[1]=r):r=e[1];const n=r;let i;return e[2]!==n||e[3]!==s?(i=t.jsx(Ee,{...s,payload:n,className:"bg-black"}),e[2]=n,e[3]=s,e[4]=i):i=e[4],i}return null};function _e(s){return{...s,value:`: ${Math.round(s.value*10)/10}%`}}function Re(s){const e=k.c(14);let l,a,r,n;e[0]!==s?({className:a,value:n,barColor:l,...r}=s,e[0]=s,e[1]=l,e[2]=a,e[3]=r,e[4]=n):(l=e[1],a=e[2],r=e[3],n=e[4]);let i;e[5]!==a?(i=$("relative h-2 w-full overflow-hidden rounded-full bg-neutral-900/20 dark:bg-neutral-50/20",a),e[5]=a,e[6]=i):i=e[6];const d=`translateX(-${100-(n||0)}%)`;let m;e[7]!==l||e[8]!==d?(m=t.jsx(pe,{className:"h-full w-full flex-1 bg-neutral-900 transition-all dark:bg-neutral-50",style:{transform:d,backgroundColor:l}}),e[7]=l,e[8]=d,e[9]=m):m=e[9];let o;return e[10]!==r||e[11]!==i||e[12]!==m?(o=t.jsx(ue,{className:i,...r,children:m}),e[10]=r,e[11]=i,e[12]=m,e[13]=o):o=e[13],o}function R({title:s,expansion:e,packName:l,rarityFilter:a=[],numberFilter:r=1,deckbuildingMode:n,barColor:i}){const{data:d=new Map}=K(),{t:m}=E("complete-progress"),o=D({ownedCards:d,rarityFilter:a,numberFilter:r,expansion:e,packName:l,deckbuildingMode:n}),c=V({rarityFilter:a,expansion:e,packName:l,deckbuildingMode:n}),u=o/c*100;return t.jsxs("div",{className:"sm:mt-4",children:[s,t.jsx(Re,{value:u||100,barColor:i}),m("youHave",{nCardsOwned:o,nTotalCards:c})]})}function Ae(s){const e=k.c(6),{padding:l,children:a}=s,r=S.useRef(null),n=`calc(${l} + 1.5rem)`;let i;e[0]!==l||e[1]!==n?(i={scrollPadding:l,paddingLeft:l,paddingRight:n,scrollbarWidth:"none"},e[0]=l,e[1]=n,e[2]=i):i=e[2];let d;return e[3]!==a||e[4]!==i?(d=t.jsx("section",{className:"relative",children:t.jsx("article",{ref:r,className:"flex overflow-x-auto hide-scroll gap-5 snap-x scroll-smooth",style:i,children:a})}),e[3]=a,e[4]=i,e[5]=d):d=e[5],d}function De({expansion:s,rarityFilter:e,numberFilter:l,deckbuildingMode:a}){const{data:r=new Map}=K(),{t:n}=E(["expansion-overview","common/sets","common/packs"]),i=ae({query:"(max-width: 767px)"});let{packs:d}=s;d.length>1&&(d=d.filter(c=>c.name!=="everypack"));const m=d.map(c=>({packName:n(c.name,{ns:"common/packs"}),percentage:Z({ownedCards:r,expansion:s,pack:c,rarityFilter:e,numberFilter:l,deckbuildingMode:a}),fill:c.color})),o=m.sort((c,u)=>u.percentage-c.percentage)[0];return t.jsxs(t.Fragment,{children:[t.jsxs("h2",{className:"ml-6 md:ml-0 mt-6 col-span-8 text-3xl flex items-center",children:[t.jsx("img",{src:`/images/sets/${W.language}/${s.id}.webp`,alt:`${s.id}`,className:"mr-2 inline max-w-[80px]",onError:c=>{W.language!=="en-US"&&(c.target.src=`/images/sets/en-US/${s.id}.webp`)}}),n(s.name,{ns:"common/sets"})]}),i?t.jsx("div",{className:"col-span-full",children:t.jsxs(Ae,{padding:"2rem",children:[!s.promo&&t.jsxs(t.Fragment,{children:[t.jsx(M,{title:o.packName,percentage:o.percentage,className:"col-span-8 snap-start flex-shrink-0 w-full",backgroundColor:o.fill}),t.jsx("div",{className:"col-span-8 snap-start flex-shrink-0 w-full",children:t.jsx(Y,{title:n("probabilityNewCard"),data:m})})]}),t.jsxs("div",{className:"col-span-8 snap-start flex-shrink-0 w-full border-1 border-neutral-700 border-solid rounded-lg p-4 sm:p-8",children:[t.jsx(R,{title:n("totalCards"),expansion:s,rarityFilter:e,numberFilter:l,deckbuildingMode:a}),s.packs.length>1&&s.packs.map(c=>t.jsx(R,{rarityFilter:e,title:n(c.name,{ns:"common/packs"}),expansion:s,packName:c.name,numberFilter:l,deckbuildingMode:a,barColor:c.color},c.name))]})]})}):t.jsxs(t.Fragment,{children:[!s.promo&&t.jsxs(t.Fragment,{children:[t.jsx(M,{title:o.packName,percentage:o.percentage,className:"col-span-8 lg:col-span-4",backgroundColor:o.fill}),t.jsx("div",{className:"col-span-4 lg:col-span-2",children:t.jsx(Y,{title:n("probabilityNewCard"),data:m})})]}),t.jsxs("div",{className:"col-span-4 lg:col-span-2",children:[t.jsx(R,{title:n("totalCards"),expansion:s,rarityFilter:e,numberFilter:l,deckbuildingMode:a}),s.packs.length>1&&s.packs.map(c=>t.jsx(R,{rarityFilter:e,numberFilter:l,title:n(c.name,{ns:"common/packs"}),expansion:s,packName:c.name,deckbuildingMode:a,barColor:c.color},c.name))]})]})]})}const Q=["all",...le.filter(s=>ee(s).openable)];function et(){const{data:s=new Map,isLoading:e}=K(),{t:l}=E(["pages/overview","filters","common/sets"]),[a,r]=S.useState(""),[n,i]=S.useState(""),[d,m]=S.useState(Q[1]),[o,c]=S.useState(()=>{const x=localStorage.getItem("rarityFilter");return x?JSON.parse(x):[]}),[u,h]=S.useState(()=>{const x=localStorage.getItem("numberFilter");return x?Number.parseInt(x,10):1}),[f,g]=S.useState(()=>localStorage.getItem("deckbuildingFilter")==="true");S.useEffect(()=>{fetch("https://vcwloujmsjuacqpwthee.supabase.co/storage/v1/object/public/stats/stats.json").then(x=>x.json()).then(x=>{r(x.collectionCount),i(x.usersCount)})},[]),S.useEffect(()=>{localStorage.setItem("rarityFilter",JSON.stringify(o)),localStorage.setItem("numberFilter",u.toString()),localStorage.setItem("deckbuildingFilter",JSON.stringify(f))},[o,u,f]);const p=()=>{let x=0;return s.forEach(N=>{x+=N.amount_owned}),x},b=V({rarityFilter:o,deckbuildingMode:f}),j=(()=>{let x;const N=G.filter(F=>F.openable);for(const F of N){const P=F.packs.filter(w=>w.name!=="everypack").map(w=>({packName:w.name,percentage:Z({ownedCards:s,expansion:F,pack:w,rarityFilter:o,numberFilter:u,deckbuildingMode:f}),fill:w.color})).sort((w,I)=>I.percentage-w.percentage)[0];P.percentage>(x?.percentage??-1)&&(x=P)}return x})(),C=x=>{const N=x==="all"?"all":ee(x).name;return l(N,{ns:"common/sets"})};return e?t.jsx("div",{className:"mx-auto mt-12 animate-spin rounded-full size-12 border-4 border-white border-t-transparent"}):t.jsxs("main",{className:"fade-in-up",children:[t.jsxs("article",{className:"mx-auto max-w-7xl px-8",children:[s.size===0&&t.jsxs(z,{className:"mb-8 border-1 border-neutral-700 shadow-none",children:[t.jsx(he,{className:"h-4 w-4"}),t.jsx(U,{children:l("dontHaveCards.title")}),t.jsx(J,{children:l("dontHaveCards.description")})]}),t.jsxs("div",{className:"mb-8 flex items-center gap-2 flex-wrap",children:[t.jsx(re,{rarityFilter:o,setRarityFilter:c,deckbuildingMode:f}),t.jsx(q,{label:l("f-number.numberCards",{ns:"filters"}),options:[1,2,3,4,5],value:u,onChange:h}),t.jsx("div",{className:"grow"}),t.jsx(ne,{deckbuildingMode:f,setDeckbuildingMode:g})]}),t.jsxs("section",{className:"grid grid-cols-8 gap-4 sm:gap-6",children:[t.jsxs("div",{className:"col-span-8 md:col-span-2 flex flex-col items-center justify-center rounded-lg border-1 border-neutral-700 bg-neutral-800 border-solid p-3 sm:p-6 md:p-8 mb-4 md:mb-0",children:[t.jsx("h2",{className:"font-bold mb-4 text-center text-base sm:text-lg md:text-3xl",children:l("uniqueCards")}),t.jsx(ve,{value:b===0?0:D({ownedCards:s,rarityFilter:o,numberFilter:u,deckbuildingMode:f})/b,label:`${D({ownedCards:s,rarityFilter:o,numberFilter:u,deckbuildingMode:f})}`,sublabel:`/ ${b}`,color:"#92C5FD",strokeWidth:24}),t.jsx("h2",{className:"mt-6 text-balance text-center text-sm sm:text-md md:text-md",children:u===1?l("numberOfCopies-single"):l("numberOfCopies-plural",{numberFilter:u})})]}),t.jsx(M,{title:j?.packName??"",percentage:j?.percentage??0,className:"col-span-8 md:col-span-4 col-start-1 md:col-start-3 mb-4 md:mb-0",backgroundColor:j?.fill}),t.jsxs("div",{className:"col-span-8 md:col-span-2 flex flex-col items-center justify-center rounded-lg border-1 border-neutral-700 bg-neutral-800 border-solid p-3 sm:p-6 md:p-8",children:[t.jsx("h2",{className:"mb-1 text-center text-base sm:text-lg md:text-2xl",children:l("youHave")}),t.jsx("h1",{className:"mb-2 text-balance text-center font-semibold text-2xl sm:text-3xl md:text-7xl",children:p()}),t.jsx("h2",{className:"text-balance text-center text-base sm:text-lg md:text-2xl",children:l("cardsTotal")})]})]})]}),t.jsx("article",{className:"flex mx-auto max-w-7xl px-8 pt-10 -mb-4",children:t.jsx(q,{label:l("expansion",{ns:"common/sets"}),options:Q,value:d,onChange:m,show:C})}),t.jsx("article",{className:"mx-auto max-w-7xl sm:p-6 p-0 pt-6 grid grid-cols-8 gap-6",children:G.filter(x=>d==="all"&&x.openable||d===x.id).map(x=>t.jsx(De,{expansion:x,rarityFilter:o,numberFilter:u,deckbuildingMode:f},x.id))}),s.size>0&&t.jsx("div",{className:"mx-auto max-w-2xl my-8",children:t.jsxs(z,{className:"border-1 border-neutral-700 shadow-none",children:[t.jsx(be,{className:"h-4 w-4"}),t.jsx(U,{children:l("stats.title")}),t.jsx(J,{children:l("stats.description",{usersCount:n,collectionCount:a})})]})}),t.jsx(Ne,{})]})}export{et as default};
