import{j as t}from"./query-vendor-DpGHCXpY.js";import{h as xe,c as ee,i as pe,j as te,o as he,B as W,t as ae,k as ge,l as ye,m as je,n as we,p as Y,q as ie,r as le,_ as G,s as ne,v as re,w as oe,x as be,y as _e,e as Ce,z as ve,S as se,C as Ne,D as Se,u as ke,E as Pe}from"./index-CQAG7dMy.js";import{r as ce,j as Te,L as de,f as $e,e as Fe}from"./react-vendor-DjlsVz29.js";import{F as Oe}from"./friend-id-display-tdGtaDxk.js";import{u as fe,i as Le}from"./i18n-vendor-DDmeScd6.js";import{u as Ie}from"./index-B1lMyoIz.js";import{M as Me}from"./react-tooltip.min-BcxhdgpL.js";import{C as Ae}from"./Card-CVLK5Fe4.js";import{F as Be,C as Ee}from"./FiltersPanel-B0UTOaES.js";import{u as De}from"./use-search-state-Dr8E9u4u.js";import{g as Z,s as qe,t as ze,o as Re}from"./filters-BWsXQaNl.js";import{T as Ge}from"./trash-2-2LwzLJfs.js";import"./charts-vendor-D-Ae2kUX.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-9yhwxkpr.js";import"./xlsx-vendor-De4COjWB.js";import"./Filters-DGeheIkU.js";import"./tabs-BpdYwftG.js";import"./index-5ziEWJdO.js";import"./FancyCard-Kwn3f6I9.js";import"./plus-C0YO15I-.js";import"./SearchInput-DNY1lc0p.js";const He=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Qe=xe("circle-alert",He),Ue=he({search:re().default(""),expansion:ie([G(Ce),oe("all")]).default("all"),pack:re().default("all"),cardType:ne(G(_e)).default([]),rarity:ne(G(be)).default([]),ownership:G(Re).default("all"),trading:G(ze).default("all"),sortBy:G(qe).default("expansion-newest"),sortDesc:Y().default(!1),minNumber:le().default(0),maxNumber:ie([le(),oe("∞")]).default("∞"),deckbuildingMode:Y().default(!1),allTextSearch:Y().default(!1)});function ue(s){const e=ee.c(80),{children:f,cards:n,isPublic:l,share:o}=s,{t:a}=fe("pages/collection");let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x={query:"(max-width: 767px)"},e[0]=x):x=e[0];const p=Ie(x),{setIsProfileDialogOpen:r}=pe(),[N,k]=ce.useState(!1),{data:c}=te(),[d,S,w]=De(Ue),[,T]=Te();let b;e[1]!==T?(b=()=>T(new URLSearchParams),e[1]=T,e[2]=b):b=e[2];const _=b;let m,h,g,y,C,i,v;if(e[3]!==c||e[4]!==n||e[5]!==d||e[6]!==r||e[7]!==o||e[8]!==a){m=Z(d,n,c?.trade_rarity_settings);let R;e[16]!==c||e[17]!==n||e[18]!==d||e[19]!==a?(R=()=>{if(!c)throw new Error("Cannot copy trade message without account");let u="";c.is_public&&(u=u+`${a("trade.publicTradePage")}: https://tcgpocketcollectiontracker.com/#/trade/${c?.friend_id}
`),c.username&&(u=u+`${a("trade.friendID")}: ${c.friend_id} (${c.username})

`);const H=j=>{j.sort(Je);for(let P=0;P<j.length;P++)(P>0?j[P-1].expansion:"")!==j[P].expansion&&(u=u+`
${j[P].expansion}:
`),u=u+`${j[P].rarity} ${j[P].card_id} - ${ve(j[P],Le.language)}
`};return u=u+`${a("trade.lookingForCards")}:
`,H(Z({...d,trading:"wanted"},n,c.trade_rarity_settings)),u=u+`

${a("trade.forTradeCards")}:
`,H(Z({...d,trading:"extra"},n,c.trade_rarity_settings)),u},e[16]=c,e[17]=n,e[18]=d,e[19]=a,e[20]=R):R=e[20],h=R;let J;e[21]!==r||e[22]!==o?(J=async function(){o?navigator.share&&(navigator.userAgentData?.mobile||/Mobi|Android/i.test(navigator.userAgent))?await navigator.share({title:"My Pokemon TCG Pocket collection",url:window.location.href}):(await navigator.clipboard.writeText(window.location.href),ae({title:"Copied to clipboard",variant:"default"})):r(!0)},e[21]=r,e[22]=o,e[23]=J):J=e[23],y=J;const me=()=>{let u=0;const H=new Set;for(const j of m)j.collected&&!H.has(j.internal_id)&&(u=u+(j.amount_owned||0),H.add(j.internal_id));return u};let K;e[24]!==n?(K=n?.get(83654)?.amount_owned??0,e[24]=n,e[25]=K):K=e[25],g=K>0,v="flex flex-col h-fit gap-2",C="flex gap-2",i=a("stats.summary",{selected:m.length,uniquesOwned:m.filter(Ve).length,totalOwned:me()}),e[3]=c,e[4]=n,e[5]=d,e[6]=r,e[7]=o,e[8]=a,e[9]=m,e[10]=h,e[11]=g,e[12]=y,e[13]=C,e[14]=i,e[15]=v}else m=e[9],h=e[10],g=e[11],y=e[12],C=e[13],i=e[14],v=e[15];let $;e[26]!==g||e[27]!==a?($=g&&t.jsxs(t.Fragment,{children:[t.jsx(Me,{id:"mewCardOwned",className:"text-start max-w-72",clickable:!0}),t.jsx(Qe,{className:"h-5 w-5","data-tooltip-id":"mewCardOwned","data-tooltip-content":a("stats.mewCardOwned")})]}),e[26]=g,e[27]=a,e[28]=$):$=e[28];let F;e[29]!==C||e[30]!==i||e[31]!==$?(F=t.jsxs("small",{className:C,children:[i,$]}),e[29]=C,e[30]=i,e[31]=$,e[32]=F):F=e[32];let O;e[33]!==_||e[34]!==d||e[35]!==S?(O=t.jsx(Be,{className:"flex flex-col gap-y-3",filters:d,setFilters:S,clearFilters:_}),e[33]=_,e[34]=d,e[35]=S,e[36]=O):O=e[36];let L;e[37]!==y||e[38]!==o||e[39]!==a?(L=o!==void 0&&t.jsx(W,{variant:"outline",onClick:y,children:a("filters.share")}),e[37]=y,e[38]=o,e[39]=a,e[40]=L):L=e[40];let I;e[41]!==c||e[42]!==h||e[43]!==l||e[44]!==a?(I=!l&&t.jsx(W,{className:"w-full",variant:"outline",disabled:!c,onClick:()=>navigator.clipboard.writeText(h()).then(()=>ae({title:a("trade.copiedInClipboard"),variant:"default",duration:3e3})),children:a("trade.button")}),e[41]=c,e[42]=h,e[43]=l,e[44]=a,e[45]=I):I=e[45];let M;e[46]!==l||e[47]!==a?(M=!l&&t.jsx(de,{className:"w-full",to:"/collection/missions",children:t.jsx(W,{className:"w-full",variant:"outline",children:a("goToMissions")})}),e[46]=l,e[47]=a,e[48]=M):M=e[48];let A;e[49]!==I||e[50]!==M||e[51]!==L?(A=t.jsxs("div",{className:"flex flex-col mt-4 gap-2",children:[L,I,M]}),e[49]=I,e[50]=M,e[51]=L,e[52]=A):A=e[52];let Q;e[53]!==A||e[54]!==v||e[55]!==F||e[56]!==O?(Q=t.jsxs("div",{className:v,children:[F,O,A]}),e[53]=A,e[54]=v,e[55]=F,e[56]=O,e[57]=Q):Q=e[57];const U=Q;let B;e[58]!==U||e[59]!==N||e[60]!==p?(B=p?t.jsx(ge,{open:N,onOpenChange:k,children:t.jsxs(ye,{side:"left",className:"w-full",children:[t.jsx(je,{children:t.jsx(we,{children:"Filters"})}),U]})}):t.jsx("div",{className:"w-80",children:U}),e[58]=U,e[59]=N,e[60]=p,e[61]=B):B=e[61];let E;e[62]!==w||e[63]!==_||e[64]!==p?(E=p&&t.jsxs("div",{className:"h-9 flex overflow-hidden text-center rounded-md text-sm font-medium border shadow-sm border-neutral-700 divide-x divide-neutral-700 [&>*]:cursor-pointer [&>*]:hover:bg-neutral-600 [&>*]:hover:text-neutral-50",children:[t.jsxs("button",{type:"button",className:"flex-1",onClick:()=>k(!0),children:["Filters",w>0&&` (${w})`]}),w>0&&t.jsx("button",{type:"button",className:"group px-2",onClick:_,children:t.jsx(Ge,{className:"stroke-neutral-200 group-hover:stroke-neutral-50"})})]}),e[62]=w,e[63]=_,e[64]=p,e[65]=E):E=e[65];const X=d.sortBy==="expansion-newest";let D;e[66]!==d.deckbuildingMode||e[67]!==l?(D=R=>t.jsx(Ae,{card:R,editable:!d.deckbuildingMode&&!l}),e[66]=d.deckbuildingMode,e[67]=l,e[68]=D):D=e[68];let q;e[69]!==m||e[70]!==X||e[71]!==D?(q=t.jsx(Ee,{cards:m,groupExpansions:X,render:D}),e[69]=m,e[70]=X,e[71]=D,e[72]=q):q=e[72];let z;e[73]!==f||e[74]!==E||e[75]!==q?(z=t.jsxs("div",{className:"w-full max-w-[900px]",children:[E,f,q]}),e[73]=f,e[74]=E,e[75]=q,e[76]=z):z=e[76];let V;return e[77]!==B||e[78]!==z?(V=t.jsxs("div",{className:"flex justify-center gap-2 xl:gap-8 px-1",children:[B,z]}),e[77]=B,e[78]=z,e[79]=V):V=e[79],V}function Ve(s){return!!s.collected}function Je(s,e){const f=s.expansion.localeCompare(e.expansion);return f!==0?f:s.rarity.localeCompare(e.rarity)}function Ke(){const{data:s,isLoading:e}=te(),{data:f=new Map,isLoading:n}=ke();return e||n?t.jsx(se,{size:"lg",overlay:!0}):t.jsx(ue,{cards:f,isPublic:!1,share:s!==void 0&&s.friend_id!==""&&s.is_public})}function We(s){const e=ee.c(39),{friendId:f}=s;let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n=["pages/collection","common"],e[0]=n):n=e[0];const{t:l}=fe(n),{data:o,isLoading:a}=Ne(f),{data:x,isLoading:p}=Se(f);if(a||p){let i;return e[1]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx(se,{size:"lg",overlay:!0}),e[1]=i):i=e[1],i}if(o===void 0||x===void 0){let i;return e[2]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx("p",{className:"text-xl text-center py-8",children:"Something went wrong"}),e[2]=i):i=e[2],i}if(o===null){let i;e[3]!==l?(i=l("common:noAccount"),e[3]=l,e[4]=i):i=e[4];let v;return e[5]!==i?(v=t.jsx("p",{className:"text-xl text-center py-8",children:i}),e[5]=i,e[6]=v):v=e[6],v}if(x===null){let i;return e[7]===Symbol.for("react.memo_cache_sentinel")?(i=t.jsx("p",{className:"text-xl text-center py-8",children:"Not a public account"}),e[7]=i):i=e[7],i}const r=`${o.username} collection – TCG Pocket Collection Tracker`;let N;e[8]!==r?(N=t.jsx("title",{children:r}),e[8]=r,e[9]=N):N=e[9];let k;e[10]!==l?(k=l("collectionOf"),e[10]=l,e[11]=k):k=e[11];let c;e[12]!==k?(c=t.jsx("span",{className:"text-2xl font-light",children:k}),e[12]=k,e[13]=c):c=e[13];let d;e[14]!==o.username?(d=t.jsxs("span",{className:"text-2xl font-bold",children:[" ",o.username," "]}),e[14]=o.username,e[15]=d):d=e[15];let S;e[16]!==o.friend_id?(S=t.jsx("span",{className:"block sm:inline text-sm",children:t.jsx(Oe,{friendId:o.friend_id})}),e[16]=o.friend_id,e[17]=S):S=e[17];let w;e[18]!==c||e[19]!==d||e[20]!==S?(w=t.jsxs("h1",{children:[c,d,S]}),e[18]=c,e[19]=d,e[20]=S,e[21]=w):w=e[21];const T=`/trade/${f}`;let b;e[22]!==l?(b=l("showPossibleTrades"),e[22]=l,e[23]=b):b=e[23];let _;e[24]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx(Pe,{}),e[24]=_):_=e[24];let m;e[25]!==b?(m=t.jsxs(W,{children:[b,_]}),e[25]=b,e[26]=m):m=e[26];let h;e[27]!==m||e[28]!==T?(h=t.jsx(de,{to:T,children:m}),e[27]=m,e[28]=T,e[29]=h):h=e[29];let g;e[30]!==h||e[31]!==w?(g=t.jsxs("div",{className:"flex justify-between my-2",children:[w,h]}),e[30]=h,e[31]=w,e[32]=g):g=e[32];let y;e[33]!==x||e[34]!==g?(y=t.jsx(ue,{cards:x,isPublic:!0,children:g}),e[33]=x,e[34]=g,e[35]=y):y=e[35];let C;return e[36]!==y||e[37]!==N?(C=t.jsxs("div",{className:"flex flex-col gap-y-1",children:[N,y]}),e[36]=y,e[37]=N,e[38]=C):C=e[38],C}function wt(){const s=ee.c(14),e=$e(),{friendId:f}=Fe(),{data:n,isLoading:l}=te();let o;s[0]!==n||s[1]!==l||s[2]!==e||s[3]!==f?(o=()=>{!f&&!l&&n?.friend_id&&e(`/collection/${n.friend_id}`,{replace:!0})},s[0]=n,s[1]=l,s[2]=e,s[3]=f,s[4]=o):o=s[4];const a=n?.friend_id;let x;if(s[5]!==l||s[6]!==e||s[7]!==f||s[8]!==a?(x=[l,f,a,e],s[5]=l,s[6]=e,s[7]=f,s[8]=a,s[9]=x):x=s[9],ce.useEffect(o,x),l){let r;return s[10]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(se,{size:"lg",overlay:!0}),s[10]=r):r=s[10],r}const p=f??n?.friend_id;if(p&&p!==n?.friend_id){let r;return s[11]!==p?(r=t.jsx(We,{friendId:p}),s[11]=p,s[12]=r):r=s[12],r}else{let r;return s[13]===Symbol.for("react.memo_cache_sentinel")?(r=t.jsx(Ke,{}),s[13]=r):r=s[13],r}}export{wt as default};
