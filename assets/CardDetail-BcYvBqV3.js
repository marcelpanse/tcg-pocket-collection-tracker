import{r,aG as I,aF as W,z as X,j as e,m as S,aH as Y,n as N,C as y,aI as Z,D as R,F as J,aN as Q,aO as ee,f as E,u as ae,a5 as se,o as te,aT as oe,a6 as ne,a1 as re,x as ie,a8 as ce,a9 as le,aa as de,ab as me,a0 as b,t as k,V as ue,Y as pe,Z as xe,X as fe,aU as _,ac as he,U as ge}from"./index-BqVUje8p.js";import{M as ve}from"./react-tooltip.min-D1SxipPd.js";import{C as je}from"./Card-BJX5OPDw.js";import{C as Ne}from"./CardLine-BbrSYCFg.js";import"./index-B1PdPLYa.js";import"./FancyCard-M6U28rSm.js";var C="Radio",[we,P]=S(C),[Re,ye]=we(C),D=r.forwardRef((s,t)=>{const{__scopeRadio:o,name:c,checked:n=!1,required:i,disabled:l,value:g="on",onCheck:x,form:a,...d}=s,[p,f]=r.useState(null),m=y(t,j=>f(j)),h=r.useRef(!1),v=p?a||!!p.closest("form"):!0;return e.jsxs(Re,{scope:o,checked:n,disabled:l,children:[e.jsx(N.button,{type:"button",role:"radio","aria-checked":n,"data-state":M(n),"data-disabled":l?"":void 0,disabled:l,value:g,...d,ref:m,onClick:R(s.onClick,j=>{n||x?.(),v&&(h.current=j.isPropagationStopped(),h.current||j.stopPropagation())})}),v&&e.jsx(T,{control:p,bubbles:!h.current,name:c,value:g,checked:n,required:i,disabled:l,form:a,style:{transform:"translateX(-100%)"}})]})});D.displayName=C;var A="RadioIndicator",G=r.forwardRef((s,t)=>{const{__scopeRadio:o,forceMount:c,...n}=s,i=ye(A,o);return e.jsx(J,{present:c||i.checked,children:e.jsx(N.span,{"data-state":M(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})})});G.displayName=A;var Ce="RadioBubbleInput",T=r.forwardRef(({__scopeRadio:s,control:t,checked:o,bubbles:c=!0,...n},i)=>{const l=r.useRef(null),g=y(l,i),x=Q(o),a=ee(t);return r.useEffect(()=>{const d=l.current;if(!d)return;const p=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(p,"checked").set;if(x!==o&&m){const h=new Event("click",{bubbles:c});m.call(d,o),d.dispatchEvent(h)}},[x,o,c]),e.jsx(N.input,{type:"radio","aria-hidden":!0,defaultChecked:o,...n,tabIndex:-1,ref:g,style:{...n.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});T.displayName=Ce;function M(s){return s?"checked":"unchecked"}var be=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],w="RadioGroup",[ke]=S(w,[I,P]),O=I(),F=P(),[_e,Ie]=ke(w),B=r.forwardRef((s,t)=>{const{__scopeRadioGroup:o,name:c,defaultValue:n,value:i,required:l=!1,disabled:g=!1,orientation:x,dir:a,loop:d=!0,onValueChange:p,...f}=s,m=O(o),h=W(a),[v,j]=X({prop:i,defaultProp:n??null,onChange:p,caller:w});return e.jsx(_e,{scope:o,name:c,required:l,disabled:g,value:v,onValueChange:j,children:e.jsx(Y,{asChild:!0,...m,orientation:x,dir:h,loop:d,children:e.jsx(N.div,{role:"radiogroup","aria-required":l,"aria-orientation":x,"data-disabled":g?"":void 0,dir:h,...f,ref:t})})})});B.displayName=w;var U="RadioGroupItem",$=r.forwardRef((s,t)=>{const{__scopeRadioGroup:o,disabled:c,...n}=s,i=Ie(U,o),l=i.disabled||c,g=O(o),x=F(o),a=r.useRef(null),d=y(t,a),p=i.value===n.value,f=r.useRef(!1);return r.useEffect(()=>{const m=v=>{be.includes(v.key)&&(f.current=!0)},h=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",h),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",h)}},[]),e.jsx(Z,{asChild:!0,...g,focusable:!l,active:p,children:e.jsx(D,{disabled:l,required:i.required,checked:p,...x,...n,name:i.name,ref:d,onCheck:()=>i.onValueChange(n.value),onKeyDown:R(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:R(n.onFocus,()=>{f.current&&a.current?.click()})})})});$.displayName=U;var Se="RadioGroupIndicator",L=r.forwardRef((s,t)=>{const{__scopeRadioGroup:o,...c}=s,n=F(o);return e.jsx(G,{...n,...c,ref:t})});L.displayName=Se;var Ee=B,V=$,z=L;const Pe=Ee,q=r.forwardRef(({className:s,...t},o)=>e.jsx(V,{ref:o,className:E("w-4 h-4 mr-2 rounded-full bg-neutral-700 hover:bg-neutral-500",s),...t}));q.displayName=V.displayName;const H=r.forwardRef(({className:s,...t},o)=>e.jsx(z,{ref:o,className:E("w-2 h-2 mx-1 xm-auto my-auto rounded-full flex bg-neutral-300",s),...t}));H.displayName=z.displayName;function Fe(){const{t:s}=ae(["pages/card-detail","common/types","common/packs","common/sets"]),{selectedCardId:t,setSelectedCardId:o}=se(),{data:c=new Map}=te(),n=oe(),[i,l]=r.useState(!1),[g,x]=r.useState(!1),a=r.useMemo(()=>t===void 0?void 0:ne(t),[t]),d=r.useMemo(()=>c.get(a?.internal_id||0),[t]),p=r.useMemo(()=>a?.alternate_versions.map(u=>({card:re(u),amount_owned:c.get(u)?.amount_owned??0})),[a,c]),f=r.useMemo(()=>a===void 0?void 0:ie(a?.expansion),[a]);if(r.useEffect(()=>{t&&l(!0)},[t]),t&&!a)return console.log(`Unrecognized card_id: ${t}`),null;if(a&&!f)return console.log(`Unrecognized expansion: ${a.expansion}`),null;const m=a?.pack==="everypack"?f?.packs[0].name:a?.pack,h=u=>new Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"long"}).format(new Date(u)),v=()=>{t&&d?.collection.includes(t)&&n.mutate({cardId:t})},j=d?.collection.includes(t||"");return e.jsx(ce,{open:!!t&&i,onOpenChange:u=>{u||(l(u),setTimeout(()=>o(void 0),300))},children:e.jsxs(le,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto w-full md:w-[725px]",children:[e.jsx(de,{children:e.jsxs(me,{children:[a&&b(a,k.language)," ",a?.rarity]})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx("div",{className:"cursor-pointer",children:a&&e.jsx(je,{className:"w-full",card:{...a,amount_owned:d?.amount_owned||0},onImageClick:()=>x(!0)},t)})}),e.jsxs(ue,{open:g,onOpenChange:x,children:[e.jsx(pe,{className:"hidden",children:e.jsx(xe,{children:"Card image dialog"})}),e.jsx(fe,{className:"flex items-center justify-center p-0 max-w-3xl max-h-[90vh]",children:a?.image&&e.jsx("img",{src:a.image,alt:b(a,k.language),className:"w-full h-full object-scale-down",onClick:()=>x(!1)})})]}),e.jsxs("div",{className:"p-4 w-full",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s("text.alternateVersions")}),p&&e.jsxs(Pe,{className:"w-fit",value:t,onValueChange:o,children:[p.map(u=>e.jsxs("label",{className:"flex items-center cursor-pointer",htmlFor:`radio-${u.card.card_id}`,children:[e.jsx(q,{id:`radio-${u.card.card_id}`,value:u.card.card_id,children:e.jsx(H,{})}),e.jsx(Ne,{className:"w-auto bg-transparent",card_id:u.card.card_id,rarity:"w-14",name:"hidden",details:"hidden",amount:"pl-4"})]},u.card.card_id)),e.jsxs("p",{className:"flex items-baseline mt-1",children:[e.jsxs("span",{className:"mr-4",children:[s("text.totalAmount"),":"]}),e.jsxs("span",{className:"text-neutral-400 ml-auto mr-2",children:["Ã—",p?.reduce((u,K)=>u+K.amount_owned,0)]})]})]})]}),e.jsxs("p",{className:"mt-8 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.expansion")})," ",a?.expansion]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.pack")})," ",a&&s(`${a.pack}`,{ns:"common/packs"})]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:"Energy"})," ",a?.energy]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.weakness")})," ",a&&s(`${a.weakness}`,{ns:"common/types"})||"N/A"]}),a?.hp&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.hp")})," ",a?.hp]}),a?.retreat&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.retreat")})," ",a.retreat]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.ability")})," ",a?.ability?.name??e.jsx("i",{children:"None"})]}),a?.ability&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.abilityEffect")})," ",a?.ability.effect]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.cardType")})," ",a&&s(`cardType.${a.card_type}`)]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.evolutionType")})," ",a&&s(`evolutionType.${a.evolution_type}`)]}),f&&m&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.chanceToPull",{ns:"pages/card-detail"})}),a&&he(f,m,a).toFixed(2),"%"]}),a&&_[a.rarity]&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.craftingCost")})," ",_[a.rarity]]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:s("text.artist")})," ",a?.artist]}),e.jsxs("p",{className:"mt-4 text-neutral-400 text-sm flex",children:[e.jsx("strong",{className:"font-semibold mr-1",children:s("text.updated")})," ",d?.updated_at?h(d.updated_at):"N/A"]}),j&&e.jsxs("div",{className:"mt-6",children:[e.jsx(ve,{id:"uncollect-tooltip",style:{maxWidth:"300px",whiteSpace:"normal",fontSize:14}}),e.jsx(ge,{variant:"destructive",onClick:v,disabled:n.isPending,"data-tooltip-id":"uncollect-tooltip","data-tooltip-content":s("text.uncollectTooltip"),children:n.isPending?"Uncollecting...":"Uncollect"})]})]})]})]})})}export{Fe as default};
