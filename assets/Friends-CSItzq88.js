import{j as s}from"./query-vendor-DpGHCXpY.js";import{h as T,c as te,hl as le,hs as ie,j as ce,h6 as de,ht as oe,h7 as me,gQ as xe,h8 as ue,B as d,gW as he}from"./index-Co2qPlkR.js";import{r as fe,L as pe}from"./react-vendor-DjlsVz29.js";import{F as H,M as je}from"./friend-id-display-Cgh-2Hqj.js";import{A as ge,U as se}from"./user-plus-BgQ4hNbF.js";import"./i18n-vendor-DDmeScd6.js";import"./charts-vendor-D-Ae2kUX.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-9yhwxkpr.js";import"./xlsx-vendor-De4COjWB.js";const Ne=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],be=T("clock",Ne);const ve=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ye=T("user-check",ve);const ke=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Y=T("user-x",ke);const we=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],G=T("users",we);function J(e){const l=te.c(4),{name:o}=e;let i;l[0]!==o?(i=o.slice(0,2).toUpperCase(),l[0]=o,l[1]=i):i=l[1];const m=i;let x;return l[2]!==m?(x=s.jsx("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-neutral-700 text-sm font-semibold text-neutral-200",children:m}),l[2]=m,l[3]=x):x=l[3],x}function ze(){const e=te.c(61),{data:l}=le(),{setIsLoginDialogOpen:o}=ie(),{data:i}=ce(),{data:m,isLoading:x}=de(),V=m===void 0?[]:m,{data:F,isLoading:S}=oe();let I;e[0]!==F?(I=F===void 0?[]:F,e[0]=F,e[1]=I):I=e[1];const u=I,n=me(),{toast:a}=xe(),{openChat:ne}=ue(),[c,Z]=fe.useState("");if(!l){let t,r,U;e[2]===Symbol.for("react.memo_cache_sentinel")?(t=s.jsx("div",{className:"mx-auto mb-6 flex h-16 w-16 items-center justify-center rounded-full bg-neutral-800",children:s.jsx(G,{className:"h-8 w-8 text-neutral-400"})}),r=s.jsx("h1",{className:"mb-2 text-2xl font-bold",children:"Friends"}),U=s.jsx("p",{className:"mb-8 text-neutral-400",children:"Log in to connect with friends and see trade opportunities."}),e[2]=t,e[3]=r,e[4]=U):(t=e[2],r=e[3],U=e[4]);let _;e[5]!==o?(_=()=>o(!0),e[5]=o,e[6]=_):_=e[6];let $;e[7]===Symbol.for("react.memo_cache_sentinel")?($=s.jsx(se,{className:"mr-2 h-4 w-4"}),e[7]=$):$=e[7];let B;return e[8]!==_?(B=s.jsx("main",{children:s.jsxs("article",{className:"mx-auto max-w-2xl px-4 py-24 text-center",children:[t,r,U,s.jsxs(d,{onClick:_,children:[$,"Log in to continue"]})]})}),e[8]=_,e[9]=B):B=e[9],B}let E;e[10]!==c||e[11]!==n||e[12]!==a?(E=()=>{const t=c.trim();t&&n.mutate({friend_id:t,action:"send_request"},{onSuccess:()=>{a({title:"Friend request sent!"}),Z("")},onError:r=>{a({variant:"destructive",title:"Error",description:r.message})}})},e[10]=c,e[11]=n,e[12]=a,e[13]=E):E=e[13];const h=E;let L;e[14]!==n||e[15]!==a?(L=t=>{n.mutate({friend_id:t,action:"accept"},{onSuccess:()=>a({title:"Friend request accepted!"}),onError:r=>a({variant:"destructive",title:"Error",description:r.message})})},e[14]=n,e[15]=a,e[16]=L):L=e[16];const K=L;let q;e[17]!==n||e[18]!==a?(q=t=>{n.mutate({friend_id:t,action:"decline"},{onSuccess:()=>a({title:"Friend request declined."}),onError:r=>a({variant:"destructive",title:"Error",description:r.message})})},e[17]=n,e[18]=a,e[19]=q):q=e[19];const O=q;let M;e[20]!==n||e[21]!==a?(M=t=>{n.mutate({friend_id:t,action:"revoke"},{onSuccess:()=>a({title:"Friend removed."}),onError:r=>a({variant:"destructive",title:"Error",description:r.message})})},e[20]=n,e[21]=a,e[22]=M):M=e[22];const ee=M,C=V.filter(Ce),Q=V.filter(_e),ae="mx-auto max-w-2xl px-4 sm:px-8 py-10 flex flex-col gap-6";let f;e[23]===Symbol.for("react.memo_cache_sentinel")?(f=s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-neutral-800",children:s.jsx(G,{className:"h-5 w-5 text-neutral-300"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold leading-tight",children:"Friends"}),s.jsx("p",{className:"text-sm text-neutral-400",children:"Connect with others to find trade matches"})]})]}),e[23]=f):f=e[23];let p;e[24]!==i?(p=i?.friend_id&&s.jsxs("div",{className:"rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-1",children:"Your Friend ID"}),s.jsx("p",{className:"text-sm text-neutral-400 mb-3",children:"Share this with others so they can add you."}),s.jsx("div",{className:"flex items-center gap-2 rounded-lg bg-neutral-900 border border-neutral-700 px-4 py-3",children:s.jsx(H,{friendId:i.friend_id,className:"text-sm font-mono flex-1"})})]}),e[24]=i,e[25]=p):p=e[25];let D,P;e[26]===Symbol.for("react.memo_cache_sentinel")?(D=s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-1",children:"Add Friend"}),P=s.jsx("p",{className:"text-sm text-neutral-400 mb-4",children:"Enter a friend's ID to send them a request."}),e[26]=D,e[27]=P):(D=e[26],P=e[27]);let R;e[28]===Symbol.for("react.memo_cache_sentinel")?(R=t=>Z(t.target.value),e[28]=R):R=e[28];let j;e[29]!==h?(j=t=>t.key==="Enter"&&h(),e[29]=h,e[30]=j):j=e[30];let g;e[31]!==c||e[32]!==j?(g=s.jsx(he,{placeholder:"Enter friend ID",value:c,onChange:R,onKeyDown:j,className:"border-neutral-700 bg-neutral-900"}),e[31]=c,e[32]=j,e[33]=g):g=e[33];let N;e[34]!==c||e[35]!==n?(N=!c.trim()||n.isPending,e[34]=c,e[35]=n,e[36]=N):N=e[36];let z;e[37]===Symbol.for("react.memo_cache_sentinel")?(z=s.jsx(se,{className:"h-4 w-4 mr-1.5"}),e[37]=z):z=e[37];let b;e[38]!==h||e[39]!==N?(b=s.jsxs(d,{onClick:h,disabled:N,className:"shrink-0",children:[z,"Send Request"]}),e[38]=h,e[39]=N,e[40]=b):b=e[40];let v;e[41]!==g||e[42]!==b?(v=s.jsxs("div",{className:"rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",children:[D,P,s.jsxs("div",{className:"flex gap-2",children:[g,b]})]}),e[41]=g,e[42]=b,e[43]=v):v=e[43];let y;e[44]!==K||e[45]!==O||e[46]!==n||e[47]!==S||e[48]!==u?(y=(S||u.length>0)&&s.jsxs("div",{className:"rounded-xl border border-amber-700/40 bg-amber-950/20 p-5",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(be,{className:"h-4 w-4 text-amber-400"}),s.jsxs("p",{className:"text-sm font-semibold text-amber-300",children:["Pending Requests",u.length>0&&s.jsx("span",{className:"ml-1.5 rounded-full bg-amber-500/20 px-2 py-0.5 text-xs font-medium text-amber-300",children:u.length})]})]}),S?s.jsx("p",{className:"text-neutral-400 text-sm",children:"Loading..."}):s.jsx("div",{className:"flex flex-col gap-2",children:u.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-neutral-800/80 border border-neutral-700 p-3 gap-3",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.jsxs(d,{size:"sm",onClick:()=>K(t.friend_id),disabled:n.isPending,children:[s.jsx(ye,{className:"h-4 w-4 mr-1"}),"Accept"]}),s.jsxs(d,{size:"sm",variant:"outline",onClick:()=>O(t.friend_id),disabled:n.isPending,children:[s.jsx(Y,{className:"h-4 w-4 mr-1"}),"Decline"]})]})]},t.id))})]}),e[44]=K,e[45]=O,e[46]=n,e[47]=S,e[48]=u,e[49]=y):y=e[49];const re="rounded-xl border border-neutral-700 bg-neutral-800/60 p-5",W=C.length>0&&s.jsxs("span",{className:"ml-2 normal-case font-normal text-neutral-400",children:["(",C.length,")"]});let k;e[50]!==W?(k=s.jsxs("p",{className:"text-xs font-semibold uppercase tracking-wider text-neutral-500 mb-4",children:["My Friends",W]}),e[50]=W,e[51]=k):k=e[51];const X=x?s.jsx("p",{className:"text-neutral-400 text-sm",children:"Loading..."}):C.length===0&&Q.length===0?s.jsxs("div",{className:"flex flex-col items-center py-8 text-center",children:[s.jsx("div",{className:"mb-3 flex h-12 w-12 items-center justify-center rounded-full bg-neutral-700",children:s.jsx(G,{className:"h-6 w-6 text-neutral-500"})}),s.jsx("p",{className:"text-sm text-neutral-400",children:"No friends yet."}),s.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"Send a request above to get started!"})]}):s.jsxs("div",{className:"flex flex-col gap-2",children:[C.map(t=>s.jsxs("div",{className:"flex flex-col gap-2 rounded-lg bg-neutral-900/60 border border-neutral-700 p-3 md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs("div",{className:"flex gap-2 shrink-0",children:[s.jsxs(d,{size:"sm",variant:"outline",className:"flex-1 md:flex-none",onClick:()=>ne(t.friend_id,t.username||t.friend_id),children:[s.jsx(je,{className:"h-3.5 w-3.5 mr-1.5"}),"Chat"]}),s.jsx(pe,{to:`/trade/${t.friend_id}`,className:"flex-1 md:flex-none",children:s.jsxs(d,{size:"sm",variant:"outline",className:"w-full",children:["Trade matches",s.jsx(ge,{className:"ml-1.5 h-3.5 w-3.5"})]})}),s.jsx(d,{size:"sm",variant:"ghost",onClick:()=>ee(t.friend_id),disabled:n.isPending,className:"text-neutral-500 hover:text-red-400 hover:bg-red-900/20",children:s.jsx(Y,{className:"h-4 w-4"})})]})]},t.id)),Q.length>0&&s.jsxs(s.Fragment,{children:[C.length>0&&s.jsx("hr",{className:"border-neutral-700 my-1"}),s.jsx("p",{className:"text-xs text-neutral-500 mb-1 mt-1",children:"Sent requests"}),Q.map(t=>s.jsxs("div",{className:"flex items-center justify-between rounded-lg bg-neutral-900/60 border border-neutral-700 p-3 gap-3 opacity-70",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[s.jsx(J,{name:t.username||t.friend_id}),s.jsxs("div",{className:"min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("p",{className:"font-medium truncate",children:t.username||t.friend_id}),s.jsx("span",{className:"text-xs border border-neutral-600 rounded-full px-2 py-0.5 text-neutral-400",children:"Pending"})]}),s.jsx(H,{friendId:t.friend_id,showCopyButton:!1,className:"text-xs text-neutral-500"})]})]}),s.jsxs(d,{size:"sm",variant:"ghost",onClick:()=>ee(t.friend_id),disabled:n.isPending,className:"shrink-0 text-neutral-500 hover:text-red-400 hover:bg-red-900/20",children:[s.jsx(Y,{className:"h-4 w-4 mr-1"}),"Cancel"]})]},t.id))]})]});let w;e[52]!==k||e[53]!==X?(w=s.jsxs("div",{className:re,children:[k,X]}),e[52]=k,e[53]=X,e[54]=w):w=e[54];let A;return e[55]!==v||e[56]!==y||e[57]!==w||e[58]!==f||e[59]!==p?(A=s.jsx("main",{children:s.jsxs("article",{className:ae,children:[f,p,v,y,w]})}),e[55]=v,e[56]=y,e[57]=w,e[58]=f,e[59]=p,e[60]=A):A=e[60],A}function _e(e){return e.state==="pending"}function Ce(e){return e.state==="accepted"}export{ze as default};
