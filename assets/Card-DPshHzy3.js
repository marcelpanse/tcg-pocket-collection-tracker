import{e as v,aT as y,O as k,ac as I,aR as M,r as n,j as t,f as D,T as L,t as T,B as x,aU as B}from"./index-Cn_Vh_qv.js";import{F as S}from"./FancyCard-CQ65d3Il.js";import{T as F}from"./trash-2-BuBaCUtQ.js";const O=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],E=v("plus",O),c={};function U({card:e,onImageClick:h,className:C,editable:g=!0}){const{setIsLoginDialogOpen:d}=y(),{setSelectedCardId:f}=k(),u=I(),r=M(),[s,j]=n.useState(e.amount_owned||0),[l,w]=n.useState(void 0);n.useEffect(()=>{w(s)},[s]);const i=n.useCallback(async o=>{const a=e.card_id,p=Math.max(0,o);j(p),c[a]&&window.clearTimeout(c[a]),c[a]=window.setTimeout(async()=>{u.mutate({updates:[{card_id:a,internal_id:e.internal_id,amount_owned:p}]})},1e3)},[s,u,e.card_id]),N=n.useCallback(async()=>{await i(s+1)},[i,d]),m=n.useCallback(async()=>{await i(s-1)},[i,d]),b=n.useCallback(async()=>{e.collected&&l===0?r.mutate({cardId:e.card_id}):await m()},[e.collected,e.card_id,l,r,m]),_=async o=>{const a=o.target.value===""?0:Number.parseInt(o.target.value,10);!Number.isNaN(a)&&a>=0&&await i(a)};return t.jsxs("div",{className:D("group flex flex-col items-center rounded-lg",C),children:[t.jsx("button",{type:"button",className:"cursor-pointer",onClick:()=>{f(e.internal_id),h?.()},children:t.jsx(S,{card:e,selected:!!e.collected})}),t.jsxs("p",{className:"w-full min-w-0 text-[12px] pt-2 text-center font-semibold leading-tight",title:e.updated_at?`Last update ${new Date(e.updated_at).toLocaleString()}`:void 0,children:[t.jsx("span",{className:"block md:inline",children:e.card_id}),t.jsx("span",{className:"hidden md:inline",children:" â€“ "}),t.jsx("span",{className:"block md:inline truncate",children:L(e,T.language)})]}),t.jsx("div",{className:"flex items-center gap-x-1",children:g?t.jsxs(t.Fragment,{children:[t.jsx(x,{variant:"ghost",size:"icon",onClick:b,className:"rounded-full",tabIndex:-1,disabled:!e.collected&&l===0,title:l===0?"Remove from card dex":"Decrease amount",children:e.collected&&l===0?t.jsx(F,{}):t.jsx(B,{})}),t.jsx("input",{min:"0",max:"99",type:"text",value:l,onChange:_,className:"w-7 text-center border-none rounded",onFocus:o=>o.target.select()}),t.jsx(x,{variant:"ghost",size:"icon",className:"rounded-full",onClick:N,tabIndex:-1,title:"Increase amount",children:t.jsx(E,{})})]}):t.jsx("span",{className:"mt-1",children:s})})]})}export{U as C};
