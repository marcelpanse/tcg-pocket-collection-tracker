import{j as a}from"./query-vendor-DpGHCXpY.js";import{c as O,s as R,h5 as D,hm as $,a as U,o as q,B as L,hf as G,S as H}from"./index-HgUGxttl.js";import{i as J}from"./i18n-vendor-DDmeScd6.js";import{r as A}from"./react-vendor-DjlsVz29.js";import{F as K}from"./FancyCard-D9DzNfuD.js";import{T as Q}from"./trash-2-XPVY_-0c.js";import{P as V}from"./plus-DQQsn7al.js";function le(g){const e=O.c(53),{card:t,onImageClick:k,className:S,editable:E}=g,B=E===void 0?!0:E,{setSelectedCardId:F}=R(),j=D(),C=$(),N=j.isPending||C.isPending,[s,P]=A.useOptimistic(t.amount_owned??0,X);let b;e[0]!==t.card_id||e[1]!==t.internal_id||e[2]!==P||e[3]!==j?(b=_=>{A.startTransition(async()=>{P(_);try{await j.mutateAsync({updates:[{card_id:t.card_id,internal_id:t.internal_id,amount_owned:_}]})}catch(h){console.log("Failed updating card count:",h)}})},e[0]=t.card_id,e[1]=t.internal_id,e[2]=P,e[3]=j,e[4]=b):b=e[4];const n=b;let v;e[5]!==s||e[6]!==t.card_id||e[7]!==t.collected||e[8]!==C||e[9]!==n?(v=()=>{t.collected&&s===0?A.startTransition(async()=>{await C.mutateAsync({cardId:t.card_id})}):n(s-1)},e[5]=s,e[6]=t.card_id,e[7]=t.collected,e[8]=C,e[9]=n,e[10]=v):v=e[10];const M=v;let y;e[11]!==n?(y=async _=>{const h=_.target.value===""?0:Number.parseInt(_.target.value,10);!Number.isNaN(h)&&h>=0&&n(h)},e[11]=n,e[12]=y):y=e[12];const T=y;let i;e[13]!==S?(i=U("group flex flex-col items-center rounded-lg",S),e[13]=S,e[14]=i):i=e[14];let l;e[15]!==t.internal_id||e[16]!==k||e[17]!==F?(l=()=>{F(t.internal_id),k?.()},e[15]=t.internal_id,e[16]=k,e[17]=F,e[18]=l):l=e[18];const z=!!t.collected&&!N;let d;e[19]!==t||e[20]!==z?(d=a.jsx(K,{card:t,selected:z}),e[19]=t,e[20]=z,e[21]=d):d=e[21];let r;e[22]!==N?(r=N&&a.jsx(H,{size:"md",overlay:!0}),e[22]=N,e[23]=r):r=e[23];let c;e[24]!==l||e[25]!==d||e[26]!==r?(c=a.jsxs("button",{type:"button",className:"relative cursor-pointer",onClick:l,children:[d,r]}),e[24]=l,e[25]=d,e[26]=r,e[27]=c):c=e[27];let o;e[28]!==t.updated_at?(o=t.updated_at?`Last update ${t.updated_at.toLocaleString()}`:void 0,e[28]=t.updated_at,e[29]=o):o=e[29];let m;e[30]!==t.card_id?(m=a.jsx("span",{className:"block md:inline",children:t.card_id}),e[30]=t.card_id,e[31]=m):m=e[31];let w;e[32]===Symbol.for("react.memo_cache_sentinel")?(w=a.jsx("span",{className:"hidden md:inline",children:" â€“ "}),e[32]=w):w=e[32];let u;e[33]!==t?(u=q(t,J.language),e[33]=t,e[34]=u):u=e[34];let p;e[35]!==u?(p=a.jsx("span",{className:"block md:inline truncate",children:u}),e[35]=u,e[36]=p):p=e[36];let f;e[37]!==o||e[38]!==m||e[39]!==p?(f=a.jsxs("p",{className:"w-full min-w-0 text-[12px] pt-2 text-center font-semibold leading-tight",title:o,children:[m,w,p]}),e[37]=o,e[38]=m,e[39]=p,e[40]=f):f=e[40];let x;e[41]!==s||e[42]!==t.collected||e[43]!==B||e[44]!==T||e[45]!==M||e[46]!==n?(x=a.jsx("div",{className:"flex items-center gap-x-1",children:B?a.jsxs(a.Fragment,{children:[a.jsx(L,{variant:"ghost",size:"icon",onClick:M,className:"rounded-full",tabIndex:-1,disabled:!t.collected&&s===0,title:s===0?"Remove from card dex":"Decrease amount",children:t.collected&&s===0?a.jsx(Q,{}):a.jsx(G,{})}),a.jsx("input",{min:"0",max:"99",type:"text",value:s,onChange:T,className:"w-7 text-center border-none rounded",onFocus:W}),a.jsx(L,{variant:"ghost",size:"icon",className:"rounded-full",onClick:()=>n(s+1),tabIndex:-1,title:"Increase amount",children:a.jsx(V,{})})]}):a.jsx("span",{className:"mt-1",children:s})}),e[41]=s,e[42]=t.collected,e[43]=B,e[44]=T,e[45]=M,e[46]=n,e[47]=x):x=e[47];let I;return e[48]!==c||e[49]!==f||e[50]!==x||e[51]!==i?(I=a.jsxs("div",{className:i,children:[c,f,x]}),e[48]=c,e[49]=f,e[50]=x,e[51]=i,e[52]=I):I=e[52],I}function W(g){return g.target.select()}function X(g,e){return e}export{le as C};
