import{e as H,u as j,n as E,Q as $,r as p,j as e,S,v as N,s as M,T as F,E as I,t as T,U as D,V as R,W as z,X as O,Y as _,F as A,Z as B,B as L}from"./index-TK6-vxKz.js";import{E as W}from"./ExpansionsFilter-n0funVsV.js";import{O as q}from"./OwnedFilter-DxakAAXX.js";import{M as C,C as U}from"./react-tooltip.min-Cr8NRO0U.js";import{F as k}from"./FancyCard-D7C0g-PI.js";import{u as Q}from"./useWindowDimensionsHook-Dmp7fFiA.js";import"./tabs-CIWXcDx9.js";import"./index-DqJYdHKy.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Y=H("trophy",V),G=({mission:t,setSelectedMissionCardOptions:h})=>{const{width:s}=Q(),{t:c}=j("common/packs"),{data:m=[]}=E(),{setSelectedCardId:u}=$();let a=5,n=Math.min(s,890)/5+120;s>600&&s<800?(a=4,n=s/3+50):s<=600&&(a=3,n=s/3+100);const l=p.useMemo(()=>{let d=!0;const o=t.requiredCards.flatMap(i=>{let x=m.reduce((g,v)=>{const b=i.options.find(w=>w===v.card_id);if(b)for(let w=0;w<v.amount_owned;w++)g.push({cardId:b,owned:!0,missionCardOptions:i.options});return g},[]);x.length>i.amount&&(x=x.slice(0,i.amount));const y=i.amount-x.length;for(let g=0;g<y;g++)x.push({cardId:i.options[0],owned:!1,missionCardOptions:i.options});return d=d&&y===0,x});t.completed=d;const r=[];for(let i=0;i<o.length;i+=a)r.push(o.slice(i,i+a));return r},[a]),f=n*l.length+72;return e.jsxs("div",{style:{height:`${f}px`},className:"relative w-full",children:[e.jsx("div",{style:{height:`${f}px`},className:"relative w-full",children:l.map((d,o)=>e.jsx("div",{style:{height:`${n}px`,transform:`translateY(${n*o+72}px)`},className:"absolute top-0 left-0 w-full",children:e.jsx("div",{className:"flex justify-start gap-x-3",children:d.map((r,i)=>{const x=S(r.cardId);return x&&e.jsxs("div",{className:"group flex w-fit max-w-32 md:max-w-40 flex-col items-center rounded-lg cursor-pointer",children:[e.jsx("button",{type:"button",onClick:()=>r.owned?u(r.cardId):h(r.missionCardOptions),children:e.jsx(k,{card:x,selected:r.owned})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[r.cardId," - ",N(x,M.language)]})]},`${t.name}__${i}`)})})},o))}),e.jsx("div",{style:{height:"72px"},className:"absolute top-0 left-0 w-full",children:e.jsxs("h2",{className:"flex items-center gap-x-4 mx-auto mt-10 w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-md sm:text-lg md:text-2xl tracking-tight transition-colors first:mt-0",children:[t.name,e.jsx(C,{id:`rewardDescription${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(Y,{className:"h-6 w-6","data-tooltip-id":`rewardDescription${t.name}`,"data-tooltip-html":t.reward}),e.jsx(C,{id:`probability${t.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(U,{className:"h-6 w-6","data-tooltip-id":`probability${t.name}`,"data-tooltip-html":t.completed?"Completed!":F(t,l).filter(([d,o])=>d!=="everypack"&&o>0).map(([d,o])=>`${c(d)}: ${o.toFixed(2)}%`).join("<br/>")})]})},"header")]})},P=({missions:t,resetScrollTrigger:h,setSelectedMissionCardOptions:s})=>{const c=p.useRef(null),[m,u]=p.useState("auto");return p.useLayoutEffect(()=>{const a=()=>{if(c.current){const n=document.querySelector("#header")?.offsetHeight||0,l=document.querySelector("#filterbar")?.offsetHeight||0,f=window.innerHeight-n-l;u(`${f}px`)}};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),p.useEffect(()=>{c.current&&(c.current.scrollTop=0)},[h]),e.jsx("div",{ref:c,className:"overflow-y-auto mt-2 sm:mt-4 px-4 flex flex-col justify-start",style:{scrollbarWidth:"none",height:m},children:t.map(a=>e.jsx(G,{mission:a,setSelectedMissionCardOptions:s},a.name))})};function X({missionCardOptions:t,onClose:h}){const{t:s}=j(["common/sets","common/packs","pages/collection"]),c=t[0]||"",m=c.length>0?c.split("-")[0]:"Unknown",u=I(m)||T[0],a=u.name;return e.jsx(D,{open:!!t.length,onOpenChange:n=>{n||h()},children:e.jsxs(R,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto",children:[e.jsx(z,{children:e.jsx(O,{children:t.length===1?s("missionDetail.eligibleCards-singular",{ns:"pages/collection",options:1}):s("missionDetail.eligibleCards-plural",{ns:"pages/collection",options:t.length})})}),s(a),t.map(n=>{const l=S(n);return l&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx(k,{card:l,selected:!1})}),e.jsxs("p",{className:"max-w-[130px] whitespace-nowrap font-semibold text-[12px] pt-2",children:[n," - ",N(l,M.language),e.jsx("br",{}),s("missionDetail.chanceFrom",{ns:"pages/collection",pack:s(l.pack,{ns:"common/packs"}),chance:_(u,l.pack,l).toFixed(2)})]})]})})]})})}function ne(){const{t}=j(["pages/collection"]),h=A(),[s,c]=p.useState("A1"),[m,u]=p.useState("all"),[a,n]=p.useState(null),[l,f]=p.useState([]),[d]=p.useState(!1);return p.useEffect(()=>{let o=B.get(s)?.missions;if(!o)throw new Error(`Unrecognized expansion id: ${s}`);m==="owned"?o=o.filter(r=>r.completed):m==="missing"&&(o=o.filter(r=>!r.completed)),n(o)},[s,m]),e.jsxs("div",{className:"flex flex-col gap-y-1 mx-auto max-w-[900px]",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mx-4",children:[e.jsx(W,{value:s,onChange:c,allowAll:!1}),e.jsx(q,{ownedFilter:m,setOwnedFilter:u}),e.jsx(L,{className:"ml-auto cursor-pointer",variant:"outline",onClick:()=>h("/collection"),children:t("goToCollection")})]}),a&&e.jsx(P,{missions:a,resetScrollTrigger:d,setSelectedMissionCardOptions:f}),e.jsx(X,{missionCardOptions:l,onClose:()=>f([])})]})}export{ne as default};
