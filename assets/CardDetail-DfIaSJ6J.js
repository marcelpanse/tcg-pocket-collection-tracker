import{j as e}from"./query-vendor-BtExsvmS.js";import{u as I,i as f}from"./i18n-vendor-Dl1_3pZV.js";import{r as p}from"./react-vendor-BHI5tqau.js";import{M as S,C as T}from"./react-tooltip.min-CcFhWTa-.js";import{C as D}from"./Card-BtVAJ1pX.js";import{C as $}from"./CardLine-CPqu-tZu.js";import{a as w,b,o as _,u as E,a9 as B,p as j,g as R,S as O,i as F,j as A,k as M,l as g,a5 as P,a2 as U,a3 as z,a4 as H,aa as N,B as L}from"./index-B7pfeaGh.js";import{A as V,B as Q,E as W}from"./ui-vendor-CC9RJ6yZ.js";import{b as q}from"./stats-DGhMLa_a.js";import"./index-DqUCnBUv.js";import"./FancyCard-CJFhnnt8.js";import"./trash-2-D1O8vaIY.js";import"./plus-Dl-wx072.js";import"./charts-vendor-GpVpfCKE.js";import"./supabase-vendor-CP3OYKhD.js";import"./xlsx-vendor-De4COjWB.js";const G=V;function J(t){const s=w.c(8);let i,c;s[0]!==t?({className:i,...c}=t,s[0]=t,s[1]=i,s[2]=c):(i=s[1],c=s[2]);let n;s[3]!==i?(n=b("w-4 h-4 mr-2 rounded-full bg-neutral-700 hover:bg-neutral-500",i),s[3]=i,s[4]=n):n=s[4];let r;return s[5]!==c||s[6]!==n?(r=e.jsx(Q,{className:n,...c}),s[5]=c,s[6]=n,s[7]=r):r=s[7],r}function K(t){const s=w.c(8);let i,c;s[0]!==t?({className:i,...c}=t,s[0]=t,s[1]=i,s[2]=c):(i=s[1],c=s[2]);let n;s[3]!==i?(n=b("w-2 h-2 mx-1 xm-auto my-auto rounded-full flex bg-neutral-300",i),s[3]=i,s[4]=n):n=s[4];let r;return s[5]!==c||s[6]!==n?(r=e.jsx(W,{className:n,...c}),s[5]=c,s[6]=n,s[7]=r):r=s[7],r}function pe(){const{t}=I(["pages/card-detail","common/types","common/packs","common/sets"]),{selectedCardId:s,setSelectedCardId:i}=_(),{data:c=new Map}=E(),n=B(),[r,u]=p.useState(!1),[k,d]=p.useState(!1),a=s===void 0?void 0:j(s),o=s===void 0?void 0:c.get(s),x=a?.alternate_versions.map(l=>({card:j(l),amount_owned:c.get(l)?.amount_owned??0})),m=a&&R(a.expansion);if(p.useEffect(()=>{s&&u(!0)},[s]),s&&!a)return console.log(`Unrecognized card id: ${s}`),null;if(a&&!m)return console.log(`Unrecognized expansion: ${a.expansion}`),null;const h=a?.pack==="everypack"?m?.packs[0].name:a?.pack,y=l=>new Intl.DateTimeFormat(void 0,{dateStyle:"long",timeStyle:"long"}).format(new Date(l)),C=l=>{s&&o?.collection.includes(l)&&n.mutate({cardId:l})};return e.jsx(O,{open:!!s&&r,onOpenChange:l=>{l||(u(l),setTimeout(()=>i(void 0),300))},children:e.jsxs(F,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto w-full md:w-[725px]",children:[e.jsx(A,{children:e.jsxs(M,{children:[a&&g(a,f.language)," ",a?.rarity]})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx("div",{className:"cursor-pointer",children:a&&e.jsx(D,{className:"w-full",card:{...a,amount_owned:o?.amount_owned||0},onImageClick:()=>d(!0)})})}),e.jsxs(P,{open:k,onOpenChange:d,children:[e.jsx(U,{className:"hidden",children:e.jsx(z,{children:"Card image dialog"})}),e.jsx(H,{className:"flex items-center justify-center p-0 max-w-3xl max-h-[90vh]",children:a?.image&&e.jsx("img",{src:a.image,alt:g(a,f.language),className:"w-full h-full object-scale-down",onClick:()=>d(!1)})})]}),e.jsxs("div",{className:"p-4 w-full",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h2",{className:"text-xl font-semibold",children:t("text.alternateVersions")}),x&&e.jsxs(G,{className:"w-fit",value:String(s),onValueChange:l=>i(Number(l)),children:[x.map(l=>e.jsxs("label",{className:"flex items-center cursor-pointer",htmlFor:`radio-${l.card.card_id}`,children:[e.jsx(J,{id:`radio-${l.card.card_id}`,value:String(l.card.internal_id),children:e.jsx(K,{})}),e.jsx($,{className:"w-auto bg-transparent",card_id:l.card.card_id,rarity:"w-14",name:"hidden",details:"hidden",amount:"pl-4"})]},l.card.card_id)),e.jsxs("p",{className:"flex items-baseline mt-1",children:[e.jsxs("span",{className:"mr-4",children:[t("text.totalAmount"),":"]}),e.jsxs("span",{className:"text-neutral-400 ml-auto mr-2",children:["Ã—",x?.reduce((l,v)=>l+v.amount_owned,0)]})]})]})]}),e.jsxs("p",{className:"mt-8 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.expansion")})," ",a?.expansion]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.pack")})," ",a&&t(`${a.pack}`,{ns:"common/packs"})]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:"Energy"})," ",a?.energy]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.weakness")})," ",a&&t(`${a.weakness}`,{ns:"common/types"})||"N/A"]}),a?.hp&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.hp")})," ",a?.hp]}),a?.retreat&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.retreat")})," ",a.retreat]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.ability")})," ",a?.ability?.name??e.jsx("i",{children:"None"})]}),a?.ability&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.abilityEffect")})," ",a?.ability.effect]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.cardType")})," ",a&&t(`cardType.${a.card_type}`)]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.evolutionType")})," ",a&&t(`evolutionType.${a.evolution_type}`)]}),m&&h&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.chanceToPull",{ns:"pages/card-detail"})}),a&&q(m,h,a).toFixed(2),"%"]}),a&&N[a.rarity]&&e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.craftingCost")})," ",N[a.rarity]]}),e.jsxs("p",{className:"mt-1 flex",children:[e.jsx("strong",{className:"block min-w-[175px]",children:t("text.artist")})," ",a?.artist]}),!!o?.collection?.length&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"flex items-center gap-2 mt-6 mb-1",children:[e.jsx("span",{children:"Collected in"}),e.jsx(S,{id:"minInput",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e.jsx(T,{className:"h-4 w-4","data-tooltip-id":"minInput","data-tooltip-content":t("text.uncollectTooltip")})]}),n.isPending?e.jsx("p",{children:t("text.uncollecting")}):e.jsx("div",{className:"flex flex-col gap-1 w-fit",children:o?.collection.map(l=>e.jsxs(L,{variant:"destructive",className:"mr-auto min-w-48 w-full",onClick:()=>C(l),disabled:n.isPending,children:[t("text.uncollect")," ",l]},l))})]}),e.jsxs("p",{className:"mt-4 text-neutral-400 text-sm flex",children:[e.jsx("strong",{className:"font-semibold mr-1",children:t("text.updated")})," ",o?.updated_at?y(o.updated_at):"N/A"]})]})]})]})})}export{pe as default};
