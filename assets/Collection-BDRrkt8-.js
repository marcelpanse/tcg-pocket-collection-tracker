import{j as s}from"./query-vendor-DpGHCXpY.js";import{h as he,c as re,i as ge,j as ae,B as se,t as ce,k as ye,l as we,m as je,n as be,o as _e,r as ve,S as oe,p as Ce,q as Ne,u as ke,C as Se}from"./index-sUwpVlZr.js";import{r as ue,j as Pe,L as me,f as Te,e as Fe}from"./react-vendor-DjlsVz29.js";import{F as Oe}from"./friend-id-display-CLBWpkHM.js";import{u as pe,i as $e}from"./i18n-vendor-DDmeScd6.js";import{u as Le}from"./index-SHrv9_qz.js";import{M as Ae}from"./react-tooltip.min-BMBeW1qe.js";import{C as Ie}from"./Card-BMwkMttr.js";import{F as Me,C as Be}from"./FiltersPanel-46Td-o82.js";import{g as le,s as Ee,t as De,o as qe,c as Re,e as ze}from"./filters-C_nUOq6f.js";import{T as Ge}from"./trash-2-CQPw9dhL.js";import"./charts-vendor-D-Ae2kUX.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-9yhwxkpr.js";import"./xlsx-vendor-De4COjWB.js";import"./Filters-ve9D6kOB.js";import"./tabs-UEqCAjQB.js";import"./index-5ziEWJdO.js";import"./FancyCard-CTLai1NK.js";import"./plus-C-BglKIQ.js";import"./SearchInput-bSd9iGAD.js";const Ue=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],He=he("circle-alert",Ue),de=t=>{const e=Number(t);return Number.isNaN(e)?void 0:e},ne=t=>t==="true"?!0:t==="false"?!1:void 0,Qe={search:t=>t,expansion:t=>ze.includes(t)?t:void 0,pack:t=>t,cardType:t=>t.split(",").filter(e=>Re.includes(e)),rarity:t=>t.split(",").filter(e=>ve.includes(e)),ownership:t=>qe.includes(t)?t:void 0,trading:t=>De.includes(t)?t:void 0,sortBy:t=>Ee.includes(t)?t:void 0,sortDesc:ne,minNumber:de,maxNumber:de,deckbuildingMode:ne,allTextSearch:ne},fe={search:"",expansion:"all",pack:"all",cardType:[],rarity:[],ownership:"all",trading:"all",sortBy:"expansion-newest",sortDesc:!1,minNumber:0,maxNumber:"∞",deckbuildingMode:!1,allTextSearch:!1};function xe(t){const e=re.c(91),{children:m,cards:r,isPublic:n,share:o}=t,{t:i}=pe("pages/collection");let x;e[0]===Symbol.for("react.memo_cache_sentinel")?(x={query:"(max-width: 767px)"},e[0]=x):x=e[0];const h=Le(x),{setIsProfileDialogOpen:a}=ge(),[F,O]=ue.useState(!1),[j,b]=Pe(),{data:c}=ae();let N;e[1]!==j?(N=()=>{const p={...fe},y=(w,f)=>{const u=Qe[w](f);u!==void 0&&(p[w]=u)};for(const w in p){const f=j.get(w);f!=null&&y(w,f)}return p},e[1]=j,e[2]=N):N=e[2];const d=N;let k;e[3]!==j||e[4]!==b?(k=p=>{const y=new URLSearchParams(j);for(const w in p){const f=p[w];f==null||f==="all"||Array.isArray(f)&&f.length===0||f===""?y.delete(w):Array.isArray(f)?y.set(w,f.join(",")):y.set(w,String(f)),b(y)}},e[3]=j,e[4]=b,e[5]=k):k=e[5];const L=k;let S;e[6]!==b?(S=()=>b(new URLSearchParams),e[6]=b,e[7]=S):S=e[7];const _=S;let P;e[8]!==d?(P=()=>{let p=0;const y=d();for(const w in y){const f=w;y[f]!==fe[f]&&p++}return p},e[8]=d,e[9]=P):P=e[9];const C=P;let g,l,T,A,I,M,B;if(e[10]!==c||e[11]!==r||e[12]!==d||e[13]!==a||e[14]!==o||e[15]!==i){g=le(d(),r,c?.trade_rarity_settings);let p;e[23]!==c||e[24]!==r||e[25]!==d||e[26]!==i?(p=()=>{if(!c)throw new Error("Cannot copy trade message without account");let u="";c.is_public&&(u=u+`${i("trade.publicTradePage")}: https://tcgpocketcollectiontracker.com/#/trade/${c?.friend_id}
`),c.username&&(u=u+`${i("trade.friendID")}: ${c.friend_id} (${c.username})

`);const X=v=>{v.sort(Je);for(let $=0;$<v.length;$++)($>0?v[$-1].expansion:"")!==v[$].expansion&&(u=u+`
${v[$].expansion}:
`),u=u+`${v[$].rarity} ${v[$].card_id} - ${_e(v[$],$e.language)}
`};return u=u+`${i("trade.lookingForCards")}:
`,X(le({...d(),trading:"wanted"},r,c.trade_rarity_settings)),u=u+`

${i("trade.forTradeCards")}:
`,X(le({...d(),trading:"extra"},r,c.trade_rarity_settings)),u},e[23]=c,e[24]=r,e[25]=d,e[26]=i,e[27]=p):p=e[27],l=p;let y;e[28]!==a||e[29]!==o?(y=async function(){o?navigator.share&&(navigator.userAgentData?.mobile||/Mobi|Android/i.test(navigator.userAgent))?await navigator.share({title:"My Pokemon TCG Pocket collection",url:window.location.href}):(await navigator.clipboard.writeText(window.location.href),ce({title:"Copied to clipboard",variant:"default"})):a(!0)},e[28]=a,e[29]=o,e[30]=y):y=e[30],A=y;const w=()=>{let u=0;const X=new Set;for(const v of g)v.collected&&!X.has(v.internal_id)&&(u=u+(v.amount_owned||0),X.add(v.internal_id));return u};let f;e[31]!==r?(f=r?.get(83654)?.amount_owned??0,e[31]=r,e[32]=f):f=e[32],T=f>0,B="flex flex-col h-fit gap-2",I="flex gap-2",M=i("stats.summary",{selected:g.length,uniquesOwned:g.filter(Ve).length,totalOwned:w()}),e[10]=c,e[11]=r,e[12]=d,e[13]=a,e[14]=o,e[15]=i,e[16]=g,e[17]=l,e[18]=T,e[19]=A,e[20]=I,e[21]=M,e[22]=B}else g=e[16],l=e[17],T=e[18],A=e[19],I=e[20],M=e[21],B=e[22];let E;e[33]!==T||e[34]!==i?(E=T&&s.jsxs(s.Fragment,{children:[s.jsx(Ae,{id:"mewCardOwned",className:"text-start max-w-72",clickable:!0}),s.jsx(He,{className:"h-5 w-5","data-tooltip-id":"mewCardOwned","data-tooltip-content":i("stats.mewCardOwned")})]}),e[33]=T,e[34]=i,e[35]=E):E=e[35];let D;e[36]!==I||e[37]!==M||e[38]!==E?(D=s.jsxs("small",{className:I,children:[M,E]}),e[36]=I,e[37]=M,e[38]=E,e[39]=D):D=e[39];let q;e[40]!==d?(q=d(),e[40]=d,e[41]=q):q=e[41];let R;e[42]!==_||e[43]!==L||e[44]!==q?(R=s.jsx(Me,{className:"flex flex-col gap-y-3",filters:q,setFilters:L,clearFilters:_}),e[42]=_,e[43]=L,e[44]=q,e[45]=R):R=e[45];let z;e[46]!==A||e[47]!==o||e[48]!==i?(z=o!==void 0&&s.jsx(se,{variant:"outline",onClick:A,children:i("filters.share")}),e[46]=A,e[47]=o,e[48]=i,e[49]=z):z=e[49];let G;e[50]!==c||e[51]!==l||e[52]!==n||e[53]!==i?(G=!n&&s.jsx(se,{className:"w-full",variant:"outline",disabled:!c,onClick:()=>navigator.clipboard.writeText(l()).then(()=>ce({title:i("trade.copiedInClipboard"),variant:"default",duration:3e3})),children:i("trade.button")}),e[50]=c,e[51]=l,e[52]=n,e[53]=i,e[54]=G):G=e[54];let U;e[55]!==n||e[56]!==i?(U=!n&&s.jsx(me,{className:"w-full",to:"/collection/missions",children:s.jsx(se,{className:"w-full",variant:"outline",children:i("goToMissions")})}),e[55]=n,e[56]=i,e[57]=U):U=e[57];let H;e[58]!==z||e[59]!==G||e[60]!==U?(H=s.jsxs("div",{className:"flex flex-col mt-4 gap-2",children:[z,G,U]}),e[58]=z,e[59]=G,e[60]=U,e[61]=H):H=e[61];let Y;e[62]!==D||e[63]!==R||e[64]!==H||e[65]!==B?(Y=s.jsxs("div",{className:B,children:[D,R,H]}),e[62]=D,e[63]=R,e[64]=H,e[65]=B,e[66]=Y):Y=e[66];const Z=Y;let Q;e[67]!==Z||e[68]!==F||e[69]!==h?(Q=h?s.jsx(ye,{open:F,onOpenChange:O,children:s.jsxs(we,{side:"left",className:"w-full",children:[s.jsx(je,{children:s.jsx(be,{children:"Filters"})}),Z]})}):s.jsx("div",{className:"w-80",children:Z}),e[67]=Z,e[68]=F,e[69]=h,e[70]=Q):Q=e[70];let V;e[71]!==C||e[72]!==_||e[73]!==h?(V=h&&s.jsxs("div",{className:"h-9 flex overflow-hidden text-center rounded-md text-sm font-medium border shadow-sm border-neutral-700 divide-x divide-neutral-700 [&>*]:cursor-pointer [&>*]:hover:bg-neutral-600 [&>*]:hover:text-neutral-50",children:[s.jsxs("button",{type:"button",className:"flex-1",onClick:()=>O(!0),children:["Filters",C()>0&&` (${C()})`]}),C()>0&&s.jsx("button",{type:"button",className:"group px-2",onClick:_,children:s.jsx(Ge,{className:"stroke-neutral-200 group-hover:stroke-neutral-50"})})]}),e[71]=C,e[72]=_,e[73]=h,e[74]=V):V=e[74];let ee;e[75]!==d?(ee=d(),e[75]=d,e[76]=ee):ee=e[76];const ie=ee.sortBy==="expansion-newest";let J;e[77]!==d||e[78]!==n?(J=p=>s.jsx(Ie,{card:p,editable:!d().deckbuildingMode&&!n}),e[77]=d,e[78]=n,e[79]=J):J=e[79];let K;e[80]!==g||e[81]!==ie||e[82]!==J?(K=s.jsx(Be,{cards:g,groupExpansions:ie,render:J}),e[80]=g,e[81]=ie,e[82]=J,e[83]=K):K=e[83];let W;e[84]!==m||e[85]!==V||e[86]!==K?(W=s.jsxs("div",{className:"w-full max-w-[900px]",children:[V,m,K]}),e[84]=m,e[85]=V,e[86]=K,e[87]=W):W=e[87];let te;return e[88]!==Q||e[89]!==W?(te=s.jsxs("div",{className:"flex justify-center gap-2 xl:gap-8 px-1",children:[Q,W]}),e[88]=Q,e[89]=W,e[90]=te):te=e[90],te}function Ve(t){return!!t.collected}function Je(t,e){const m=t.expansion.localeCompare(e.expansion);return m!==0?m:t.rarity.localeCompare(e.rarity)}function Ke(){const{data:t,isLoading:e}=ae(),{data:m=new Map,isLoading:r}=ke();return e||r?s.jsx(oe,{size:"lg",overlay:!0}):s.jsx(xe,{cards:m,isPublic:!1,share:t!==void 0&&t.friend_id!==""&&t.is_public})}function We(t){const e=re.c(39),{friendId:m}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=["pages/collection","common"],e[0]=r):r=e[0];const{t:n}=pe(r),{data:o,isLoading:i}=Ce(m),{data:x,isLoading:h}=Ne(m);if(i||h){let l;return e[1]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx(oe,{size:"lg",overlay:!0}),e[1]=l):l=e[1],l}if(o===void 0||x===void 0){let l;return e[2]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx("p",{className:"text-xl text-center py-8",children:"Something went wrong"}),e[2]=l):l=e[2],l}if(o===null){let l;e[3]!==n?(l=n("common:noAccount"),e[3]=n,e[4]=l):l=e[4];let T;return e[5]!==l?(T=s.jsx("p",{className:"text-xl text-center py-8",children:l}),e[5]=l,e[6]=T):T=e[6],T}if(x===null){let l;return e[7]===Symbol.for("react.memo_cache_sentinel")?(l=s.jsx("p",{className:"text-xl text-center py-8",children:"Not a public account"}),e[7]=l):l=e[7],l}const a=`${o.username} collection – TCG Pocket Collection Tracker`;let F;e[8]!==a?(F=s.jsx("title",{children:a}),e[8]=a,e[9]=F):F=e[9];let O;e[10]!==n?(O=n("collectionOf"),e[10]=n,e[11]=O):O=e[11];let j;e[12]!==O?(j=s.jsx("span",{className:"text-2xl font-light",children:O}),e[12]=O,e[13]=j):j=e[13];let b;e[14]!==o.username?(b=s.jsxs("span",{className:"text-2xl font-bold",children:[" ",o.username," "]}),e[14]=o.username,e[15]=b):b=e[15];let c;e[16]!==o.friend_id?(c=s.jsx("span",{className:"block sm:inline text-sm",children:s.jsx(Oe,{friendId:o.friend_id})}),e[16]=o.friend_id,e[17]=c):c=e[17];let N;e[18]!==j||e[19]!==b||e[20]!==c?(N=s.jsxs("h1",{children:[j,b,c]}),e[18]=j,e[19]=b,e[20]=c,e[21]=N):N=e[21];const d=`/trade/${m}`;let k;e[22]!==n?(k=n("showPossibleTrades"),e[22]=n,e[23]=k):k=e[23];let L;e[24]===Symbol.for("react.memo_cache_sentinel")?(L=s.jsx(Se,{}),e[24]=L):L=e[24];let S;e[25]!==k?(S=s.jsxs(se,{children:[k,L]}),e[25]=k,e[26]=S):S=e[26];let _;e[27]!==S||e[28]!==d?(_=s.jsx(me,{to:d,children:S}),e[27]=S,e[28]=d,e[29]=_):_=e[29];let P;e[30]!==_||e[31]!==N?(P=s.jsxs("div",{className:"flex justify-between my-2",children:[N,_]}),e[30]=_,e[31]=N,e[32]=P):P=e[32];let C;e[33]!==x||e[34]!==P?(C=s.jsx(xe,{cards:x,isPublic:!0,children:P}),e[33]=x,e[34]=P,e[35]=C):C=e[35];let g;return e[36]!==C||e[37]!==F?(g=s.jsxs("div",{className:"flex flex-col gap-y-1",children:[F,C]}),e[36]=C,e[37]=F,e[38]=g):g=e[38],g}function wt(){const t=re.c(14),e=Te(),{friendId:m}=Fe(),{data:r,isLoading:n}=ae();let o;t[0]!==r||t[1]!==n||t[2]!==e||t[3]!==m?(o=()=>{!m&&!n&&r?.friend_id&&e(`/collection/${r.friend_id}`,{replace:!0})},t[0]=r,t[1]=n,t[2]=e,t[3]=m,t[4]=o):o=t[4];const i=r?.friend_id;let x;if(t[5]!==n||t[6]!==e||t[7]!==m||t[8]!==i?(x=[n,m,i,e],t[5]=n,t[6]=e,t[7]=m,t[8]=i,t[9]=x):x=t[9],ue.useEffect(o,x),n){let a;return t[10]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(oe,{size:"lg",overlay:!0}),t[10]=a):a=t[10],a}const h=m??r?.friend_id;if(h&&h!==r?.friend_id){let a;return t[11]!==h?(a=s.jsx(We,{friendId:h}),t[11]=h,t[12]=a):a=t[12],a}else{let a;return t[13]===Symbol.for("react.memo_cache_sentinel")?(a=s.jsx(Ke,{}),t[13]=a):a=t[13],a}}export{wt as default};
