import{V as N,r as w,U as C,a2 as F,u as T,$ as y,a0 as P,aU as j,j as e,D as k,v as I,x as B,y as E,W as u,B as x,a1 as U}from"./index-BhLyGxYW.js";import{u as A,a as $,F as L,b as l,c as t,e as o,d as c,f as d,h as f,S as R,g as H}from"./switch-iRcf-QFC.js";import{A as M,a as V,b as W}from"./alert-Dg26N27_.js";import{S as q}from"./siren-D7nbWif-.js";import"./index-pP9eKrRt.js";const Q=({account:a,setAccount:b,isProfileDialogOpen:g,setIsProfileDialogOpen:h})=>{const v=N(),{user:p}=w.use(C),{toast:m}=F(),{t:s}=T("edit-profile"),_=y({username:j().min(2,{message:s("usernameTooShort")}),friend_id:j().regex(/^[0-9]{16}$/,{message:s("friendIdInvalid")}),is_public:P().optional()}),n=A({resolver:$(_),values:{username:a?.username||"",friend_id:a?.friend_id||"",is_public:a?.is_public||!1}}),D=async r=>{try{const i=await U.from("accounts").upsert({email:p?.user.email,username:r.username,friend_id:r.friend_id,is_public:r.is_public}).select().single();b(i.data),m({title:s("accountSaved"),variant:"default"})}catch(i){console.error("error saving account",i),m({title:s("accountSavingError"),variant:"destructive"})}},S=`https://tcgpocketcollectiontracker.com/#/collection/${a?.friend_id}`;return e.jsx(k,{open:g,onOpenChange:h,children:e.jsxs(I,{className:"border-1 border-neutral-700 shadow-none h-[90vh] content-start",children:[e.jsx(B,{children:e.jsx(E,{children:s("editProfile")})}),e.jsxs(M,{className:"mb-2 border-1 border-neutral-700 shadow-none",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(V,{children:s("updateProfile.title")}),e.jsx(W,{children:s("updateProfile.description")})]}),e.jsx(L,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(D),className:"space-y-8",children:[e.jsx(l,{name:"email",render:()=>e.jsxs(t,{children:[e.jsx(o,{children:s("email")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("email"),disabled:!0,value:p?.user.email})}),e.jsx(d,{children:s("registeredEmail")})]})}),e.jsx(l,{control:n.control,name:"username",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("username")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("username"),...r})}),e.jsx(d,{children:s("usernameDescription")}),e.jsx(f,{})]})}),e.jsx(l,{control:n.control,name:"friend_id",render:({field:r})=>e.jsxs(t,{children:[e.jsx(o,{children:s("friendID")}),e.jsx(c,{className:"mt-2",children:e.jsx(u,{placeholder:s("friendID"),...r})}),e.jsx(d,{children:s("friendIDDescription")}),e.jsx(f,{})]})}),e.jsx(l,{control:n.control,name:"is_public",render:({field:r})=>e.jsxs(t,{className:"flex flex-col items-start",children:[e.jsx(c,{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-x-2 w-full flex-wrap",children:[e.jsx(o,{children:s("isPublicToggle")}),e.jsx("div",{className:"grow-1",children:e.jsx(R,{checked:r.value,onCheckedChange:r.onChange})}),e.jsx(x,{disabled:!a?.is_public,onClick:async i=>{i.preventDefault(),m({title:"Copied public collection page URL to clipboard!",variant:"default",duration:3e3}),await navigator.clipboard.writeText(S)},children:s("isPublicButton")}),e.jsx(x,{disabled:!a?.is_public,onClick:async i=>{i.preventDefault(),h(!1),v(`/trade/${a?.friend_id}`)},children:s("isPublicTradeButton")})]})}),e.jsx(d,{children:s("isPublicDescription")})]})}),a?.is_public&&e.jsx(H,{}),e.jsx(x,{type:"submit",children:s("save")})]})})]})})};export{Q as default};
