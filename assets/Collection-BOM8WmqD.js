const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TradeMatches-DTokyhM4.js","assets/index-CUiPyv1p.js","assets/index-C6F3UqwI.css","assets/SocialShareButtons-Cml5kTqi.js","assets/index-BF0vnTL-.js","assets/index-DB0X-vGo.js","assets/useWindowDimensionsHook-EpDM3WkF.js"])))=>i.map(i=>d[i]);
import{c as ke,j as e,l as z,m as E,u as _,r as u,B as S,D as re,n as le,o as oe,q as ie,M as Se,s as Te,t as ce,I as Me,U as de,C as G,v as _e,w as Ie,x as Ae,k as O,y as Fe,z as ue,A as Be,S as De,E as Ee,F as Le,G as Pe,H as $e,J as He,K as Re,L as Oe,N as ze,O as Ue,Q as qe,_ as We}from"./index-CUiPyv1p.js";import{M as V,C as xe,E as Y,D as Ve,u as Ge}from"./index-DB0X-vGo.js";import{T as he,a as me,b as H,C as Ke,c as Qe}from"./CardDetail-CNNwcJXs.js";import{F as K,P as Ze,u as Je}from"./Card-D8rt_zTr.js";import{A as pe,b as fe,a as Ye}from"./alert-DHMdO_nF.js";import{T as Xe,a as X,P as et,b as tt,c as nt,R as ee,N as te,u as st}from"./useWindowDimensionsHook-EpDM3WkF.js";import{S as at}from"./siren-CyxdRkQb.js";import"./index-BF0vnTL-.js";/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],lt=ke("trophy",rt);function ot({card:s,onSelect:l,selected:t}){const r=()=>{l(s.card_id,!t)};return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(K,{card:s,selected:t,setIsSelected:r,size:"small"}),e.jsx("p",{className:"text-xs text-center mt-1",children:z(s,E.language)})]})}const it=({children:s,className:l})=>e.jsx("div",{className:`max-h-[300px] overflow-y-auto border border-gray-300 rounded-md ${l}`,style:{maxHeight:"300px"},children:s});function ct({filteredCards:s,onBatchUpdate:l}){const{t}=_("bulk-update"),[r,x]=u.useState(!1),[a,h]=u.useState(0),[i,g]=u.useState({}),[I,C]=u.useState(!1),[y,b]=u.useState(!1),w=s.length===0,j=u.useMemo(()=>s.reduce((c,d)=>(c.some(p=>p.card_id===d.card_id)||c.push(d),c),[]),[s]);u.useEffect(()=>{if(r){const c=j.reduce((d,p)=>(d[p.card_id]=!0,d),{});g(c)}r||b(!1)},[r]);const F=(c,d)=>{g(p=>({...p,[c]:d}))},T=()=>{const c=j.reduce((d,p)=>(d[p.card_id]=!0,d),{});g(c)},v=()=>{const c=j.reduce((d,p)=>(d[p.card_id]=!1,d),{});g(c)},A=Object.values(i).filter(c=>c).length,k=()=>{a!==null&&(a>0?h(c=>(c||0)-1):a===0&&h(0)),b(!0)},L=()=>{h(c=>c?c+1:1),b(!0)},D=c=>{const d=c.target.value.trim();if(d==="")h(0);else{const p=Number(d);Number.isNaN(p)?h(0):h(p<0?0:p)}b(!0)},P=async()=>{C(!0);const c=Object.entries(i).filter(([d,p])=>p).map(([d])=>d);c.length>0&&(await l(c,a),x(!1),C(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"hidden sm:block",variant:"outline",onClick:()=>x(!0),disabled:w,children:t("buttonTitle")}),e.jsx(re,{open:r,onOpenChange:x,children:e.jsxs(le,{className:"max-w-2xl",children:[e.jsx(oe,{children:e.jsx(ie,{children:t("title")})}),e.jsx(pe,{variant:"destructive",children:e.jsxs(fe,{children:[t("alert.beforeCount"),e.jsxs("strong",{children:[e.jsx("span",{style:{fontSize:"1.25rem",color:"#f3f4f6",padding:"0.25rem 0.5rem",borderRadius:"0.375rem",margin:"0 0.25rem"},children:A})," ",t("alert.cards")]})," ",t("alert.afterCount"),e.jsx("strong",{children:t("alert.warning")})]})}),e.jsxs("div",{className:"flex gap-2 justify-between",children:[e.jsx(S,{variant:"outline",onClick:v,children:t("deselectAll")}),e.jsx(S,{variant:"outline",onClick:T,children:t("selectAll")})]}),e.jsx(it,{className:"h-64 rounded-md border p-4",children:e.jsx("div",{className:"grid grid-cols-5 gap-2",children:j.map(c=>e.jsx(ot,{card:c,onSelect:F,selected:i[c.card_id]},c.card_id))})}),e.jsxs("div",{className:"flex items-center gap-x-1 justify-center",children:[e.jsx(S,{variant:"ghost",size:"icon",onClick:k,disabled:a===null||a===0,className:"rounded-full",children:e.jsx(Se,{size:14})}),e.jsx("input",{type:"text",min:"0",value:a??0,onChange:D,placeholder:t("enterAmount"),className:"w-7 text-center border-none rounded",onFocus:c=>c.target.select()}),e.jsx(S,{variant:"ghost",size:"icon",onClick:L,className:"rounded-full",children:e.jsx(Ze,{size:14})})]}),e.jsxs(Te,{children:[e.jsx(S,{variant:"outline",onClick:()=>x(!1),children:t("cancel")}),e.jsxs(S,{onClick:P,disabled:A===0||I||!y,variant:"default",children:[I&&e.jsxs("svg",{"aria-hidden":"true",className:"w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-blue-600",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),e.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),t(I?"batchProcessing":"batchUpdate")]})]})]})})]})}const ne=({ownedFilter:s,setOwnedFilter:l,fullWidth:t})=>{const{t:r}=_("owned-filter");return e.jsx(he,{value:s,onValueChange:x=>l(x),className:t?"w-full":"w-70",children:e.jsxs(me,{className:"w-full flex-wrap h-auto lg:h-10 bg-neutral-50 border-1 border-neutral-700 rounded-md",children:[e.jsx(H,{value:"all",children:r("all")}),e.jsx(H,{value:"missing",children:r("missing")}),e.jsx(H,{value:"owned",children:r("owned")})]})})},se=({value:s,onChange:l,expansion:t,fullWidth:r})=>{const{t:x}=_("common/packs");let a=ce(t)?.packs;const h=!(a===void 0||t==="P-A");return(a===void 0||a.length<=1)&&(a=[]),t==="all"||t==="P-A"?null:e.jsx(he,{value:s,onValueChange:l,className:`h-auto ${r?"w-full":"w-[440px]"}`,children:e.jsxs(me,{className:"h-full flex-wrap w-full border-1 border-neutral-700 rounded-md flex-row justify-start content-start",children:[e.jsx(H,{value:"all",children:x("all")}),a.filter(i=>i.name!=="everypack").map(i=>e.jsx(H,{value:i.name,children:x(i.name)},`tab_trigger_${i.name}`)),h&&e.jsx(H,{value:"missions",children:x("missions")})]})})};let W=null;const ae=({setSearchValue:s,fullWidth:l})=>{const{t}=_("search-input");return e.jsx(Me,{type:"search",placeholder:t("search"),className:`w-full ${l?"":"sm:w-32"} border-2 h-[38px] bg-neutral-800`,style:{borderColor:"#45556C"},onChange:r=>{W&&window.clearTimeout(W),W=window.setTimeout(()=>{s(r.target.value)},500)}})};function dt(s,l){if(s.length===0)return l.length;if(l.length===0)return s.length;let t=Array(s.length+1).fill(0).map((x,a)=>a),r=Array(s.length+1);for(let x=1;x<=l.length;x++){r[0]=x;for(let a=1;a<=s.length;a++){const h=s[a-1]===l[x-1]?0:1;r[a]=Math.min(t[a]+1,r[a-1]+1,t[a-1]+h)}[t,r]=[r,t]}return t[s.length]}const ut=({allTextSearch:s,setAllTextSearch:l})=>{const{t}=_("search-input");return e.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[e.jsx("input",{type:"checkbox",id:"checkbox",checked:s,onChange:()=>l(!s),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"checkbox",className:"text-xs",children:t("allTextLabel")}),e.jsx(V,{id:"allTextSearch",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e.jsx(xe,{className:"h-4 w-4","data-tooltip-id":"allTextSearch","data-tooltip-content":t("allTextTooltip")})]})},xt=["grass","fire","water","lightning","psychic","fighting","darkness","metal","dragon","colorless","trainer",""],ht=({cardTypeFilter:s,setCardTypeFilter:l,collapse:t})=>{const{t:r}=_("card-type-filter"),x=u.useMemo(()=>e.jsxs(Xe,{variant:"outline",type:"multiple",size:"sm",value:s,onValueChange:a=>{l(a)},className:`justify-center shadow-none border-1 border-neutral-700 rounded-md flex-wrap ${t?"flex-col":"flex-row"}`,children:[xt.filter(a=>a!==""&&a!=="trainer").map(a=>e.jsx(X,{value:a,"aria-label":a,className:"text-gray-400 hover:text-gray-500 px-1",children:e.jsx("img",{src:`/images/energy/${a}.webp`,alt:a,className:"h-4"})},a)),e.jsx(X,{value:"trainer","aria-label":"trainer",className:"text-gray-400 hover:text-gray-500 px-1",children:"T"})]}),[s,t]);return t?e.jsxs(et,{children:[e.jsx(tt,{asChild:!0,children:e.jsxs(S,{variant:"outline",children:[r("filters")," (",s.length,")"]})}),e.jsx(nt,{className:"w-32",children:x})]}):x},mt=({sortBy:s,setSortBy:l})=>{const{t}=_("sort-by");return e.jsx("div",{className:"px-3 py-1 border-1 border-neutral-700 rounded-md",children:e.jsxs("label",{className:"flex items-center gap-x-2 text-white/50 text-sm",children:[e.jsx("h2",{children:t("sortBy")}),e.jsxs("select",{value:s,onChange:r=>l(r.target.value),className:"p-1",children:[e.jsx("option",{value:"default",className:"text-black",children:t("default")}),e.jsx("option",{value:"recent",className:"text-black",children:t("recent")}),e.jsx("option",{value:"expansion-newest",className:"text-black",children:t("expansion-newest")})]})]})})},pt=({children:s,cards:l,filters:t,setFilters:r,onFiltersChanged:x,onChangeToMissions:a,visibleFilters:h,filtersDialog:i,batchUpdate:g,share:I})=>{const{t:C}=_(["pages/collection"]),{user:y,setIsProfileDialogOpen:b}=u.useContext(de),{ownedCards:w,setOwnedCards:j}=u.useContext(G),[F,T]=u.useState(E.language),v=n=>r(m=>({...m,search:n})),A=n=>r(m=>({...m,allTextSearch:n})),k=n=>r(m=>({...m,expansion:n})),L=n=>r(m=>({...m,pack:n})),D=n=>r(m=>({...m,cardType:n})),P=n=>r(m=>({...m,rarity:n})),c=n=>r(m=>({...m,owned:n})),d=n=>r(m=>({...m,sortBy:n})),p=n=>r(m=>({...m,minNumber:n})),ge=n=>r(m=>({...m,maxNumber:n})),we=n=>r(m=>({...m,deckbuildingMode:n})),[Q,Z]=u.useState(null),je=n=>t.rarity.length===0?!0:n.rarity!==""&&t.rarity.includes(n.rarity),Ce=n=>t.cardType.length===0?!0:n.card_type.toLowerCase()==="trainer"?t.cardType.includes("trainer"):n.energy!==""&&t.cardType.includes(n.energy.toLowerCase()),$=u.useMemo(()=>{if(!l)return null;let n=_e;if(t.deckbuildingMode&&(n=n.filter(o=>Ie.includes(o.rarity)||o.rarity===""||o.rarity==="P")),t.expansion!=="all"&&(n=n.filter(o=>o.expansion===t.expansion)),t.pack==="missions"){n=[];let o=Ae.get(t.expansion)?.missions||null;o&&(t.owned==="owned"?o=o.filter(f=>f.completed):t.owned==="missing"&&(o=o.filter(f=>!f.completed))),Z(o)}else Z(null),t.pack!=="all"&&(n=n.filter(o=>o.pack===t.pack||o.pack==="everypack"));if(t.owned!=="all"&&(t.owned==="owned"?n=n.filter(o=>l.find(f=>f.card_id===o.card_id&&f.amount_owned>0)):t.owned==="missing"&&(n=n.filter(o=>!l.find(f=>f.card_id===o.card_id&&f.amount_owned>0)))),t.sortBy==="recent")n=[...n].sort((o,f)=>{const M=l.find(B=>B.card_id===o.card_id)?.updated_at,N=l.find(B=>B.card_id===f.card_id)?.updated_at;return M&&N?new Date(N).getTime()-new Date(M).getTime():M&&!N?-1:1});else if(t.sortBy==="expansion-newest"){const o=[...O].reverse().slice(1).concat(O[O.length-1]);n=[...n].sort((f,M)=>{const N=o.findIndex(R=>R.id===f.expansion),B=o.findIndex(R=>R.id===M.expansion);return N!==B?N-B:f.card_id.localeCompare(M.card_id,E.language||"en",{numeric:!0})})}n=n.filter(je),n=n.filter(Ce),t.search&&(n=n.filter(f=>{const M=z(f,E.language).toLowerCase(),N=t.search.toLowerCase();let B=!1;if(t.allTextSearch){const U=f.ability.name?.toLowerCase(),Ne=f.ability.effect?.toLowerCase();B=U&&U!=="no ability"&&(U.includes(N)||Ne.includes(N))||f.attacks.some(q=>q.name?.toLowerCase().includes(N)||q.effect?.toLowerCase()!=="no effect"&&q.effect?.toLowerCase()?.includes(N))}const R=M.includes(N),ye=dt(M,N)<=2,ve=f.card_id.toLowerCase().includes(N);return B||R||ye||ve}));const m=new Map((l||[]).map(o=>[o.card_id,o.amount_owned]));for(const o of n)o.linkedCardID?o.amount_owned=0:t.deckbuildingMode?o.amount_owned=o.alternate_versions.reduce((f,M)=>f+(m.get(M.card_id)||0),0):o.amount_owned=m.get(o.card_id)||0;return n=n.filter(o=>(o.amount_owned||0)>=t.minNumber),t.maxNumber!==100&&(n=n.filter(o=>(o.amount_owned||0)<=t.maxNumber)),n},[l,t,F]);u.useEffect(()=>{x($);const n=m=>{T(m)};return E.on("languageChanged",n),()=>{E.off("languageChanged",n)}},[$]),u.useEffect(()=>{a(Q)},[Q]);const be=async(n,m)=>{await Je(n,m,w,j,y)};function J(n){k(n),L("all")}return e.jsxs("div",{id:"filterbar",className:"flex flex-col gap-x-2 flex-wrap",children:[s,h?.expansions&&e.jsxs("div",{className:"flex gap-x-2 px-4 mb-2",children:[e.jsx(Y,{value:t.expansion,onChange:J}),e.jsx(se,{value:t.pack,onChange:L,expansion:t.expansion})]}),e.jsxs("div",{className:"gap-2 flex-row gap-y-1 px-4 flex",children:[h?.search&&e.jsx(ae,{setSearchValue:v}),h?.owned&&e.jsx(ne,{ownedFilter:t.owned,setOwnedFilter:c}),h?.rarity&&e.jsx(ee,{rarityFilter:t.rarity,setRarityFilter:P,collapse:!0}),i&&e.jsxs(re,{children:[e.jsx(Fe,{asChild:!0,children:e.jsx(S,{variant:"outline",children:C("filters.allFilters")})}),e.jsxs(le,{className:"border-1 border-neutral-700 shadow-none max-h-[90vh] overflow-y-auto content-start",children:[e.jsx(oe,{children:e.jsx(ie,{children:C("filters.filtersCount",{count:($||[]).filter(n=>!n.linkedCardID).length})})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[i.search&&e.jsx(ae,{setSearchValue:v,fullWidth:!0}),i.allTextSearch&&e.jsx(ut,{allTextSearch:t.allTextSearch,setAllTextSearch:A}),i.expansions&&e.jsx(Y,{value:t.expansion,onChange:J}),i.pack&&e.jsx(se,{value:t.pack,onChange:L,expansion:t.expansion,fullWidth:!0}),i.rarity&&e.jsx(ee,{rarityFilter:t.rarity,setRarityFilter:P}),i.cardType&&e.jsx(ht,{cardTypeFilter:t.cardType,setCardTypeFilter:D}),i.owned&&e.jsx(ne,{ownedFilter:t.owned,setOwnedFilter:c,fullWidth:!0}),i.sortBy&&e.jsx(mt,{sortBy:t.sortBy,setSortBy:d}),i.amount&&e.jsxs(e.Fragment,{children:[e.jsx(te,{numberFilter:t.minNumber,setNumberFilter:p,options:[0,1,2,3,4,5,6,7,8,9],labelKey:"minNum"}),e.jsx(te,{numberFilter:t.maxNumber,setNumberFilter:ge,options:[1,2,3,4,5,6,7,8,9,10,100],labelKey:"maxNum"})]}),i.deckBuildingMode&&e.jsx(Ve,{deckbuildingMode:t.deckbuildingMode,setDeckbuildingMode:we}),e.jsx(S,{variant:"outline",className:"!text-red-700",onClick:()=>r({search:"",expansion:"all",pack:"all",cardType:[],rarity:[],owned:"all",sortBy:"expansion-newest",minNumber:0,maxNumber:100,deckbuildingMode:!1,allTextSearch:!1}),children:C("filters.clear")})]})]})]}),g&&e.jsx(ct,{filteredCards:$||[],onBatchUpdate:be,disabled:!$||$.length===0}),I&&e.jsx(S,{variant:"outline",onClick:()=>b(!0),children:C("filters.share")})]})]})};function ft({mission:s}){const{width:l}=st(),{t}=_("common/packs"),{ownedCards:r,setSelectedCardId:x,setSelectedMissionCardOptions:a}=u.use(G);let h=5,i=Math.min(l,890)/5+120;l>600&&l<800?(h=4,i=l/3+50):l<=600&&(h=3,i=l/3+100);const g=u.useMemo(()=>{let C=!0;const y=s.requiredCards.flatMap(w=>{let j=r.reduce((T,v)=>{const A=w.options.find(k=>k===v.card_id);if(A)for(let k=0;k<v.amount_owned;k++)T.push({cardId:A,owned:!0,missionCardOptions:w.options});return T},[]);j.length>w.amount&&(j=j.slice(0,w.amount));const F=w.amount-j.length;for(let T=0;T<F;T++)j.push({cardId:w.options[0],owned:!1,missionCardOptions:w.options});return C=C&&F===0,j});s.completed=C;const b=[];for(let w=0;w<y.length;w+=h)b.push(y.slice(w,w+h));return b},[h]),I=i*g.length+72;return e.jsxs("div",{style:{height:`${I}px`},className:"relative w-full",children:[e.jsx("div",{style:{height:`${I}px`},className:"relative w-full",children:g.map((C,y)=>e.jsx("div",{style:{height:`${i}px`,transform:`translateY(${i*y+72}px)`},className:"absolute top-0 left-0 w-full",children:e.jsx("div",{className:"flex justify-start gap-x-3",children:C.map((b,w)=>{const j=ue(b.cardId);return j&&e.jsxs("div",{className:"group flex w-fit max-w-32 md:max-w-40 flex-col items-center rounded-lg cursor-pointer",children:[e.jsx("button",{type:"button",onClick:()=>b.owned?x(b.cardId):a(b.missionCardOptions),children:e.jsx(K,{card:j,selected:b.owned})}),e.jsxs("p",{className:"max-w-[130px] overflow-hidden text-ellipsis whitespace-nowrap font-semibold text-[12px] pt-2",children:[b.cardId," - ",z(j,E.language)]})]},`${s.name}__${w}`)})})},y))}),e.jsx("div",{style:{height:"72px"},className:"absolute top-0 left-0 w-full",children:e.jsxs("h2",{className:"flex items-center gap-x-4 mx-auto mt-10 w-full max-w-[900px] scroll-m-20 border-b-2 border-slate-600 pb-2 font-semibold text-md sm:text-lg md:text-2xl tracking-tight transition-colors first:mt-0",children:[s.name,e.jsx(V,{id:`rewardDescription${s.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(lt,{className:"h-6 w-6","data-tooltip-id":`rewardDescription${s.name}`,"data-tooltip-html":s.reward}),e.jsx(V,{id:`probability${s.name}`,style:{maxWidth:"300px",whiteSpace:"normal",fontSize:16},clickable:!0}),e.jsx(xe,{className:"h-6 w-6","data-tooltip-id":`probability${s.name}`,"data-tooltip-html":s.completed?"Completed!":Be(s,g).filter(([C,y])=>C!=="everypack"&&y>0).map(([C,y])=>`${t(C)}: ${y.toFixed(2)}%`).join("<br/>")})]})},"header")]})}function gt({missions:s,resetScrollTrigger:l}){const t=u.useRef(null),[r,x]=u.useState("auto");return u.useLayoutEffect(()=>{const a=()=>{if(t.current){const h=document.querySelector("#header")?.offsetHeight||0,i=document.querySelector("#filterbar")?.offsetHeight||0,g=window.innerHeight-h-i;x(`${g}px`)}};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[]),u.useEffect(()=>{t.current&&(t.current.scrollTop=0)},[l]),e.jsx("div",{ref:t,className:"overflow-y-auto mt-2 sm:mt-4 px-4 flex flex-col justify-start",style:{scrollbarWidth:"none",height:r},children:s.map(a=>e.jsx(ft,{mission:a},a.name))})}function wt({missionCardOptions:s,onClose:l}){const{t}=_(["common/sets","common/packs","pages/collection"]),r=s[0]||"",x=r.length>0?r.split("-")[0]:"Unknown",a=ce(x)||O[0],h=a.name;return e.jsx(De,{open:!!s.length,onOpenChange:i=>{i||l()},children:e.jsxs(Ee,{className:"transition-all duration-300 ease-in-out border-slate-600 overflow-y-auto",children:[e.jsx(Le,{children:e.jsx(Pe,{children:s.length===1?t("missionDetail.eligibleCards-singular",{ns:"pages/collection",options:1}):t("missionDetail.eligibleCards-plural",{ns:"pages/collection",options:s.length})})}),t(h),s.map(i=>{const g=ue(i);return g&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"px-10 py-4 w-full",children:e.jsx(K,{card:g,selected:!1})}),e.jsxs("p",{className:"max-w-[130px] whitespace-nowrap font-semibold text-[12px] pt-2",children:[i," - ",z(g,E.language),e.jsx("br",{}),t("missionDetail.chanceFrom",{ns:"pages/collection",pack:t(g.pack,{ns:"common/packs"}),chance:$e(a,g.pack,g).toFixed(2)})]})]})})]})})}const jt=qe(()=>We(()=>import("./TradeMatches-DTokyhM4.js"),__vite__mapDeps([0,1,2,3,4,5,6])));function Mt(){const s=He(),l=Re(),t=Oe(),{t:r}=_(["pages/collection"]),x=Ge({query:"(max-width: 767px)"}),{ownedCards:a,selectedCardId:h,setSelectedCardId:i,selectedMissionCardOptions:g,setSelectedMissionCardOptions:I}=u.useContext(G),{account:C}=u.useContext(de),[y,b]=u.useState({search:"",expansion:"all",pack:"all",cardType:[],rarity:[],owned:"all",sortBy:"expansion-newest",minNumber:0,maxNumber:100,deckbuildingMode:!1,allTextSearch:!1}),[w,j]=u.useState(!1),[F,T]=u.useState(null),[v,A]=u.useState(null),[k,L]=u.useState(null),[D,P]=u.useState(null);u.useEffect(()=>{const d=s.friendId;d&&!v?(console.log("fetching collection by friend id",d),ze(d).then(p=>{console.log("friend account",p),T(p)}).catch(console.error),Ue(void 0,d).then(p=>{p.length===0&&(console.log("not a public collection, going back to normal mode."),l("/collection")),A(p)}).catch(console.error)):!d&&v&&window.location.reload()},[s]),u.useEffect(()=>()=>{A(null)},[]);const c=u.useMemo(()=>s.friendId?v:a||[],[a,v]);return u.useEffect(()=>{j(!0);const d=setTimeout(()=>j(!1),100);return()=>clearTimeout(d)},[k]),e.jsxs("div",{className:"flex flex-col gap-y-1 mx-auto max-w-[900px]",children:[e.jsx(pt,{cards:c,filters:y,setFilters:b,onFiltersChanged:d=>L(d),onChangeToMissions:d=>P(d),visibleFilters:{expansions:!x,allTextSearch:!x,search:!0,owned:!x,rarity:!x},filtersDialog:{expansions:!0,pack:!0,search:!0,owned:!0,sortBy:!0,rarity:!0,cardType:!0,amount:!0,deckBuildingMode:!0,allTextSearch:!0},batchUpdate:!v,share:!0,children:e.jsx("div",{children:v&&e.jsxs(pe,{className:"mb-4 border-1 border-neutral-700 shadow-none",children:[e.jsx(at,{className:"h-4 w-4"}),e.jsx(Ye,{children:r("publicCollectionTitle",{username:F?.username})}),e.jsx(fe,{children:e.jsxs("div",{className:"flex items-center",children:[r("publicCollectionDescription"),e.jsx(S,{className:"mb-4",onClick:()=>{l(`${t.pathname}/trade`)},children:r("showPossibleTrades")})]})})]})})}),e.jsxs("div",{children:[k&&!D&&e.jsx(Ke,{cards:k,resetScrollTrigger:w,showStats:!y.deckbuildingMode,extraOffset:24,editable:!y.deckbuildingMode}),h&&e.jsx(Qe,{cardId:h,onClose:()=>i("")})]}),e.jsx("div",{children:D&&e.jsx(gt,{missions:D,resetScrollTrigger:w})}),D&&e.jsx(wt,{missionCardOptions:g,onClose:()=>I([])}),e.jsx(jt,{ownedCards:a,friendCards:v||[],ownAccount:C,friendAccount:F})]})}export{Mt as default};
