import{d as U,j as o}from"./query-vendor-DpGHCXpY.js";import{u as R,i as A}from"./i18n-vendor-DDmeScd6.js";import{r as O}from"./react-vendor-DjlsVz29.js";import{h as I,e as H,g as _,gV as P,a as W,c as L,D as q,B as Z}from"./index-HgUGxttl.js";import{p as K}from"./ui-vendor-9yhwxkpr.js";import{R as Q,D as Y}from"./index-GZHL700b.js";import{S as G}from"./SearchInput-CulDeUhE.js";import{e as J,c as X,o as ee,t as te,s as se}from"./filters-COkg5H0x.js";import{D as z,T as V,a as ae}from"./Filters-BNRoXtUM.js";import{M as oe,C as ne}from"./react-tooltip.min-CFFaLwjN.js";const ie=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],re=I("arrow-down-a-z",ie);const le=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],ce=I("arrow-up-a-z",le);function je({className:y,children:e,cards:d,groupExpansions:t,render:r}){const{t:x}=R(["common/sets","pages/collection"]),c=O.useRef(null),[s,p]=O.useState(900),[a,h]=O.useState("100px");O.useEffect(()=>{const n=c.current;if(!n)return;const i=new ResizeObserver(l=>{p(l[0].contentRect.width);const b=document.querySelector("#header")?.offsetHeight||0,v=window.innerHeight-b;h(`${v}px`)});return i.observe(n),()=>i.disconnect()},[]);const m=1.4,f=40,w=Math.max(Math.min(Math.floor(s/170),5),3),N=Math.round(m*(s/w))+f,D={3:"basis-1/3",4:"basis-1/4",5:"basis-1/5"}[w],g=t?Object.entries(Object.groupBy(d,n=>n.expansion)).toSorted(([n,i],[l,b])=>H.indexOf(n)-H.indexOf(l)).flatMap(([n,i])=>[{id:`header-${n}`,type:"header",expansion:_(n)},...P(i,w).map((l,b)=>({id:`row-${n}-${b}`,type:"row",cards:l}))]):P(d,w).map((n,i)=>({id:`row-${i}`,type:"row",cards:n})),k=U({getScrollElement:()=>c.current,count:g.length,getItemKey:n=>g[n].id,estimateSize:n=>g[n].type==="header"?52:N+8,overscan:5});return o.jsxs("div",{ref:c,className:W("overflow-y-auto",y),style:{scrollbarWidth:"thin"},children:[e,d.length===0&&o.jsx("p",{className:"text-xl text-center py-8",children:"No cards to show"}),o.jsx("div",{style:{height:a},children:o.jsx("div",{style:{height:`${k.getTotalSize()}px`},className:"relative w-full",children:k.getVirtualItems().map(n=>{const i=g[n.index];return o.jsx("div",{style:{height:`${n.size}px`,transform:`translateY(${n.start}px)`},className:"absolute top-0 left-0 w-full",children:i.type==="header"?o.jsxs("div",{className:"flex items-center gap-2 scroll-m-20 border-b-2 border-slate-600 pb-2 tracking-tight transition-colors",children:[o.jsx("img",{src:`/images/sets/${A.language}/${i.expansion.id}.webp`,alt:i.expansion.name,className:"max-w-[60px]",onError:l=>{A.language!=="en-US"&&(l.target.src=`/images/sets/en-US/${i.expansion.id}.webp`)}}),o.jsx("h2",{className:"text-center font-semibold sm:text-lg md:text-2xl",children:x(i.expansion.name)})]}):o.jsx("div",{className:"w-full flex justify-start",children:i.cards.map(l=>o.jsx("div",{className:`${D} min-w-0 px-2`,children:r(l)},`${l.expansion}-${l.internal_id}`))})},n.key)})})})]})}const de=y=>{const e=L.c(19),{allTextSearch:d,setAllTextSearch:t}=y,{t:r}=R("search-input");let x;e[0]!==d||e[1]!==t?(x=()=>t(!d),e[0]=d,e[1]=t,e[2]=x):x=e[2];let c;e[3]!==d||e[4]!==x?(c=o.jsx("input",{type:"checkbox",id:"checkbox",checked:d,onChange:x,className:"w-4 h-4"}),e[3]=d,e[4]=x,e[5]=c):c=e[5];let s;e[6]!==r?(s=r("allTextLabel"),e[6]=r,e[7]=s):s=e[7];let p;e[8]!==s?(p=o.jsx("label",{htmlFor:"checkbox",className:"text-xs",children:s}),e[8]=s,e[9]=p):p=e[9];let a;e[10]===Symbol.for("react.memo_cache_sentinel")?(a=o.jsx(oe,{id:"allTextSearch",style:{maxWidth:"300px",whiteSpace:"normal"},clickable:!0}),e[10]=a):a=e[10];let h;e[11]!==r?(h=r("allTextTooltip"),e[11]=r,e[12]=h):h=e[12];let m;e[13]!==h?(m=o.jsx(ne,{className:"h-4 w-4","data-tooltip-id":"allTextSearch","data-tooltip-content":h}),e[13]=h,e[14]=m):m=e[14];let f;return e[15]!==c||e[16]!==p||e[17]!==m?(f=o.jsxs("div",{className:"flex items-center space-x-2 text-white/50",children:[c,p,a,m]}),e[15]=c,e[16]=p,e[17]=m,e[18]=f):f=e[18],f},Ne=y=>{const e=L.c(78),{className:d,filters:t,setFilters:r,clearFilters:x}=y;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=["pages/collection","common/sets","common/packs","filters"],e[0]=c):c=e[0];const{t:s}=R(c);let p;e[1]!==r?(p=u=>j=>r({[u]:j}),e[1]=r,e[2]=p):p=e[2];const a=p;let h;e[3]!==t.expansion?(h=(()=>{if(!(t.expansion===void 0||t.expansion==="all"))return["all",..._(t.expansion).packs.map(pe).filter(he)]})(),e[3]=t.expansion,e[4]=h):h=e[4];const m=h;let f;e[5]!==t.pack||e[6]!==r?(f=function(j){t.pack===void 0?r({expansion:j}):r({expansion:j,pack:"all"})},e[5]=t.pack,e[6]=r,e[7]=f):f=e[7];const w=f;let N;e[8]!==s?(N=function(j){return s(j==="all"?"all":_(j).name,{ns:"common/sets"})},e[8]=s,e[9]=N):N=e[9];const D=N;let g;e[10]!==a||e[11]!==t.search?(g=t.search!==void 0&&o.jsx(G,{value:t.search,setValue:a("search")}),e[10]=a,e[11]=t.search,e[12]=g):g=e[12];let k;e[13]!==a||e[14]!==t.allTextSearch?(k=t.allTextSearch!==void 0&&o.jsx(de,{allTextSearch:t.allTextSearch,setAllTextSearch:a("allTextSearch")}),e[13]=a,e[14]=t.allTextSearch,e[15]=k):k=e[15];let n;e[16]!==t.expansion||e[17]!==D||e[18]!==w||e[19]!==s?(n=t.expansion!==void 0&&o.jsx(z,{label:s("expansion",{ns:"common/sets"}),options:J,value:t.expansion,onChange:w,show:D}),e[16]=t.expansion,e[17]=D,e[18]=w,e[19]=s,e[20]=n):n=e[20];let i;e[21]!==a||e[22]!==t.pack||e[23]!==m||e[24]!==s?(i=t.pack!==void 0&&m&&o.jsx(V,{className:"block",options:m,value:t.pack,onChange:a("pack"),show:u=>s(u,{ns:"common/packs"})}),e[21]=a,e[22]=t.pack,e[23]=m,e[24]=s,e[25]=i):i=e[25];let l;e[26]!==a||e[27]!==t.deckbuildingMode||e[28]!==t.rarity?(l=t.rarity!==void 0&&o.jsx(Q,{rarityFilter:t.rarity,setRarityFilter:a("rarity"),deckbuildingMode:t.deckbuildingMode}),e[26]=a,e[27]=t.deckbuildingMode,e[28]=t.rarity,e[29]=l):l=e[29];let b;e[30]!==a||e[31]!==t.cardType?(b=t.cardType!==void 0&&o.jsx(ae,{options:X,value:t.cardType,onChange:a("cardType"),show:q}),e[30]=a,e[31]=t.cardType,e[32]=b):b=e[32];let v;e[33]!==a||e[34]!==t.ownership||e[35]!==s?(v=t.ownership!==void 0&&o.jsx(V,{className:"block",options:ee,value:t.ownership,onChange:a("ownership"),label:s("carddex",{ns:"filters"}),show:u=>s(u,{ns:"filters",keyPrefix:"f-ownership"})}),e[33]=a,e[34]=t.ownership,e[35]=s,e[36]=v):v=e[36];let S;e[37]!==a||e[38]!==t.trading||e[39]!==s?(S=t.trading!==void 0&&o.jsx(V,{className:"block",options:te,value:t.trading,onChange:a("trading"),label:s("trading",{ns:"filters"}),show:u=>s(u,{ns:"filters",keyPrefix:"f-trading"})}),e[37]=a,e[38]=t.trading,e[39]=s,e[40]=S):S=e[40];let T;e[41]!==a||e[42]!==t.sortBy||e[43]!==t.sortDesc||e[44]!==r||e[45]!==s?(T=t.sortBy!==void 0&&o.jsxs("div",{className:"flex gap-2",children:[o.jsx(z,{className:"flex-1",label:s("f-sortBy.sortBy",{ns:"filters"}),options:se,value:t.sortBy,onChange:a("sortBy"),show:u=>s(`f-sortBy.${u}`,{ns:"filters"})}),t.sortDesc!==void 0&&o.jsx("button",{type:"button",onClick:()=>r({sortDesc:!t.sortDesc}),className:"group h-auto aspect-square bg-neutral-800 hover:bg-neutral-600 rounded-md border border-neutral-700 flex items-center justify-center",children:o.jsx(K,{className:"stroke-neutral-400 group-hover:stroke-neutral-300",children:t.sortDesc?o.jsx(ce,{}):o.jsx(re,{})})})]}),e[41]=a,e[42]=t.sortBy,e[43]=t.sortDesc,e[44]=r,e[45]=s,e[46]=T):T=e[46];let M;e[47]!==a||e[48]!==t.minNumber||e[49]!==s?(M=t.minNumber!==void 0&&o.jsx(z,{label:s("f-number.minNum",{ns:"filters"}),options:[0,1,2,3,4,5,6,7,8,9,10,100],value:t.minNumber,onChange:a("minNumber")}),e[47]=a,e[48]=t.minNumber,e[49]=s,e[50]=M):M=e[50];let C;e[51]!==a||e[52]!==t.maxNumber||e[53]!==s?(C=t.maxNumber!==void 0&&o.jsx(z,{label:s("f-number.maxNum",{ns:"filters"}),options:["âˆž",0,1,2,3,4,5,6,7,8,9,10],value:t.maxNumber,onChange:a("maxNumber")}),e[51]=a,e[52]=t.maxNumber,e[53]=s,e[54]=C):C=e[54];let $;e[55]!==a||e[56]!==t.deckbuildingMode?($=t.deckbuildingMode!==void 0&&o.jsx(Y,{deckbuildingMode:t.deckbuildingMode,setDeckbuildingMode:a("deckbuildingMode")}),e[55]=a,e[56]=t.deckbuildingMode,e[57]=$):$=e[57];let F;e[58]!==s?(F=s("filters.clear"),e[58]=s,e[59]=F):F=e[59];let B;e[60]!==x||e[61]!==F?(B=o.jsx(Z,{variant:"outline",className:"!text-red-700",onClick:x,children:F}),e[60]=x,e[61]=F,e[62]=B):B=e[62];let E;return e[63]!==d||e[64]!==l||e[65]!==b||e[66]!==v||e[67]!==S||e[68]!==T||e[69]!==M||e[70]!==C||e[71]!==$||e[72]!==B||e[73]!==g||e[74]!==k||e[75]!==n||e[76]!==i?(E=o.jsxs("div",{className:d,children:[g,k,n,i,l,b,v,S,T,M,C,$,B]}),e[63]=d,e[64]=l,e[65]=b,e[66]=v,e[67]=S,e[68]=T,e[69]=M,e[70]=C,e[71]=$,e[72]=B,e[73]=g,e[74]=k,e[75]=n,e[76]=i,e[77]=E):E=e[77],E};function pe(y){return y.name}function he(y){return y!=="everypack"}export{je as C,Ne as F};
