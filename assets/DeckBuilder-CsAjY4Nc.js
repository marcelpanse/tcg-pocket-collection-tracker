import{j as t}from"./query-vendor-DY2sPXio.js";import{c as Fe,a as Be,u as Oe,s as Pe,v as ne,I as $e,x as Me,k as ge,l as ke,m as _e,n as Ne,B as Le}from"./index-SEgXjU2E.js";import{i as Re,r as p}from"./react-vendor-BHI5tqau.js";import{u as Ce,s as Ge}from"./index-WUp7oYjv.js";import{C as He}from"./CardLine-DqQ9zSEc.js";import{F as we,C as Qe}from"./FiltersPanel-SRAdzvBz.js";import{F as Ue}from"./FancyCard-GQwmqObB.js";import{a as We}from"./Filters-DrtP2CBC.js";import{g as Ae}from"./filters-B5myfvGh.js";import{s as Je}from"./utils-CRnu-1y-.js";import{T as Ke}from"./trash-2-m4DcNH4E.js";import"./i18n-vendor-Dl1_3pZV.js";import"./charts-vendor-CbNqUEBb.js";import"./supabase-vendor-CP3OYKhD.js";import"./ui-vendor-BE8h_kp7.js";import"./xlsx-vendor-De4COjWB.js";import"./react-tooltip.min-DsTrEd-k.js";import"./index-DqUCnBUv.js";import"./SearchInput-UrPGY2wA.js";import"./tabs-BTKOPemi.js";const Ve=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}]],ve=Fe("square-minus",Ve);const Xe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Se=Fe("square-plus",Xe),$={search:"",expansion:"all",cardType:[],rarity:[],sortBy:"expansion-newest",allTextSearch:!1};function Nt(){const e=Be.c(93);let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o={query:"(max-width: 1024px)"},e[0]=o):o=e[0];const d=Ce(o);let x;e[1]===Symbol.for("react.memo_cache_sentinel")?(x={query:"(max-width: 767px)"},e[1]=x):x=e[1];const j=Ce(x),[u,ae]=Re(),{data:n}=Oe(),{setSelectedCardId:ie}=Pe(),[oe,pe]=p.useState(!1),[c,O]=p.useState($);let L;if(e[2]!==c||e[3]!==n){let s;e[5]!==n?(s=n??new Map,e[5]=n,e[6]=s):s=e[6],L=Ae({...c,deckbuildingMode:!0},s),e[2]=c,e[3]=n,e[4]=L}else L=e[4];const ce=L;let R;e[7]!==c?(R=()=>{let s=0;for(const r in c){const l=r;c[l]!==$[l]&&s++}return s},e[7]=c,e[8]=R):R=e[8];const P=R,[de,xe]=p.useState(!1);let G;e[9]!==u?(G=()=>u.get("title")??"New deck",e[9]=u,e[10]=G):G=e[10];const[m,Te]=p.useState(G);let H;e[11]!==u?(H=()=>{const s=u.get("energy");return s?s.split(",").filter(st):[]},e[11]=u,e[12]=H):H=e[12];const[f,De]=p.useState(H);let Q;e[13]!==u?(Q=()=>{const s=u.get("cards");if(s){const r=s.split(",").map(tt).filter(et).filter(Ze);return new Map(r)}else return new Map},e[13]=u,e[14]=Q):Q=e[14];const[a,je]=p.useState(Q),ye=[...a].toSorted(Ye);let U;e[15]!==a?(U=()=>{let s=0;return a.forEach(r=>{s=s+r}),s},e[15]=a,e[16]=U):U=e[16];const be=U,W=n?ye.reduce((s,r)=>{const[l,i]=r;return s+Math.max(0,i-(ne(l)?.alternate_versions?.reduce((h,le)=>h+(n.get(le)?.amount_owned??0),0)??0))},0):0;let A;e[17]!==a||e[18]!==f||e[19]!==m||e[20]!==ae?(A=()=>{ae({title:m,energy:f.join(","),cards:Je(a)},{replace:!0})},e[17]=a,e[18]=f,e[19]=m,e[20]=ae,e[21]=A):A=e[21];let J;e[22]!==a||e[23]!==f||e[24]!==m?(J=[a,m,f],e[22]=a,e[23]=f,e[24]=m,e[25]=J):J=e[25],p.useEffect(A,J);let K;e[26]===Symbol.for("react.memo_cache_sentinel")?(K=s=>{je(r=>{const l=r.get(s)??0;if(l>=2)return r;const i=new Map(r);return i.set(s,l+1),i})},e[26]=K):K=e[26];const y=K;let V;e[27]===Symbol.for("react.memo_cache_sentinel")?(V=s=>{je(r=>{const l=r.get(s);if(l===void 0)return r;const i=new Map(r);return l<=1?i.delete(s):i.set(s,l-1),i})},e[27]=V):V=e[27];const b=V,ze="flex flex-col [&>h2]:text-lg [&>h2:not(:first-child)]:mt-2";let g;e[28]===Symbol.for("react.memo_cache_sentinel")?(g=t.jsx("h2",{children:"Title"}),e[28]=g):g=e[28];let X;e[29]===Symbol.for("react.memo_cache_sentinel")?(X=s=>Te(s.target.value),e[29]=X):X=e[29];let k;e[30]!==m?(k=t.jsx($e,{className:"bg-neutral-800",type:"text",value:m,onChange:X}),e[30]=m,e[31]=k):k=e[31];let _;e[32]===Symbol.for("react.memo_cache_sentinel")?(_=t.jsx("h2",{children:"Energy"}),e[32]=_):_=e[32];let N;e[33]!==f?(N=t.jsx(We,{options:Me,value:f,onChange:De,show:Ge}),e[33]=f,e[34]=N):N=e[34];let C;e[35]===Symbol.for("react.memo_cache_sentinel")?(C=t.jsx("h2",{children:"Cards"}),e[35]=C):C=e[35];const Ee="overflow-y-auto space-y-1";let Y;e[36]!==y||e[37]!==n||e[38]!==b?(Y=s=>{const[r,l]=s,i=ne(r);if(!i)return null;const h=n&&i.alternate_versions.reduce((Ie,qe)=>Ie+(n.get(qe)?.amount_owned??0),0),le=h!==void 0&&h<l;return t.jsxs("li",{className:"flex gap-1 rounded",children:[t.jsx("button",{type:"button",className:"enabled:cursor-pointer",onClick:()=>b(r),children:t.jsx(ve,{className:"size-5"})}),t.jsx("button",{type:"button",className:"enabled:cursor-pointer disabled:opacity-50",onClick:()=>y(r),disabled:l>=2,children:t.jsx(Se,{className:"size-5"})}),t.jsxs("b",{className:"mx-2",children:[l,"×"]}),t.jsx(He,{className:`w-full ${le?"bg-red-950":""}`,card_id:ne(r)?.card_id,id:"hidden",amount:le?"text-red-300":"",amount_owned:h})]},r)},e[36]=y,e[37]=n,e[38]=b,e[39]=Y):Y=e[39];const me=ye.map(Y);let w;e[40]!==me?(w=t.jsx("ul",{className:Ee,children:me}),e[40]=me,e[41]=w):w=e[41];const ue=`${be()>20?"text-red-300":""}`,fe=be();let v;e[42]!==ue||e[43]!==fe?(v=t.jsx("span",{className:ue,children:fe}),e[42]=ue,e[43]=fe,e[44]=v):v=e[44];let Z;e[45]===Symbol.for("react.memo_cache_sentinel")?(Z=t.jsx("span",{className:"text-sm",children:"/20 cards"}),e[45]=Z):Z=e[45];let S;e[46]!==W?(S=W>0&&t.jsxs("span",{className:"text-sm",children:[" (",W," missing)"]}),e[46]=W,e[47]=S):S=e[47];let F;e[48]!==v||e[49]!==S?(F=t.jsxs("p",{className:"text-neutral-400 mt-2",children:[v,Z,S]}),e[48]=v,e[49]=S,e[50]=F):F=e[50];let ee;e[51]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("p",{className:"text-sm text-neutral-400",children:"Want to save your deck? Bookmark this page!"}),e[51]=ee):ee=e[51];let te;e[52]!==g||e[53]!==k||e[54]!==_||e[55]!==N||e[56]!==C||e[57]!==w||e[58]!==F?(te=t.jsxs("div",{className:ze,children:[g,k,_,N,C,w,F,ee]}),e[52]=g,e[53]=k,e[54]=_,e[55]=N,e[56]=C,e[57]=w,e[58]=F,e[59]=te):te=e[59];const se=te,he=`${m} – TCG Pocket Collection Tracker`;let M;e[60]!==he?(M=t.jsx("title",{children:he}),e[60]=he,e[61]=M):M=e[61];let T;e[62]!==c||e[63]!==d||e[64]!==oe?(T=d?t.jsx(ge,{open:oe,onOpenChange:pe,children:t.jsxs(ke,{side:"left",className:"w-full",children:[t.jsx(_e,{children:t.jsx(Ne,{children:"Filters"})}),t.jsx(we,{className:"flex flex-col w-80 h-fit gap-2",filters:c,setFilters:s=>O(r=>({...r,...s})),clearFilters:()=>O($)})]})}):t.jsx(we,{className:"flex flex-col w-80 h-fit gap-2",filters:c,setFilters:s=>O(r=>({...r,...s})),clearFilters:()=>O($)}),e[62]=c,e[63]=d,e[64]=oe,e[65]=T):T=e[65];let D;e[66]!==y||e[67]!==a||e[68]!==n||e[69]!==b||e[70]!==ie?(D=s=>{const r=a.get(s.internal_id)??0,l=n?Math.min(2,s.alternate_versions.reduce((i,h)=>i+(n.get(h)?.amount_owned??0),0)):2;return t.jsxs(t.Fragment,{children:[t.jsx("button",{type:"button",className:"cursor-pointer",onClick:()=>ie(s.internal_id),children:t.jsx(Ue,{card:s,selected:!0})},s.card_id),t.jsxs("div",{className:"flex gap-1 justify-center",children:[t.jsx("button",{type:"button",className:"enabled:cursor-pointer disabled:opacity-50",onClick:()=>b(s.internal_id),disabled:r<=0,children:t.jsx(ve,{className:"size-6"})}),t.jsxs("span",{className:r>l?"text-red-300":"",children:[r,"/",l??2]}),t.jsx("button",{type:"button",className:"enabled:cursor-pointer disabled:opacity-50",onClick:()=>y(s.internal_id),disabled:r>=2,children:t.jsx(Se,{className:"size-6"})})]})]})},e[66]=y,e[67]=a,e[68]=n,e[69]=b,e[70]=ie,e[71]=D):D=e[71];let z;e[72]!==P||e[73]!==d?(z=d&&t.jsxs("div",{className:"h-9 mb-2 z-10 flex overflow-hidden text-center rounded-md text-sm font-medium border shadow-sm border-neutral-700 divide-x divide-neutral-700 [&>*]:cursor-pointer [&>*]:hover:bg-neutral-600 [&>*]:hover:text-neutral-50",children:[t.jsxs("button",{type:"button",className:"flex-1",onClick:()=>pe(!0),children:["Filters",P()>0&&` (${P()})`]}),P()>0&&t.jsx("button",{type:"button",className:"group px-2",onClick:()=>O($),children:t.jsx(Ke,{className:"stroke-neutral-200 group-hover:stroke-neutral-50"})})]}),e[72]=P,e[73]=d,e[74]=z):z=e[74];let E;e[75]!==j?(E=j&&t.jsx(Le,{variant:"outline",onClick:()=>xe(!0),children:"Deck"}),e[75]=j,e[76]=E):E=e[76];let I;e[77]!==z||e[78]!==E?(I=t.jsxs("div",{className:"flex flex-col sticky top-0 z-10 bg-neutral-900 mb-2",children:[z,E]}),e[77]=z,e[78]=E,e[79]=I):I=e[79];let q;e[80]!==ce||e[81]!==D||e[82]!==I?(q=t.jsx(Qe,{className:"w-full lg:w-152 px-2",cards:ce,render:D,children:I}),e[80]=ce,e[81]=D,e[82]=I,e[83]=q):q=e[83];let B;e[84]!==j||e[85]!==se||e[86]!==de?(B=j?t.jsx(ge,{open:de,onOpenChange:xe,children:t.jsxs(ke,{side:"right",className:"w-full",children:[t.jsx(_e,{children:t.jsx(Ne,{children:"Deck"})}),se]})}):t.jsx("div",{className:"min-w-80 md:w-108 h-fit p-2 rounded-lg border-1 border-neutral-700",children:se}),e[84]=j,e[85]=se,e[86]=de,e[87]=B):B=e[87];let re;return e[88]!==M||e[89]!==T||e[90]!==q||e[91]!==B?(re=t.jsxs("div",{className:"w-full mx-auto flex px-2 gap-4 justify-center",children:[M,T,q,B]}),e[88]=M,e[89]=T,e[90]=q,e[91]=B,e[92]=re):re=e[92],re}function Ye(e,o){const[d]=e,[x]=o;return d-x}function Ze(e){const[o,d]=e;return!!ne(o)&&d>0}function et(e){return!!e}function tt(e){const o=e.split(":");if(o.length===2)return[Number(o[0]),Math.min(Number(o[1]),2)]}function st(e){return Me.includes(e)}export{Nt as default};
